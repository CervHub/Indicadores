import{j as e,K as k,r as t,L as E}from"./app-k-c3-IUX.js";import{C as L}from"./check-CrF9bga2.js";import{B as z}from"./button-DS4OftCH.js";import{C as f,a as j,b as y,d as c}from"./card-Dhtq3Av6.js";import{I as i}from"./input-BmLBwXHo.js";import{L as o}from"./label-CH4sFQ5V.js";import{A as D}from"./app-layout-DZFWTyUB.js";import{f as g}from"./utils-CISCwvQU.js";import S from"./closed--lclQ-7B.js";import"./createLucideIcon-SZDYLwmW.js";import"./index-B3PbW1eo.js";import"./index-BnhXOjFJ.js";import"./index-Ch_9LA9U.js";import"./index-D342dBXe.js";import"./tooltip-D3tBfP_G.js";import"./index-qSiOHZki.js";import"./index-BL9xfY7b.js";import"./index-DrGBlFrz.js";import"./chevrons-up-down-zkKt1COi.js";import"./truck-D78V83WZ.js";import"./chevron-right-CzHWkwYl.js";import"./index-Btnzgt-U.js";import"./index-BUm7skBF.js";import"./index-Chjiymov.js";import"./dialog-BuUT_YpG.js";import"./loader-circle-BUzb_yh4.js";const P=({currentStep:s,currentState:r})=>{const l=a=>{switch(a){case 0:return"Generado";case 1:return r==="Revisado"||r==="Visualizado"?r:"Visualizado";case 2:return r==="Cerrado"||r==="Finalizado"?r:"Cerrado";default:return""}};return e.jsx("div",{className:"overflow-x-auto w-full",children:e.jsx("ul",{className:"relative grid grid-flow-col auto-cols-fr gap-x-2 min-w-max",children:[0,1,2].map(a=>e.jsxs("li",{className:"flex items-center gap-x-2 shrink basis-0 flex-1 group",children:[e.jsxs("div",{className:"min-w-7 min-h-7 inline-flex justify-center items-center text-xs align-middle",children:[e.jsx("span",{className:`size-7 flex justify-center items-center shrink-0 ${a<=s?"bg-blue-500 text-white":"bg-gray-100 text-gray-800"} font-medium rounded-full dark:bg-neutral-700 dark:text-white`,children:a<=s?e.jsx(L,{className:"w-4 h-4"}):a+1}),e.jsx("span",{className:"ms-2 block text-sm font-medium text-gray-800 dark:text-white",children:l(a)})]}),e.jsx("div",{className:"w-full h-px flex-1 bg-gray-200 group-last:hidden dark:bg-neutral-700"})]},a))})})},I=[{title:"Reportabilidad",href:"/admin/reportability"},{title:"Detalle",href:"/admin/reportability/detalle"}];function de(){const{reportability_id:s,reportability:r,isSecurityEngineer:l,canCloseReport:a}=k().props;console.log("ReportabilityPage",s,r,l,a);const[p,m]=t.useState(!0),[d,x]=t.useState(null),[b,u]=t.useState(!1),[v,_]=t.useState(0),[C,N]=t.useState(h(r.estado)),w=route("company.reportability.download",{reportability_id:s}),F=()=>{m(!1),x(null)},R=()=>{m(!1),x("No se pudo cargar el PDF")};t.useEffect(()=>{_(n=>n+1),N(h(r.estado))},[r.estado]);function h(n){switch(n){case"Generado":return 0;case"Revisado":case"Visualizado":return 1;case"Cerrado":case"Finalizado":return 2;default:return 0}}return e.jsxs(D,{breadcrumbs:I,children:[e.jsx(E,{title:"Reportabilidad"}),e.jsx("div",{className:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4",children:e.jsxs("div",{className:"grid h-full grid-cols-12 gap-4",children:[e.jsxs(f,{className:"col-span-12 h-full md:col-span-8",children:[e.jsx(j,{children:e.jsx(y,{children:"Reporte"})}),e.jsxs(c,{children:[p&&e.jsx("p",{children:"Cargando PDF..."}),d&&e.jsx("p",{children:d}),e.jsx("iframe",{src:w,width:"100%",height:"759",onLoad:F,onError:R,style:{display:p||d?"none":"block"}},v)]})]}),e.jsxs(f,{className:"col-span-12 flex h-full flex-col justify-between md:col-span-4",children:[e.jsxs("div",{children:[e.jsx(j,{children:e.jsx(y,{children:"Detalles del reporte"})}),e.jsx("br",{}),e.jsxs(c,{className:"flex flex-col gap-2 space-y-2",children:[e.jsx(P,{currentStep:C,currentState:r.estado}),e.jsxs("div",{className:"space-y-2 d-none",children:[e.jsx(o,{htmlFor:"estado",children:"Estado"}),e.jsx(i,{id:"estado",type:"text",value:r.estado,disabled:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"tipo_reporte",children:"Tipo de Reporte"}),e.jsx(i,{id:"tipo_reporte",type:"text",value:r.tipo_reporte,disabled:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"company_name",children:"Compañía"}),e.jsx(i,{id:"company_name",type:"text",value:r.company_name,disabled:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"company_report_name",children:"Compañía Reportada"}),e.jsx(i,{id:"company_report_name",type:"text",value:r.company_report_name,disabled:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"fecha_evento",children:"Fecha de Evento"}),e.jsx(i,{id:"fecha_evento",type:"text",value:g(r.fecha_evento),disabled:!0})]}),r.report_closed_at&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"fecha_cierre",children:"Fecha de Cierre"}),e.jsx(i,{id:"fecha_cierre",type:"text",value:g(r.report_closed_at),disabled:!0})]})]})]}),e.jsx(c,{children:e.jsx(z,{variant:"destructive",className:"mt-4 w-auto",onClick:()=>u(!0),disabled:!a||r.estado==="Cerrado"||r.estado==="Finalizado"||!l,children:"Finalizar Reporte"})})]})]})}),e.jsx(S,{report_id:s,isDialogOpen:b,setIsDialogOpen:u})]})}export{de as default};
