import{j as a,r as d,K as de,L as me,U as ue}from"./app-CFbnwxaJ.js";import{T as K,a as C,b as D,c as A}from"./tooltip-CqUsjh2W.js";import{T as M}from"./trash-2-BeqoD-LQ.js";import{a as E,b as he,m as xe}from"./utils-DU6Hee-i.js";import{B as Y}from"./badge-Dr3qjqiC.js";import{T as pe,a as ge,b as Z,c as je,D as V}from"./tabs-BuGjG5x-.js";import{u as ye,f as ee,g as be,a as _e,b as Ve,c as fe}from"./index-0j5AO2wf.js";import{T as ve,a as Te,b as q,c as Ke,d as Ce,e as ae}from"./table-CYDAxJYI.js";import{B as se}from"./button-CMVn9jsO.js";import{I as F}from"./input-DX41_HBu.js";import{S as le,a as re,b as ce,c as ne,f as R}from"./select-DjeTE6lj.js";import{C as B,a as z,b as J,c as te,d as Q}from"./card-qHXhyjKm.js";import{L as W}from"./label-BSuMeJi7.js";import{A as De}from"./app-layout-_P8YHNS1.js";import Ae from"./chart-KyRxzY5w.js";import Ne from"./annex-BEeirQ0d.js";import Ee from"./company-BK773OQT.js";import"./index-DM9dij4a.js";import"./index-BLxLQ2lR.js";import"./index-Ce_yXbC7.js";import"./index-C3QMGSSW.js";import"./index-DM2guIZE.js";import"./index-7lrwsnUS.js";import"./index-DczEtKpH.js";import"./check-BefMJKsU.js";import"./index-CtokE_cK.js";import"./chevrons-up-down-CEC77W21.js";import"./truck-BMx4P6lm.js";import"./chevron-right-DfnSe-WO.js";import"./chart-Hl99Lai3.js";import"./index-Buv9G-YW.js";import"./index-Chjiymov.js";import"./dialog-Pix7n2zF.js";import"./loader-circle-C6EVYJpZ.js";const o=(s,e)=>a.jsx(K,{children:a.jsxs(C,{children:[a.jsx(D,{children:a.jsx("span",{children:e})}),a.jsx(A,{children:a.jsxs("p",{children:[s,": ",e]})})]})}),L=s=>[{id:"actions",cell:({row:e})=>{const n=e.original;return a.jsx("div",{className:"flex gap-2",children:a.jsx("span",{"aria-label":"Eliminar",className:"flex h-6 w-6 cursor-pointer items-center justify-center rounded-md bg-red-700 text-xs text-white hover:bg-red-900 dark:bg-red-600 dark:hover:bg-red-800",onClick:()=>s(n,"e-a"),children:a.jsx(M,{className:"h-4 w-4"})})})}},{accessorKey:"uea",header:"UEA",cell:e=>o("UEA",e.getValue())},{accessorKey:"type",header:"Tipo",cell:e=>o("Tipo",e.getValue())},{accessorKey:"company",header:"Contrata",cell:e=>o("Compañía",e.getValue())},{accessorKey:"empl",header:"Empl"},{accessorKey:"obr",header:"Obr"},{accessorKey:"day1",header:"D. 1",cell:e=>o("D. 1",e.getValue())},{accessorKey:"day2",header:"D. 2",cell:e=>o("D. 2",e.getValue())},{accessorKey:"day3",header:"D. 3",cell:e=>o("D. 3",e.getValue())},{accessorKey:"day4",header:"D. 4",cell:e=>o("D. 4",e.getValue())},{accessorKey:"day5",header:"D. 5",cell:e=>o("D. 5",e.getValue())},{accessorKey:"day6",header:"D. 6",cell:e=>o("D. 6",e.getValue())},{accessorKey:"day7",header:"D. 7",cell:e=>o("D. 7",e.getValue())},{accessorKey:"day8",header:"D. 8",cell:e=>o("D. 8",e.getValue())},{accessorKey:"day9",header:"D. 9",cell:e=>o("D. 9",e.getValue())},{accessorKey:"day10",header:"D. 10",cell:e=>o("D. 10",e.getValue())},{accessorKey:"day11",header:"D. 11",cell:e=>o("D. 11",e.getValue())},{accessorKey:"day12",header:"D. 12",cell:e=>o("D. 12",e.getValue())},{accessorKey:"day13",header:"D. 13",cell:e=>o("D. 13",e.getValue())},{accessorKey:"day14",header:"D. 14",cell:e=>o("D. 14",e.getValue())},{accessorKey:"day15",header:"D. 15",cell:e=>o("D. 15",e.getValue())},{accessorKey:"day16",header:"D. 16",cell:e=>o("D. 16",e.getValue())},{accessorKey:"day17",header:"D. 17",cell:e=>o("D. 17",e.getValue())},{accessorKey:"day18",header:"D. 18",cell:e=>o("D. 18",e.getValue())},{accessorKey:"day19",header:"D. 19",cell:e=>o("D. 19",e.getValue())},{accessorKey:"day20",header:"D. 20",cell:e=>o("D. 20",e.getValue())},{accessorKey:"day21",header:"D. 21",cell:e=>o("D. 21",e.getValue())},{accessorKey:"day22",header:"D. 22",cell:e=>o("D. 22",e.getValue())}],u=(s,e)=>a.jsx(K,{children:a.jsxs(C,{children:[a.jsx(D,{children:a.jsx("span",{children:e})}),a.jsx(A,{children:a.jsx("p",{children:s})})]})}),Me=s=>[{id:"actions",cell:({row:e})=>{const n=e.original;return a.jsx("div",{className:"flex gap-2",children:a.jsx("span",{"aria-label":"Eliminar",className:"flex h-6 w-6 cursor-pointer items-center justify-center rounded-md bg-red-700 text-xs text-white hover:bg-red-900 dark:bg-red-600 dark:hover:bg-red-800",onClick:()=>s(n.id,"e-annex"),children:a.jsx(M,{className:"h-4 w-4"})})})}},{accessorKey:"uea",header:"UEA",cell:e=>u("UEA",e.getValue())},{accessorKey:"type",header:"Tipo",cell:e=>u("Tipo",e.getValue())},{accessorKey:"company",header:"Contrata",cell:e=>u("Compañía",e.getValue())},{accessorKey:"situation",header:()=>u("Situación","Situación"),cell:e=>u(e.getValue(),e.getValue())},{accessorKey:"employees",header:()=>u("Empleados","Empleados"),cell:e=>a.jsx("span",{children:e.getValue()}),size:200},{accessorKey:"workers",header:()=>u("Obreros","Obreros"),cell:e=>a.jsx("span",{children:e.getValue()})},{accessorKey:"incidents",header:()=>u("Incidentes","Incidentes"),cell:e=>a.jsx("span",{children:e.getValue()})},{accessorKey:"dangerous_incidents",header:()=>u("Incidentes peligrosos","Inc. peligrosos"),cell:e=>a.jsx("span",{children:e.getValue()})},{accessorKey:"minor_accidents",header:()=>u("Accidentes menores","Acc. menores"),cell:e=>a.jsx("span",{children:e.getValue()})},{accessorKey:"disability",header:()=>u("Incapacidad","Incapacidad"),cell:e=>a.jsx("span",{children:e.getValue()})},{accessorKey:"mortality",header:()=>u("Mortal","Mortal"),cell:e=>a.jsx("span",{children:e.getValue()})},{accessorKey:"lost_days",header:()=>u("Días perdidos","Días perdidos"),cell:e=>a.jsx("span",{children:E(e.getValue())})},{accessorKey:"man_hours_worked",header:()=>u("Horas hombre trabajadas","H.H.T."),cell:e=>a.jsx("span",{children:E(e.getValue())})},{accessorKey:"frequency_index",header:()=>u("Índice de frecuencia","Índ. frecuencia"),cell:e=>a.jsx("span",{children:E(e.getValue())})},{accessorKey:"severity_index",header:()=>u("Índice de severidad","Índ. severidad"),cell:e=>a.jsx("span",{children:E(e.getValue())})},{accessorKey:"accident_rate",header:()=>u("Tasa de accidentes","Tasa de acc."),cell:e=>a.jsx("span",{children:E(e.getValue())})}],l=(s,e)=>a.jsx(K,{children:a.jsxs(C,{children:[a.jsx(D,{children:a.jsx("span",{children:e})}),a.jsx(A,{children:a.jsx("p",{children:s})})]})}),we=s=>[{id:"actions",cell:({row:e})=>{const n=e.original;return a.jsx("div",{className:"flex gap-2",children:a.jsx("span",{"aria-label":"Eliminar",className:"flex h-6 w-6 cursor-pointer items-center justify-center rounded-md bg-red-700 text-xs text-white hover:bg-red-900 dark:bg-red-600 dark:hover:bg-red-800",onClick:()=>s(n.id,"e-annex"),children:a.jsx(M,{className:"h-4 w-4"})})})}},{accessorKey:"uea",header:"UEA",cell:e=>l("UEA",e.getValue())},{accessorKey:"type",header:"Tipo",cell:e=>l("Tipo",e.getValue())},{accessorKey:"company",header:"Contrata",cell:e=>l("Compañía",e.getValue())},{accessorKey:"accident_type",header:()=>l("Tipo De Accidente (Tabla 10 De Anexo N° 31)","T.A."),cell:e=>l(e.getValue(),e.getValue())},{accessorKey:"injury_nature",header:()=>l("Naturaleza De La Lesión (Tabla 11 De Anexo N° 31)","N.L."),cell:e=>l(e.getValue(),e.getValue())},{accessorKey:"age",header:()=>l("Edad","Edad"),cell:e=>l(e.getValue(),e.getValue())},{accessorKey:"marital_status",header:()=>l("Estado Civil","E.C."),cell:e=>l(e.getValue(),e.getValue())},{accessorKey:"education_level",header:()=>l("Nivel De Educación","N.E."),cell:e=>l(e.getValue(),e.getValue())},{accessorKey:"years_experience",header:()=>l("Años De Experiencia","A.E."),cell:e=>l(e.getValue(),e.getValue())},{accessorKey:"time",header:()=>l("Tiempo","T."),cell:e=>l(e.getValue(),e.getValue())},{accessorKey:"day",header:()=>l("Día","Día"),cell:e=>l(e.getValue(),e.getValue())},{accessorKey:"month_name",header:()=>l("Mes","Mes"),cell:e=>l(e.getValue(),e.getValue())},{accessorKey:"partial_temporary",header:()=>l("Parcial Temporal","P.T."),cell:e=>l(e.getValue(),e.getValue())},{accessorKey:"permanent_temporary",header:()=>l("Permanente Temporal","P.T."),cell:e=>l(e.getValue(),e.getValue())},{accessorKey:"partial_permanent",header:()=>l("Parcial Permanente","P.P."),cell:e=>l(e.getValue(),e.getValue())},{accessorKey:"total_permanent",header:()=>l("Total Permanente","T.P."),cell:e=>l(e.getValue(),e.getValue())},{accessorKey:"disability",header:()=>l("Incapacidad","I."),cell:e=>l(e.getValue(),e.getValue())},{accessorKey:"occupation",header:()=>l("Ocupación","O."),cell:e=>l(e.getValue(),e.getValue())},{accessorKey:"remuneration",header:()=>l("Remuneración","R."),cell:e=>a.jsx("span",{children:e.getValue()})}],Se=()=>[{accessorKey:"nombre",header:"Nombre",cell:({row:s})=>s.original.nombre||"N/A"},{accessorKey:"ruc",header:"RUC",cell:({row:s})=>s.original.ruc||"N/A"},{accessorKey:"estado",header:"Estado",cell:({row:s})=>a.jsx(Y,{variant:s.original.estado==="Subió"?"success":"destructive",children:s.original.estado})},{id:"anexos_badges",header:"Anexos",cell:({row:s})=>a.jsx("div",{className:"flex flex-wrap gap-1",children:s.original.anexos&&s.original.anexos.length>0?s.original.anexos.map((e,n)=>a.jsx(K,{children:a.jsxs(C,{children:[a.jsx(D,{asChild:!0,children:a.jsx(Y,{variant:"outline",className:"cursor-pointer",children:e.uea||"Anexo"})}),a.jsx(A,{children:a.jsxs("div",{className:"text-xs",children:[a.jsxs("div",{children:[a.jsx("strong",{children:"UEA:"})," ",e.uea||"-"]}),a.jsxs("div",{children:[a.jsx("strong",{children:"Tipo:"})," ",e.tipo||"-"]}),a.jsxs("div",{children:[a.jsx("strong",{children:"Fecha:"})," ",e.fecha||"-"]})]})})]})},n)):a.jsx("span",{className:"text-xs text-muted-foreground",children:"-"})})}],t=(s,e)=>a.jsx(K,{children:a.jsxs(C,{children:[a.jsx(D,{children:a.jsx("span",{children:e})}),a.jsx(A,{children:a.jsx("p",{children:s})})]})}),Oe=s=>[{id:"actions",cell:({row:e})=>{const n=e.original;return a.jsx("div",{className:"flex gap-2",children:a.jsx("span",{"aria-label":"Eliminar",className:"flex h-6 w-6 cursor-pointer items-center justify-center rounded-md bg-red-700 text-xs text-white hover:bg-red-900 dark:bg-red-600 dark:hover:bg-red-800",onClick:()=>s(n.id,"e-annex"),children:a.jsx(M,{className:"h-4 w-4"})})})}},{accessorKey:"uea",header:"UEA",cell:e=>t("UEA",e.getValue())},{accessorKey:"type",header:"Tipo",cell:e=>t("Tipo",e.getValue())},{accessorKey:"company",header:"Contrata",cell:e=>t("Compañía",e.getValue())},{accessorKey:"concession_code",header:()=>t("Codigo de la Concesion","Concesión"),cell:e=>a.jsx("span",{children:e.getValue()})},{accessorKey:"local_male_workers",header:()=>t("Obrero Hombre Trabajador Local","O.H.T.L"),cell:e=>a.jsx("span",{children:e.getValue()})},{accessorKey:"regional_male_workers",header:()=>t("Obrero Hombre Trabajador Regional","O.H.T.R"),cell:e=>a.jsx("span",{children:e.getValue()})},{accessorKey:"national_male_workers",header:()=>t("Obrero Hombre Trabajador Nacional","O.H.T.N"),cell:e=>a.jsx("span",{children:e.getValue()})},{accessorKey:"foreign_male_workers",header:()=>t("Obrero Hombre Trabajador Extranjero","O.H.T.E"),cell:e=>a.jsx("span",{children:e.getValue()})},{accessorKey:"local_female_workers",header:()=>t("Obrero Mujer Trabajadora Local","O.M.T.L"),cell:e=>a.jsx("span",{children:e.getValue()})},{accessorKey:"regional_female_workers",header:()=>t("Obrero Mujer Trabajadora Regional","O.M.T.R"),cell:e=>a.jsx("span",{children:e.getValue()})},{accessorKey:"national_female_workers",header:()=>t("Obrero Mujer Trabajadora Nacional","O.M.T.N"),cell:e=>a.jsx("span",{children:e.getValue()})},{accessorKey:"foreign_female_workers",header:()=>t("Obrero Mujer Trabajadora Extranjera","O.M.T.E"),cell:e=>a.jsx("span",{children:e.getValue()})},{accessorKey:"local_male_employees",header:()=>t("Empleado Hombre Trabajador Local","E.H.T.L"),cell:e=>a.jsx("span",{children:e.getValue()})},{accessorKey:"regional_male_employees",header:()=>t("Empleado Hombre Trabajador Regional","E.H.T.R"),cell:e=>a.jsx("span",{children:e.getValue()})},{accessorKey:"national_male_employees",header:()=>t("Empleado Hombre Trabajador Nacional","E.H.T.N"),cell:e=>a.jsx("span",{children:e.getValue()})},{accessorKey:"foreign_male_employees",header:()=>t("Empleado Hombre Trabajador Extranjero","E.H.T.E"),cell:e=>a.jsx("span",{children:e.getValue()})},{accessorKey:"local_female_employees",header:()=>t("Empleado Mujer Trabajadora Local","E.M.T.L"),cell:e=>a.jsx("span",{children:e.getValue()})},{accessorKey:"regional_female_employees",header:()=>t("Empleado Mujer Trabajadora Regional","E.M.T.R"),cell:e=>a.jsx("span",{children:e.getValue()})},{accessorKey:"national_female_employees",header:()=>t("Empleado Mujer Trabajadora Nacional","E.M.T.N"),cell:e=>a.jsx("span",{children:e.getValue()})},{accessorKey:"foreign_female_employees",header:()=>t("Empleado Mujer Trabajadora Extranjera","E.M.T.E"),cell:e=>a.jsx("span",{children:e.getValue()})},{accessorKey:"total_employees",header:()=>t("Total de Trabajadores","Trabajadores"),cell:e=>a.jsx("span",{children:e.getValue()})},{accessorKey:"total_hours_employees",header:()=>t("Total de Horas de Trabajo","Horas de Trabajo"),cell:e=>a.jsx("span",{children:e.getValue()})},{accessorKey:"mining_activities",header:()=>t("Actividades Mineras","Actividades Mineras"),cell:e=>a.jsx("span",{children:e.getValue()})}],p=(s,e)=>a.jsx(K,{children:a.jsxs(C,{children:[a.jsx(D,{children:a.jsx("span",{children:e})}),a.jsx(A,{children:a.jsx("p",{children:s})})]})}),ke=s=>[{id:"actions",cell:({row:e})=>{const n=e.original;return a.jsx("div",{className:"flex gap-2",children:a.jsx("span",{"aria-label":"Eliminar",className:"flex h-6 w-6 cursor-pointer items-center justify-center rounded-md bg-red-700 text-xs text-white hover:bg-red-900 dark:bg-red-600 dark:hover:bg-red-800",onClick:()=>s(n.id,"e-annex"),children:a.jsx(M,{className:"h-4 w-4"})})})}},{accessorKey:"uea",header:"UEA",cell:e=>p("UEA",e.getValue())},{accessorKey:"type",header:"Tipo",cell:e=>p("Tipo",e.getValue())},{accessorKey:"company",header:"Contrata",cell:e=>p("Compañía",e.getValue())},{accessorKey:"concession_code",header:()=>p("Codigo de la Concesion","Código de la Concesión"),cell:e=>a.jsx("span",{children:e.getValue()})},{accessorKey:"male_managers",header:()=>p("Gerentes Hombres","Gerentes H."),cell:e=>a.jsx("span",{children:e.getValue()})},{accessorKey:"male_administrative",header:()=>p("Administrativos Hombres","Administrativos H."),cell:e=>a.jsx("span",{children:e.getValue()})},{accessorKey:"male_general_operations",header:()=>p("Operaciones Generales Hombres","Operaciones Generales H."),cell:e=>a.jsx("span",{children:e.getValue()})},{accessorKey:"male_plant_staff",header:()=>p("Personal de Planta Hombres","Personal de Planta H."),cell:e=>a.jsx("span",{children:e.getValue()})},{accessorKey:"female_managers",header:()=>p("Gerentes Mujeres","Gerentes M."),cell:e=>a.jsx("span",{children:e.getValue()})},{accessorKey:"female_administrative",header:()=>p("Administrativos Mujeres","Administrativos M."),cell:e=>a.jsx("span",{children:e.getValue()})},{accessorKey:"female_plant_staff",header:()=>p("Personal de Planta Mujeres","Personal de Planta M."),cell:e=>a.jsx("span",{children:e.getValue()})},{accessorKey:"female_general_operations",header:()=>p("Operaciones Generales Mujeres","Operaciones Generales M."),cell:e=>a.jsx("span",{children:e.getValue()})}];function He({columns:s,data:e,ueas:n=[]}){var T;const[g,y]=d.useState([]),[b,N]=d.useState(""),[v,w]=d.useState("__all__"),[i,U]=d.useState("__all__"),I=d.useMemo(()=>{let r=e;if(b){const c=b.toLowerCase();r=r.filter(x=>x.nombre&&x.nombre.toLowerCase().includes(c)||x.ruc&&x.ruc.toLowerCase().includes(c))}return v&&v!=="__all__"&&(r=r.filter(c=>c.estado===v)),i&&i!=="__all__"&&(r=r.filter(c=>Array.isArray(c.anexos)&&c.anexos.some(x=>String(x.uea)===i))),r},[e,b,v,i]),j=ye({data:I,columns:s,getCoreRowModel:fe(),getPaginationRowModel:Ve(),onSortingChange:y,getSortedRowModel:_e(),onGlobalFilterChange:N,getFilteredRowModel:be(),state:{sorting:g,globalFilter:b}}),S=d.useMemo(()=>Array.from(new Set(e.map(c=>c.estado).filter(Boolean))),[e]);console.log("UEA Options:",n);const $=d.useMemo(()=>{if(n&&n.length>0)return n[0]&&"name"in n[0]?n.map(c=>({value:c.name,label:c.name})):n;const r=new Set;return e.forEach(c=>{Array.isArray(c.anexos)&&c.anexos.forEach(x=>{x.uea&&r.add(x.uea)})}),Array.from(r).map(c=>({value:c,label:c}))},[e,n]);return a.jsxs("div",{children:[a.jsxs("div",{className:"flex flex-wrap items-center py-4 gap-4",children:[a.jsx(F,{placeholder:"Filtrar por nombre o RUC...",value:b,onChange:r=>N(r.target.value),className:"max-w-sm"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("label",{className:"text-sm",children:"Estado"}),a.jsxs(le,{value:v,onValueChange:w,children:[a.jsx(re,{className:"w-auto",children:a.jsx(ce,{placeholder:"Todos"})}),a.jsxs(ne,{children:[a.jsx(R,{value:"__all__",children:"Todos"}),S.map(r=>a.jsx(R,{value:String(r),children:r},r))]})]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("label",{className:"text-sm",children:"UEA"}),a.jsxs(le,{value:i,onValueChange:U,children:[a.jsx(re,{className:"w-auto",children:a.jsx(ce,{placeholder:"Todas"})}),a.jsxs(ne,{children:[a.jsx(R,{value:"__all__",children:"Todas"}),$.map(r=>a.jsx(R,{value:r.value,children:r.label},r.value))]})]})]})]}),a.jsx("div",{className:"grid grid-cols-1 rounded-md border",children:a.jsxs(ve,{className:"text-xs",children:[a.jsx(Te,{children:j.getHeaderGroups().map(r=>a.jsx(q,{children:r.headers.map(c=>a.jsx(Ke,{children:c.isPlaceholder?null:ee(c.column.columnDef.header,c.getContext())},c.id))},r.id))}),a.jsx(Ce,{children:(T=j.getRowModel().rows)!=null&&T.length?j.getRowModel().rows.map(r=>a.jsx(q,{"data-state":r.getIsSelected()&&"selected",children:r.getVisibleCells().map(c=>a.jsx(ae,{children:ee(c.column.columnDef.cell,c.getContext())},c.id))},r.id)):a.jsx(q,{children:a.jsx(ae,{colSpan:s.length,className:"h-24 text-center",children:"No results."})})})]})}),a.jsxs("div",{className:"flex items-center justify-end space-x-2 py-4",children:[a.jsx(se,{variant:"outline",size:"sm",onClick:()=>j.previousPage(),disabled:!j.getCanPreviousPage(),children:"Previous"}),a.jsx(se,{variant:"outline",size:"sm",onClick:()=>j.nextPage(),disabled:!j.getCanNextPage(),children:"Next"})]})]})}const oe=[{value:"anexo24",title:"Anexo 24",description:"Detalles del Anexo 24.",abbreviation:"A24"},{value:"anexo25",title:"Anexo 25",description:"Detalles del Anexo 25.",abbreviation:"A25"},{value:"anexo26",title:"Anexo 26",description:"Detalles del Anexo 26.",abbreviation:"A26"},{value:"anexo27",title:"Anexo 27",description:"Detalles del Anexo 27.",abbreviation:"A27"},{value:"anexo28",title:"Anexo 28",description:"Detalles del Anexo 28.",abbreviation:"A28"},{value:"anexo30",title:"Anexo 30",description:"Detalles del Anexo 30.",abbreviation:"A30"},{value:"minem1",title:"Minem 1",description:"Detalles del Minem 1.",abbreviation:"M1"},{value:"minem2",title:"Minem 2",description:"Detalles del Minem 2.",abbreviation:"M2"}],Pe=[{title:"Consolidados",href:"/consolidated"},{title:"Detalle del Consolidado",href:"/consolidated/show"}];function Re({data:s}){return a.jsxs(B,{className:"flex h-full w-full flex-col justify-between",children:[a.jsxs(z,{children:[a.jsx(J,{children:"Instrucciones:"}),a.jsx(te,{children:a.jsxs("ul",{className:"list-disc pl-5",children:[a.jsx("li",{children:"En este apartado verás el resumen general del consolidado por UEA, año, mes."}),a.jsx("li",{children:"Si deseas quitar alguna empresa, solo debes quitar la empresa de las tablas de las contratas que subieron data y de las que no subieron data."}),a.jsx("li",{children:"Para eliminar algún registro de una empresa, solo tienes que eliminar del historial de registros y se eliminarán todos los datos subidos para este año y mes."})]})})]}),a.jsx(Q,{children:a.jsxs("div",{className:"grid w-full grid-cols-1 items-center gap-4 md:grid-cols-2",children:[a.jsxs("div",{className:"flex flex-col space-y-1.5",children:[a.jsx(W,{children:"MES:"}),a.jsx(F,{value:he(xe,"value",s.month,"label"),readOnly:!0})]}),a.jsxs("div",{className:"flex flex-col space-y-1.5",children:[a.jsx(W,{children:"AÑO:"}),a.jsx(F,{value:s.year||"N/A",readOnly:!0})]})]})})]})}function f(s,e){const n=[];return s.forEach(g=>{g[e]&&g[e].forEach(y=>{y.company=g.company.nombre,y.uea=g.uea.name,y.type=g.contractor_company_type.name,n.push(y)})}),n}function ba(){const[s,e]=d.useState(!1),[n,g]=d.useState(null),[y,b]=d.useState(!1),[N,v]=d.useState(null),{consolidated:w,fileStatuses:i,ueas:U,companyConsolidateds:I,auth:j,companyConsolidatedData:S}=de().props;console.log("companyConsolidateds",I);const $=j.user.role_code,T=d.useMemo(()=>f(i,"annex24"),[i]),r=d.useMemo(()=>f(i,"annex25"),[i]),c=d.useMemo(()=>f(i,"annex26"),[i]),x=d.useMemo(()=>f(i,"annex27"),[i]),O=d.useMemo(()=>f(i,"annex28"),[i]),k=d.useMemo(()=>f(i,"annex30"),[i]),H=d.useMemo(()=>f(i,"minem_template1"),[i]),P=d.useMemo(()=>f(i,"minem_template2"),[i]),ie=d.useMemo(()=>({annex24:T,annex25:r,annex26:c,annex27:x,annex28:O,annex30:k,minem_template_1:H,minem_template_2:P}),[T,r,c,x,O,k,H,P]),_=d.useCallback((m,h)=>{switch(h){case"e-c":g(m),e(!0);break;case"e-a":v(m),b(!0);break}},[]),X=d.useMemo(()=>{const m={};return S.forEach(h=>{const G=h.company_ruc;m[G]||(m[G]={nombre:h.company_name,ruc:h.company_ruc,anexos:[]}),(h.uea_name||h.contractor_type_name||h.file_status_updated_at)&&m[G].anexos.push({uea:h.uea_name,tipo:h.contractor_type_name,fecha:h.file_status_updated_at})}),Object.values(m).map(h=>({nombre:h.nombre,ruc:h.ruc,estado:h.anexos.length>0?"Subió":"No subió nada",anexos:h.anexos}))},[S]);return console.log("Transformed Companies:",X),a.jsxs(De,{breadcrumbs:Pe,children:[a.jsx(me,{title:"Detalle del Consolidado"}),a.jsxs("div",{className:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4",children:[$==="CA"&&a.jsx(a.Fragment,{children:a.jsxs("div",{className:"grid grid-cols-12 gap-4",children:[a.jsx("div",{className:"col-span-12 md:col-span-6 lg:col-span-4",children:a.jsx(Re,{data:w})}),a.jsx("div",{className:"col-span-12 md:col-span-12 lg:col-span-8",children:a.jsx(Ae,{data:ie})}),a.jsx("div",{className:"col-span-12",children:a.jsxs(pe,{defaultValue:"anexo24",className:"w-full",children:[a.jsx(ge,{className:"grid w-full grid-cols-8",children:oe.map(m=>a.jsxs(ue.Fragment,{children:[a.jsx(Z,{value:m.value,className:"sm:hidden",children:m.abbreviation}),a.jsx(Z,{value:m.value,className:"hidden sm:block",children:m.title})]},m.value))}),oe.map(m=>a.jsx(je,{value:m.value,children:a.jsxs(B,{children:[a.jsxs(z,{children:[a.jsx(J,{children:m.title}),a.jsx(te,{children:m.description})]}),a.jsx(Q,{className:"space-y-2",children:(()=>{switch(m.value){case"anexo24":return a.jsx(V,{columns:L(_),data:Array.isArray(T)?T:[]});case"anexo25":return a.jsx(V,{columns:L(_),data:Array.isArray(r)?r:[]});case"anexo26":return a.jsx(V,{columns:L(_),data:Array.isArray(c)?c:[]});case"anexo27":return a.jsx(V,{columns:L(_),data:Array.isArray(x)?x:[]});case"anexo28":return a.jsx(V,{columns:Me(_),data:Array.isArray(O)?O:[]});case"anexo30":return a.jsx(V,{columns:we(_),data:Array.isArray(k)?k:[]});case"minem1":return a.jsx(V,{columns:Oe(_),data:Array.isArray(H)?H:[]});case"minem2":return a.jsx(V,{columns:ke(_),data:Array.isArray(P)?P:[]});default:return a.jsxs("div",{className:"space-y-1",children:[a.jsx(W,{htmlFor:`${m.value}-name`,children:"Nombre"}),a.jsx(F,{id:`${m.value}-name`})]})}})()})]})},m.value))]})})]})}),a.jsx("div",{className:"grid grid-cols-1",children:a.jsxs(B,{children:[a.jsx(z,{children:a.jsx(J,{children:"Contratas que subieron sus Excel"})}),a.jsx(Q,{children:a.jsx(He,{columns:Se(),data:X,ueas:U})})]})})]}),n&&a.jsx(Ee,{isOpen:s,onOpenChange:e,company:n,consolidated_id:w.id}),N&&a.jsx(Ne,{isOpen:y,onOpenChange:b,fileStatus:N})]})}export{ba as default};
