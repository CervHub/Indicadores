import{j as e,r as d,$ as P,K as E,L as F}from"./app-9SkBCnxB.js";import{B as z}from"./badge-DAj79e8T.js";import{B as c}from"./button-BSymzP0_.js";import{f as j}from"./utils-DU6Hee-i.js";import{A as u}from"./arrow-up-down-Czzw2xC7.js";import{E as M}from"./eye-DitrKEru.js";import{F as K,A}from"./app-layout-BnNsKGC8.js";import{u as O,f as v,g as B,a as L,b as G,c as U}from"./index-Cdto1tfn.js";import{T as V,a as H,b as h,c as $,d as W,e as _}from"./table-Dbw4NuyE.js";import{I as w}from"./input-DzwZ1ROS.js";import{S,a as C,b as N,c as T,f as y}from"./select-DNMspdwF.js";import"./index-CaTUMqUi.js";import"./index-BYGN5s2_.js";import"./index-CmNj4hS3.js";import"./index-BQJ99LjQ.js";import"./index-Di5oTgJ8.js";import"./tooltip-DfpUQjUn.js";import"./index-PvkkbA5c.js";import"./index-SRZyBjgN.js";import"./index-DWz6o9NP.js";import"./chevrons-up-down-DaJykHmQ.js";import"./truck-BJg_5nqp.js";import"./chevron-right-3mAzgvxi.js";import"./check-dHt7Y97-.js";const q=()=>[{accessorKey:"id",header:({column:l})=>e.jsxs(c,{variant:"ghost",onClick:()=>l.toggleSorting(l.getIsSorted()==="asc"),className:"p-0",children:["ID",e.jsx(u,{className:"ml-2 h-4 w-4"})]}),maxSize:60},{accessorKey:"fecha_evento",header:({column:l})=>e.jsxs(c,{variant:"ghost",onClick:()=>l.toggleSorting(l.getIsSorted()==="asc"),className:"p-0",children:["Fecha Evento",e.jsx(u,{className:"ml-2 h-4 w-4"})]}),cell:({row:l})=>j(l.original.fecha_evento)},{accessorKey:"fecha_reporte",header:({column:l})=>e.jsxs(c,{variant:"ghost",onClick:()=>l.toggleSorting(l.getIsSorted()==="asc"),className:"p-0",children:["Fecha Reporte",e.jsx(u,{className:"ml-2 h-4 w-4"})]}),cell:({row:l})=>j(l.original.fecha_reporte)},{accessorKey:"tipo_inspeccion_descripcion",header:"Tipo Inspección"},{accessorKey:"nombre_usuario",header:"Usuario"},{accessorKey:"nombre_empresa",header:"Empresa"},{accessorKey:"estado",header:"Estado",cell:({row:l})=>{const o=l.original.estado;let i="",r="";switch(o){case"Generado":i="bg-blue-500 text-white",r="Generado";break;case"Revisado":i="bg-orange-500 text-white",r="Revisado";break;case"Finalizado":i="bg-green-600 text-white",r="Finalizado";break;default:i="bg-gray-500 text-white",r=o;break}return e.jsx(z,{variant:"default",className:i,children:r})}},{accessorKey:"acciones",header:"Acciones",cell:({row:l})=>{const[o,i]=d.useState(!1),r=route("inspection.detalle",{reportability_id:l.original.id}),p=route("inspection.download",{reportability_id:l.original.id}),x=()=>{i(!0)},t=()=>{window.open(p,"_blank")};return e.jsxs("div",{className:"flex flex-wrap space-x-2",children:[e.jsx(P,{href:r,className:"flex items-center",children:e.jsxs(c,{variant:"warning","aria-label":"Toggle detalle",className:`flex h-7 items-center p-2 text-xs text-white ${o?"cursor-not-allowed opacity-50":""}`,onClick:x,disabled:o,children:[e.jsx(M,{className:"h-3 w-3"})," Detalle"]})}),e.jsxs(c,{"aria-label":"Toggle pdf",className:"h-7 bg-red-700 p-2 text-xs text-white hover:bg-red-900 dark:bg-red-600 dark:hover:bg-red-800",onClick:t,children:[e.jsx(K,{className:"h-3 w-3"})," PDF"]})]})},minSize:200}],J=[{value:"all",label:"Todos"},{value:"Inspección Diaria Pre-Uso",label:"Inspección Diaria Pre-Uso"},{value:"Inspección Trimestral",label:"Inspección Trimestral"},{value:"Inspección Semestral",label:"Inspección Semestral"},{value:"Inspección Anual",label:"Inspección Anual"}],Q=[{value:"all",label:"Todos"},{value:"Generado",label:"Generado"},{value:"Revisado",label:"Revisado"},{value:"Finalizado",label:"Finalizado"}];function X({columns:l,data:o}){var b;const[i,r]=d.useState([{id:"fecha_evento",desc:!0}]),[p,x]=d.useState(""),[t,m]=d.useState({tipo_inspeccion_descripcion:"all",nombre_usuario:"",nombre_empresa:"",estado:"all"}),I=d.useMemo(()=>o.filter(a=>{var g,f;const s=t.tipo_inspeccion_descripcion!=="all"?a.tipo_inspeccion_descripcion===t.tipo_inspeccion_descripcion:!0,k=t.nombre_usuario?(g=a.nombre_usuario)==null?void 0:g.toLowerCase().includes(t.nombre_usuario.toLowerCase()):!0,R=t.nombre_empresa?(f=a.nombre_empresa)==null?void 0:f.toLowerCase().includes(t.nombre_empresa.toLowerCase()):!0,D=t.estado!=="all"?a.estado===t.estado:!0;return s&&k&&R&&D}),[o,t]),n=O({data:I,columns:l,getCoreRowModel:U(),getPaginationRowModel:G(),onSortingChange:r,getSortedRowModel:L(),onGlobalFilterChange:x,getFilteredRowModel:B(),state:{sorting:i,globalFilter:p}});return e.jsxs("div",{children:[e.jsxs("div",{className:"mb-4 flex flex-col gap-2 md:flex-row md:items-end md:gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold mb-1",children:"Tipo Inspección"}),e.jsxs(S,{value:t.tipo_inspeccion_descripcion,onValueChange:a=>m(s=>({...s,tipo_inspeccion_descripcion:a})),children:[e.jsx(C,{className:"w-48 text-xs",children:e.jsx(N,{placeholder:"Tipo Inspección"})}),e.jsx(T,{children:J.map(a=>e.jsx(y,{value:a.value,children:a.label},a.value))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold mb-1",children:"Usuario"}),e.jsx(w,{type:"text",className:"text-xs",placeholder:"Buscar usuario",value:t.nombre_usuario,onChange:a=>m(s=>({...s,nombre_usuario:a.target.value}))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold mb-1",children:"Empresa"}),e.jsx(w,{type:"text",className:"text-xs",placeholder:"Buscar empresa",value:t.nombre_empresa,onChange:a=>m(s=>({...s,nombre_empresa:a.target.value}))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold mb-1",children:"Estado"}),e.jsxs(S,{value:t.estado,onValueChange:a=>m(s=>({...s,estado:a})),children:[e.jsx(C,{className:"w-32 text-xs",children:e.jsx(N,{placeholder:"Estado"})}),e.jsx(T,{children:Q.map(a=>e.jsx(y,{value:a.value,children:a.label},a.value))})]})]})]}),e.jsx("div",{className:"grid grid-cols-1 rounded-md border",children:e.jsxs(V,{className:"text-xs",children:[e.jsx(H,{children:n.getHeaderGroups().map(a=>e.jsx(h,{children:a.headers.map(s=>e.jsx($,{style:{minWidth:s.column.columnDef.minSize&&s.column.columnDef.minSize!==0?s.column.columnDef.minSize:"auto",maxWidth:s.column.columnDef.maxSize&&s.column.columnDef.maxSize!==0?s.column.columnDef.maxSize:"auto"},children:s.isPlaceholder?null:v(s.column.columnDef.header,s.getContext())},s.id))},a.id))}),e.jsx(W,{children:(b=n.getRowModel().rows)!=null&&b.length?n.getRowModel().rows.map(a=>e.jsx(h,{"data-state":a.getIsSelected()&&"selected",children:a.getVisibleCells().map(s=>e.jsx(_,{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:v(s.column.columnDef.cell,s.getContext())},s.id))},a.id)):e.jsx(h,{children:e.jsx(_,{colSpan:l.length,className:"h-24 text-center",children:"No results."})})})]})}),e.jsxs("div",{className:"flex items-center justify-end space-x-2 py-4",children:[e.jsx(c,{variant:"outline",size:"sm",onClick:()=>n.previousPage(),disabled:!n.getCanPreviousPage(),children:"Previous"}),e.jsx(c,{variant:"outline",size:"sm",onClick:()=>n.nextPage(),disabled:!n.getCanNextPage(),children:"Next"})]})]})}const Y=[{title:"Reportabilidad",href:"/admin/reportability"}];function Se(){const{inspectionVehicles:l,isSecurityEngineer:o}=E().props;return e.jsxs(A,{breadcrumbs:Y,children:[e.jsx(F,{title:"Reportabilidad de inspecciones"}),e.jsx("div",{className:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4",children:e.jsx(X,{columns:q(),data:l})})]})}export{Se as default};
