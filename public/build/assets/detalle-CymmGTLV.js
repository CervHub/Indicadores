import{K as F,r as t,j as e,L as E}from"./app-CkX-sCCf.js";import{B as L}from"./button-Bw2Xdp6E.js";import{C as d,a as n,b as c,d as p}from"./card-Alk4mtLg.js";import{I as a}from"./input-MjwaqtbJ.js";import{L as s}from"./label-B68sH3c7.js";import{A as S}from"./app-layout-NwK8qtki.js";import{h as D,f as O}from"./utils-Co_qxGNv.js";import P from"./closed-C_RPXsjB.js";import"./index-ItJPPwpU.js";import"./index-uPTyyJTB.js";import"./index-C0Urlq2e.js";import"./createLucideIcon-Cux2gun-.js";import"./index-BbjDzo9d.js";import"./tooltip-CeYhT-Ve.js";import"./index-RgIy1NKL.js";import"./index-DiuJ2rgF.js";import"./index-BeeyGmDn.js";import"./check-DYdSJAZQ.js";import"./chevrons-up-down-BuW2oQV_.js";import"./truck-CJs_TKyA.js";import"./file-text-BQQHQTRf.js";import"./chevron-right-D5H3JAm1.js";import"./index-CNC3jUVX.js";import"./index-CswDWhBD.js";import"./index-Chjiymov.js";import"./dialog-CQ0eMQJ3.js";import"./upload-C6klKBR_.js";import"./trash-2-C_t5SLgw.js";import"./loader-circle-B0rPJdrL.js";const z=[{title:"Reportabilidad",href:"/admin/reportability"},{title:"Detalle",href:"/admin/reportability/detalle"}];function ce(){const{reportability_id:o,reportability:r,isSecurityEngineer:m,canCloseReport:x}=F().props;console.log("ReportabilityPage",o,r,m,x);const[h,u]=t.useState(!0),[l,f]=t.useState(null),[v,j]=t.useState(!1),[_,g]=t.useState(0),[A,C]=t.useState(y(r.estado)),b=route("company.reportability.download",{reportability_id:o}),N=()=>{u(!1),f(null)},R=()=>{u(!1),f("No se pudo cargar el PDF")};t.useEffect(()=>{g(i=>i+1),C(y(r.estado))},[r.estado]);function y(i){switch(i){case"Generado":return 0;case"Revisado":case"Visualizado":return 1;case"Cerrado":case"Finalizado":return 2;default:return 0}}return e.jsxs(S,{breadcrumbs:z,children:[e.jsx(E,{title:"Reportabilidad"}),e.jsx("div",{className:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4",children:e.jsxs("div",{className:"grid h-full grid-cols-12 gap-4",children:[e.jsxs(d,{className:"col-span-12 h-full md:col-span-8",children:[e.jsx(n,{children:e.jsx(c,{children:"Reporte"})}),e.jsxs(p,{children:[h&&e.jsx("p",{children:"Cargando PDF..."}),l&&e.jsx("p",{children:l}),e.jsx("iframe",{src:b,width:"100%",height:"759",onLoad:N,onError:R,style:{display:h||l?"none":"block"}},_)]})]}),e.jsxs("div",{className:"col-span-12 flex h-full flex-col gap-4 md:col-span-4",children:[e.jsxs(d,{children:[e.jsx(n,{children:e.jsx(c,{children:"Acciones del Reporte"})}),e.jsxs(p,{children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Una vez cerrado el reporte, no podrá ser modificado. Asegúrese de que toda la información esté correcta antes de proceder."}),e.jsx("div",{className:"flex gap-2",children:e.jsx(L,{variant:"destructive",onClick:()=>j(!0),disabled:!x||r.estado==="Cerrado"||r.estado==="Finalizado"||!m,children:"Cerrar Reporte"})})]})]}),e.jsxs(d,{className:"flex flex-1 flex-col",children:[e.jsx(n,{children:e.jsx(c,{children:"Detalles del reporte"})}),e.jsxs(p,{className:"flex flex-col gap-2 space-y-2",children:[e.jsxs("div",{className:"space-y-2 d-none",children:[e.jsx(s,{htmlFor:"estado",children:"Estado"}),e.jsx(a,{id:"estado",type:"text",value:r.estado,readOnly:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(s,{htmlFor:"tipo_reporte",children:"Tipo de Reporte"}),e.jsx(a,{id:"tipo_reporte",type:"text",value:r.tipo_reporte,readOnly:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(s,{htmlFor:"company_name",children:"Compañía"}),e.jsx(a,{id:"company_name",type:"text",value:r.company_name,readOnly:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(s,{htmlFor:"company_report_name",children:"Compañía Reportada"}),e.jsx(a,{id:"company_report_name",type:"text",value:r.company_report_name,readOnly:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(s,{htmlFor:"fecha_evento",children:"Fecha de Evento"}),e.jsx(a,{id:"fecha_evento",type:"text",value:D(r.fecha_evento),readOnly:!0})]}),r.report_closed_at&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(s,{htmlFor:"fecha_cierre",children:"Fecha de Cierre"}),e.jsx(a,{id:"fecha_cierre",type:"text",value:O(r.report_closed_at),readOnly:!0})]})]})]})]})]})}),e.jsx(P,{report_id:o,isDialogOpen:v,setIsDialogOpen:j})]})}export{ce as default};
