import{K as I,m as w,r as E,j as e}from"./app-DL-haAjQ.js";import{I as o}from"./input-error-jrpOyoDk.js";import{B as g}from"./button-slxFOLX6.js";import{D as V,a as T,b as L,c as q,d as R,e as O}from"./dialog-D5lu6PBX.js";import{I as U}from"./input-Dp5gancy.js";import{L as t}from"./label-CjKXDJWW.js";import{S as c,a as d,b as m,c as h,d as p,e as x,f as u}from"./select-CSU9kjYK.js";import{m as k}from"./utils-BXZQgxmQ.js";import{F as B,t as G}from"./index-xT5dapY8.js";import{L as M}from"./loader-circle-C6ZCBZuL.js";import"./index-DanSS8Bx.js";import"./index-4hjVkEVw.js";import"./index-DwZDYCBG.js";import"./index-Bvopg-KR.js";import"./index-CRgFl1ff.js";import"./index-Cd5az8kG.js";function le({rules:y}){const{contractorCompanyTypes:_,ueas:v}=I().props,{data:r,setData:l,post:S,processing:f,errors:n,reset:C}=w({contractor_company_type_id:"",uea_id:"",year:"",month:"",file:null}),[N,j]=E.useState(!1),D=()=>y.filter(i=>parseInt(i.year)===parseInt(r.year)).some(i=>parseInt(i.month)===parseInt(r.month)),b=s=>{if(s.preventDefault(),D()){G.error("No se puede subir el archivo en el mes seleccionado, porque esta cerrado, comuniquese con el administrador.");return}S(route("annexes.store"),{onSuccess:a=>{var i;C(),j(!1),console.log("Solicitud de creación exitosa:",(i=a==null?void 0:a.props)==null?void 0:i.flash)},onError:a=>{j(!0),console.log("Errores en la solicitud de creación:",a)}})},A=()=>r.contractor_company_type_id&&r.uea_id&&r.year&&r.month&&r.file,F=Array.from({length:10},(s,a)=>new Date().getFullYear()-a);return e.jsx("div",{children:e.jsxs(V,{open:N,onOpenChange:j,children:[e.jsxs("div",{className:"flex justify-start",children:[e.jsx(T,{asChild:!0,children:e.jsx("div",{className:"flex w-full justify-between",children:e.jsx(g,{className:"inline-block px-4 py-2",children:"Agregar Anexos"})})}),e.jsxs(g,{variant:"success",className:"ml-2",onClick:()=>window.location.href="/formats/formato.xlsx",children:[e.jsx(B,{className:"mr-2 h-4 w-4"}),"Formato"]})]}),e.jsxs(L,{className:"sm:max-w-[425px]",children:[e.jsxs(q,{children:[e.jsx(R,{children:"Agregar Contratista"}),e.jsx(O,{children:"Complete los campos para agregar un nuevo contratista."})]}),e.jsxs("form",{onSubmit:b,className:"space-y-3",method:"post",action:route("contractor.store"),encType:"multipart/form-data",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(t,{htmlFor:"contractor_company_type_id",children:"Tipo de Cliente"}),e.jsxs(c,{required:!0,onValueChange:s=>l("contractor_company_type_id",s),value:r.contractor_company_type_id,children:[e.jsx(d,{children:e.jsx(m,{placeholder:"Seleccione un tipo de cliente"})}),e.jsx(h,{children:e.jsxs(p,{children:[e.jsx(x,{children:"Tipos de Cliente"}),_.map(s=>e.jsx(u,{value:String(s.id),children:s.name},s.id))]})})]}),e.jsx(o,{message:n.contractor_company_type_id})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(t,{htmlFor:"uea_id",children:"UEA"}),e.jsxs(c,{onValueChange:s=>l("uea_id",s),value:r.uea_id,children:[e.jsx(d,{children:e.jsx(m,{placeholder:"Seleccione una UEA"})}),e.jsx(h,{children:e.jsxs(p,{children:[e.jsx(x,{children:"UEAs"}),v.map(s=>e.jsx(u,{value:String(s.id),children:s.name},s.id))]})})]}),e.jsx(o,{message:n.uea_id})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(t,{htmlFor:"year",children:"Año"}),e.jsxs(c,{onValueChange:s=>l("year",s),value:r.year,children:[e.jsx(d,{children:e.jsx(m,{placeholder:"Seleccione un año"})}),e.jsx(h,{children:e.jsxs(p,{children:[e.jsx(x,{children:"Años"}),F.map(s=>e.jsx(u,{value:String(s),children:s},s))]})})]}),e.jsx(o,{message:n.year})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(t,{htmlFor:"month",children:"Mes"}),e.jsxs(c,{onValueChange:s=>l("month",s),value:r.month,children:[e.jsx(d,{children:e.jsx(m,{placeholder:"Seleccione un mes"})}),e.jsx(h,{children:e.jsxs(p,{children:[e.jsx(x,{children:"Meses"}),k.map(s=>e.jsx(u,{value:s.value,children:s.label},s.value))]})})]}),e.jsx(o,{message:n.month})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(t,{htmlFor:"file",children:"Archivo"}),e.jsx(U,{type:"file",id:"file",required:!0,accept:".xlsx,.xls",onChange:s=>l("file",s.target.files?s.target.files[0]:null)}),e.jsx(o,{message:n.file})]}),e.jsxs(g,{type:"submit",className:"mt-2",disabled:!A()||f,children:[f&&e.jsx(M,{className:"h-4 w-4 animate-spin"}),"Guardar"]})]})]})]})})}export{le as default};
