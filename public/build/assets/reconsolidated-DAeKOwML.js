import{m as R,r,j as e}from"./app-B1_KnvdL.js";import{B as g}from"./button-C-_Qybau.js";import{D as E,b as y,c as v,d as B,e as N}from"./dialog-DuUwFcWZ.js";import{m as w}from"./utils-CISCwvQU.js";import{t as d}from"./index-Cca7i4F-.js";import{L as S}from"./loader-circle-CLa58NcO.js";import"./index-CdeOVbM3.js";import"./createLucideIcon-BNgsHN6x.js";import"./index-B0b4fhsK.js";import"./index-D_lO51ZX.js";function G({initialYear:i,initialMonth:c,isOpen:l=!1,onOpenChange:t}){var x;const{data:u,setData:m,post:D,processing:f,reset:j}=R({year:i,month:c,reconsolidated:!0}),[n,o]=r.useState(l),b=r.useRef(null);r.useEffect(()=>{o(l)},[l]),r.useEffect(()=>{m("year",i),m("month",c)},[i,c,m]),r.useEffect(()=>{if(n){const s=setTimeout(()=>{p()},100);return()=>clearTimeout(s)}},[n]);const p=s=>{s&&s.preventDefault(),D(route("consolidated.store"),{onSuccess:h=>{const a=h.props.flash;a.success&&(d.success(a.success),o(!1),j(),t&&t(!1)),a.error&&(o(!1),d.error(a.error))},onError:h=>{o(!0),d.error("Ocurrió un error al reconsolidar")}})};return e.jsx("div",{children:e.jsx(E,{open:n,onOpenChange:s=>{o(s),t&&t(s)},modal:!0,children:e.jsxs(y,{className:"sm:max-w-[425px]",onInteractOutside:s=>s.preventDefault(),showCloseButton:!1,children:[e.jsxs(v,{children:[e.jsx(B,{children:"Reconsolidando"}),e.jsxs(N,{children:["Reconsolidando para el mes de ",(x=w.find(s=>s.value===u.month))==null?void 0:x.label," para el año de ",u.year,"."]})]}),e.jsx("form",{onSubmit:p,className:"space-y-3",method:"post",action:route("consolidated.store"),children:e.jsxs(g,{ref:b,type:"submit",className:"mt-2",disabled:f,children:[f&&e.jsx(S,{className:"h-4 w-4 animate-spin"}),"Reconsolidar"]})})]})})})}export{G as default};
