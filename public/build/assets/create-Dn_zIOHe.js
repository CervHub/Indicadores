import{K as A,m as T,r as t,j as e}from"./app-CTL5S9iY.js";import{I as h}from"./input-error-eBVurzc1.js";import{B as j}from"./button-CXUJ0U03.js";import{D as B,a as G,b as k,c as H,d as K,e as R}from"./dialog-Bow5bgQW.js";import{L as p}from"./label-DL_p19np.js";import{S as f,a as g,b as S,c as b,d as v,e as D,f as y}from"./select-DqDnb1_4.js";import{m as _}from"./utils-2YzkRP5P.js";import{L as q}from"./loader-circle-C52BI5FE.js";import"./index-BCT-lbNC.js";import"./index-D0mu6X-q.js";import"./index-BnBYLySk.js";import"./index-D1sDU56J.js";function ee({initialYear:d=0,initialMonth:m=0,isOpen:a=!1,onOpenChange:c}){const{flash:i}=A().props,{data:r,setData:o,post:C,processing:u,errors:x,reset:N}=T({year:d,month:m}),[E,n]=t.useState(a),[F,I]=t.useState(!1);t.useEffect(()=>{I(r.year!==0&&r.month!==0)},[r]),t.useEffect(()=>{n(a)},[a]),t.useEffect(()=>{a&&(o("year",d),o("month",m))},[d,m,a,o]);const L=s=>{s.preventDefault(),C(route("consolidated.store"),{onSuccess:l=>{N(),n(!1),c&&c(!1),console.log("Solicitud de creación exitosa:",l)},onError:l=>{n(!0),console.log("Errores en la solicitud de creación:",l)}})},V=new Date().getFullYear(),w=Array.from({length:V-2023+1},(s,l)=>2023+l);return e.jsxs("div",{children:[(i==null?void 0:i.success)&&e.jsx("div",{className:"mb-4 text-green-600",children:i.success}),e.jsxs(B,{open:E,onOpenChange:s=>{n(s),c&&c(s)},children:[e.jsx("div",{className:"flex justify-start",children:e.jsx(G,{asChild:!0,children:e.jsx(j,{className:"inline-block px-4 py-2",children:"Crear Consolidado"})})}),e.jsxs(k,{className:"sm:max-w-[425px]",children:[e.jsxs(H,{children:[e.jsx(K,{children:"Crear Consolidado"}),e.jsx(R,{children:"Complete los campos para crear un nuevo consolidado."})]}),e.jsxs("form",{onSubmit:L,className:"space-y-3",method:"post",action:route("consolidated.store"),children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(p,{htmlFor:"year",children:"Año"}),e.jsxs(f,{onValueChange:s=>o("year",Number(s)),value:r.year?String(r.year):"",children:[e.jsx(g,{children:e.jsx(S,{placeholder:"Seleccione un año"})}),e.jsx(b,{children:e.jsxs(v,{children:[e.jsx(D,{children:"Años"}),w.map(s=>e.jsx(y,{value:String(s),children:s},s))]})})]}),e.jsx(h,{message:x.year})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(p,{htmlFor:"month",children:"Mes"}),e.jsxs(f,{onValueChange:s=>o("month",Number(s)),value:r.month?String(r.month):"",children:[e.jsx(g,{children:e.jsx(S,{placeholder:"Seleccione un mes"})}),e.jsx(b,{children:e.jsxs(v,{children:[e.jsx(D,{children:"Meses"}),_.map(s=>e.jsx(y,{value:s.value,children:s.label},s.value))]})})]}),e.jsx(h,{message:x.month})]}),e.jsxs(j,{type:"submit",className:"mt-2",disabled:u||!F,children:[u&&e.jsx(q,{className:"h-4 w-4 animate-spin"}),"Generar"]})]})]})]})]})}export{ee as default};
