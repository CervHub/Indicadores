import{K as w,m as E,r as T,j as e}from"./app-Cn-5C3ys.js";import{I as o}from"./input-error-BkfFglKD.js";import{B as f}from"./button-BfsQPnlH.js";import{D as B,a as L,b as O,c as R,d as U,e as k}from"./dialog-D3OTCAka.js";import{I as q}from"./input-Lnzueksd.js";import{L as l}from"./label-BzIOxSAd.js";import{S as c,a as d,b as m,c as u,d as p,e as h,f as x}from"./select-BXbEI3Eh.js";import{m as G}from"./utils-U4jazdRL.js";import{F as M,t as j}from"./index-D8D9BEB_.js";import{L as H}from"./loader-circle-ubJ9Lzej.js";import"./index-DPkw7taS.js";import"./index-D9Yd4Kyp.js";import"./index-Brub5Wp-.js";import"./index-B6_ETsjh.js";import"./index-DRpHiFIR.js";import"./index-j-wEJqs7.js";import"./index-yku3xlj7.js";import"./check-Bm6fIbD4.js";function le({rules:_}){const{contractorCompanyTypes:C,ueas:S}=w().props,{data:r,setData:t,post:D,processing:y,errors:i,reset:N}=E({contractor_company_type_id:"",uea_id:"",year:"",month:"",file:null}),[b,g]=T.useState(!1),A=()=>_.filter(a=>parseInt(a.year)===parseInt(r.year)).some(a=>parseInt(a.month)===parseInt(r.month)),I=s=>{if(s.preventDefault(),A()){j.error("No se puede subir un anexo para el mes seleccionado.",{duration:1e4,closeButton:!0});return}D(route("annexes.store"),{onSuccess:n=>{var v;const a=(v=n.props)==null?void 0:v.flash;a.success?(j.success(a.success,{duration:2e4,closeButton:!0}),N(),g(!1)):a.error&&j.error(a.error,{duration:2e4,closeButton:!0})},onError:n=>{g(!0),j.error("Ocurri칩 un error al subir el archivo, intente de nuevo.",{duration:2e4,closeButton:!0})}})},F=()=>r.contractor_company_type_id&&r.uea_id&&r.year&&r.month&&r.file,V=Array.from({length:10},(s,n)=>new Date().getFullYear()-n);return e.jsx("div",{children:e.jsxs(B,{open:b,onOpenChange:g,children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx(L,{asChild:!0,children:e.jsx(f,{className:"inline-block px-4 py-2",children:"Agregar Anexos"})}),e.jsxs(f,{variant:"success",className:"ml-2",onClick:()=>window.location.href="/formats/format.xlsx",children:[e.jsx(M,{className:"mr-2 h-4 w-4"}),"Formato"]})]}),e.jsxs(O,{className:"sm:max-w-[425px]",onInteractOutside:s=>s.preventDefault(),children:[e.jsxs(R,{children:[e.jsx(U,{children:"Agregar Contratista"}),e.jsx(k,{children:"Complete los campos para agregar un nuevo contratista."})]}),e.jsxs("form",{onSubmit:I,className:"space-y-3",method:"post",action:route("contractor.store"),encType:"multipart/form-data",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(l,{htmlFor:"contractor_company_type_id",children:"Tipo de Cliente"}),e.jsxs(c,{required:!0,onValueChange:s=>t("contractor_company_type_id",s),value:r.contractor_company_type_id,children:[e.jsx(d,{children:e.jsx(m,{placeholder:"Seleccione un tipo de cliente"})}),e.jsx(u,{children:e.jsxs(p,{children:[e.jsx(h,{children:"Tipos de Cliente"}),C.map(s=>e.jsx(x,{value:String(s.id),children:s.name},s.id))]})})]}),e.jsx(o,{message:i.contractor_company_type_id})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(l,{htmlFor:"uea_id",children:"UEA"}),e.jsxs(c,{onValueChange:s=>t("uea_id",s),value:r.uea_id,children:[e.jsx(d,{children:e.jsx(m,{placeholder:"Seleccione una UEA"})}),e.jsx(u,{children:e.jsxs(p,{children:[e.jsx(h,{children:"UEAs"}),S.map(s=>e.jsx(x,{value:String(s.id),children:s.name},s.id))]})})]}),e.jsx(o,{message:i.uea_id})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(l,{htmlFor:"year",children:"A침o"}),e.jsxs(c,{onValueChange:s=>t("year",s),value:r.year,children:[e.jsx(d,{children:e.jsx(m,{placeholder:"Seleccione un a침o"})}),e.jsx(u,{children:e.jsxs(p,{children:[e.jsx(h,{children:"A침os"}),V.map(s=>e.jsx(x,{value:String(s),children:s},s))]})})]}),e.jsx(o,{message:i.year})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(l,{htmlFor:"month",children:"Mes"}),e.jsxs(c,{onValueChange:s=>t("month",s),value:r.month,children:[e.jsx(d,{children:e.jsx(m,{placeholder:"Seleccione un mes"})}),e.jsx(u,{children:e.jsxs(p,{children:[e.jsx(h,{children:"Meses"}),G.map(s=>e.jsx(x,{value:s.value,children:s.label},s.value))]})})]}),e.jsx(o,{message:i.month})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(l,{htmlFor:"file",children:"Archivo"}),e.jsx(q,{type:"file",id:"file",required:!0,accept:".xlsx,.xls",onChange:s=>t("file",s.target.files?s.target.files[0]:null)}),e.jsx(o,{message:i.file})]}),e.jsxs(f,{type:"submit",className:"mt-2",disabled:!F()||y,children:[y&&e.jsx(H,{className:"h-4 w-4 animate-spin"}),"Guardar"]})]})]})]})})}export{le as default};
