import{K as F,m as _,r as v,j as e}from"./app-PNb_JBj4.js";import{u as D}from"./index-Kd-7tFCt.js";import{B as m}from"./button-HZk2Zof5.js";import{D as q,b as B,c as H,d as W,e as $}from"./dialog-D0YsQINH.js";import{t as p}from"./index-DgNyXlWA.js";import{U as x}from"./upload-DkJWI4S5.js";import{T as A}from"./trash-2-DhJ3Ity9.js";import{X as L}from"./index-DyMDJnG2.js";import{c}from"./createLucideIcon-D9N2Bwd3.js";import{L as V}from"./loader-circle-DMmFKltu.js";import{F as E}from"./file-text-Bj7ma7x8.js";import"./index-DPFIOYso.js";import"./index-Chjiymov.js";import"./utils-Co_qxGNv.js";import"./index-DONz0f-x.js";import"./index-CgoFvU8A.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],S=c("CircleAlert",R);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I=[["path",{d:"M10 12v-1",key:"v7bkov"}],["path",{d:"M10 18v-2",key:"1cjy8d"}],["path",{d:"M10 7V6",key:"dljcrl"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M15.5 22H18a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v16a2 2 0 0 0 .274 1.01",key:"gkbcor"}],["circle",{cx:"10",cy:"20",r:"2",key:"1xzdoj"}]],T=c("FileArchive",I);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]],K=c("FileSpreadsheet",U);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]],P=c("File",O);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=[["path",{d:"M3 14h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-7a9 9 0 0 1 18 0v7a2 2 0 0 1-2 2h-1a2 2 0 0 1-2-2v-3a2 2 0 0 1 2-2h3",key:"1xhozi"}]],G=c("Headphones",Z);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],J=c("Image",X);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]],Y=c("Video",Q),ee=i=>{if(i===0)return"0 Bytes";const n=1024,o=["Bytes","KB","MB","GB"],d=Math.floor(Math.log(i)/Math.log(n));return parseFloat((i/Math.pow(n,d)).toFixed(2))+" "+o[d]},se=i=>{const n=i.type,o=i.name,d={pdf:{icon:E,conditions:(s,r)=>s.includes("pdf")||r.endsWith(".pdf")||s.includes("word")||r.endsWith(".doc")||r.endsWith(".docx")},archive:{icon:T,conditions:(s,r)=>s.includes("zip")||s.includes("archive")||r.endsWith(".zip")||r.endsWith(".rar")},excel:{icon:K,conditions:(s,r)=>s.includes("excel")||r.endsWith(".xls")||r.endsWith(".xlsx")},video:{icon:Y,conditions:s=>s.includes("video/")},audio:{icon:G,conditions:s=>s.includes("audio/")},image:{icon:J,conditions:s=>s.startsWith("image/")}};for(const{icon:s,conditions:r}of Object.values(d))if(r(n,o))return e.jsx(s,{className:"size-5 opacity-60"});return e.jsx(P,{className:"size-5 opacity-60"})};function ve({report_id:i,isDialogOpen:n,setIsDialogOpen:o}){const{flash:d}=F().props,{data:s,setData:r,post:g,processing:u,reset:j}=_({descripcion:"",files:[]}),[f,h]=v.useState(null),N=v.useCallback(t=>{if(s.files.length+t.length>4){h("No puedes subir más de 4 archivos.");return}h(null),r("files",[...s.files,...t])},[s.files,r]),{getRootProps:y,getInputProps:b,isDragActive:k}=D({onDrop:N,maxFiles:4}),z=t=>{r("files",s.files.filter((a,l)=>l!==t))},M=()=>{r("files",[])},w=t=>{if(t.preventDefault(),s.files.length===0){h("Debe subir al menos un archivo para cerrar el reporte.");return}h(null),g(route("finish.store",{id:i}),{onSuccess:a=>{const l=a.props.flash;l.success&&(p.success(l.success),o(!1),j()),l.error&&p.error(l.error)},onError:a=>{o(!0),p.error("Ocurrió un error al cerrar el reporte.")}})},C=t=>t.type.startsWith("image/");return e.jsx("div",{children:e.jsx(q,{open:n,onOpenChange:o,children:e.jsxs(B,{className:"sm:max-w-[500px]",children:[e.jsxs(H,{children:[e.jsx(W,{children:"Cerrar Reporte"}),e.jsx($,{children:"¿Está seguro de que desea cerrar este reporte?"})]}),e.jsxs("form",{onSubmit:w,className:"space-y-4",method:"post",action:route("finish.store",{id:i}),children:[e.jsx("textarea",{className:"w-full rounded border p-3",placeholder:"Comentario",value:s.descripcion,onChange:t=>r("descripcion",t.target.value),rows:3}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{...y(),className:`border-input relative flex min-h-32 flex-col items-center overflow-hidden rounded-xl border border-dashed p-4 transition-colors ${k?"bg-accent/50":""} ${s.files.length>0?"":"justify-center"}`,children:[e.jsx("input",{...b(),className:"sr-only"}),s.files.length>0?e.jsxs("div",{className:"flex w-full flex-col gap-3",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsxs("h3",{className:"truncate text-sm font-medium",children:["Archivos (",s.files.length,")"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(m,{type:"button",variant:"outline",size:"sm",onClick:()=>y().onClick,children:[e.jsx(x,{className:"-ms-0.5 size-3.5 opacity-60"}),"Agregar"]}),e.jsxs(m,{type:"button",variant:"outline",size:"sm",onClick:M,children:[e.jsx(A,{className:"-ms-0.5 size-3.5 opacity-60"}),"Eliminar todos"]})]})]}),e.jsx("div",{className:"grid grid-cols-2 gap-4",children:s.files.map((t,a)=>e.jsxs("div",{className:"bg-background relative flex flex-col rounded-md border",children:[e.jsx("div",{className:"bg-accent flex aspect-square items-center justify-center overflow-hidden rounded-t-[inherit]",children:C(t)?e.jsx("img",{src:URL.createObjectURL(t),alt:`preview ${a}`,className:"size-full rounded-t-[inherit] object-cover"}):se(t)}),e.jsx(m,{type:"button",onClick:()=>z(a),size:"icon",className:"border-background focus-visible:border-background absolute -top-2 -right-2 size-6 rounded-full border-2 shadow-none",children:e.jsx(L,{className:"size-3.5"})}),e.jsxs("div",{className:"flex min-w-0 flex-col gap-0.5 border-t p-3",children:[e.jsx("p",{className:"truncate text-[13px] font-medium",children:t.name}),e.jsx("p",{className:"text-muted-foreground truncate text-xs",children:ee(t.size)})]})]},a))})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center px-4 py-3 text-center",children:[e.jsx("div",{className:"bg-background mb-2 flex size-11 shrink-0 items-center justify-center rounded-full border",children:e.jsx(x,{className:"size-4 opacity-60"})}),e.jsx("p",{className:"mb-1.5 text-sm font-medium",children:"Arrastra archivos aquí"}),e.jsx("p",{className:"text-muted-foreground text-xs",children:"Máximo 4 archivos ∙ Hasta 5MB"}),e.jsxs(m,{type:"button",variant:"outline",className:"mt-4",children:[e.jsx(x,{className:"-ms-1 opacity-60"}),"Seleccionar archivos"]})]})]}),f&&e.jsxs("div",{className:"text-destructive flex items-center gap-1 text-xs",role:"alert",children:[e.jsx(S,{className:"size-3 shrink-0"}),e.jsx("span",{children:f})]})]}),e.jsxs(m,{type:"submit",className:"mt-4 w-full",disabled:u||!s.descripcion.trim()||s.files.length===0,children:[u&&e.jsx(V,{className:"h-4 w-4 animate-spin mr-2"}),"Confirmar Cierre"]})]})]})})})}export{ve as default};
