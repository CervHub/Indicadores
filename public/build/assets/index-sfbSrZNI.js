import{j as e,r as d,K as B,L as $}from"./app-DnQCaV3x.js";import{B as V}from"./badge-BjiMpb5i.js";import{B as m}from"./button-1gPQlIc3.js";import{A as v}from"./arrow-up-down-DyTjF0Kw.js";import{c as W}from"./createLucideIcon-X9D3Eoyg.js";import{S as H}from"./square-pen-CXAltJ23.js";import{C as q}from"./circle-check-big-B4I9TJJS.js";import{T as U}from"./trash-2-BRVc221M.js";import{u as G,f as E,g as J,a as Q,b as X,c as Y}from"./index-BvM2f2oF.js";import{T as Z,a as ee,b as R,c as se,d as te,e as L}from"./table-CokZgcSx.js";import{I as ae}from"./input-BeCVyVtN.js";import{S as I,a as k,b as P,c as D,f as p}from"./select-JT3rkkUD.js";import{A as le}from"./app-layout-DnG05_VT.js";import oe from"./activate-bUMJSWS_.js";import ie from"./create-CwUPqIpC.js";import re from"./delete-D0qtMCNq.js";import ne from"./edit-CAFpm0ib.js";import de from"./reset-D9G0715L.js";import ce from"./update-BAafhcaf.js";import"./utils-CISCwvQU.js";import"./index-BNrexipy.js";import"./index-CIpeiAt6.js";import"./index-CDlSO2Eu.js";import"./index-BSPhMZ0d.js";import"./index-CDPHTwVI.js";import"./index-B_l549e7.js";import"./check-SRjlNw1X.js";import"./index-BV-Mithc.js";import"./tooltip-CM16hWBs.js";import"./chevrons-up-down-DRSBfXHm.js";import"./truck-BnJavCtS.js";import"./chevron-right-DMMNsvPr.js";import"./dialog-jCcLGnov.js";import"./loader-circle-CUz5UHxA.js";import"./input-error-N3vl0cxn.js";import"./label-x-o6BylK.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const me=[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]],ge=W("Key",me),xe=(g,r)=>[{accessorKey:"id",header:({column:s})=>e.jsxs(m,{variant:"ghost",onClick:()=>s.toggleSorting(s.getIsSorted()==="asc"),children:["ID",e.jsx(v,{className:"ml-2 h-4 w-4"})]}),cell:({row:s})=>s.original.id},{id:"nombre_completo",header:({column:s})=>e.jsxs(m,{variant:"ghost",onClick:()=>s.toggleSorting(s.getIsSorted()==="asc"),children:["Nombre Completo",e.jsx(v,{className:"ml-2 h-4 w-4"})]}),cell:({row:s})=>`${s.original.nombres} ${s.original.apellidos}`,sortingFn:(s,l)=>{const i=`${s.original.nombres} ${s.original.apellidos}`,n=`${l.original.nombres} ${l.original.apellidos}`;return i.localeCompare(n)}},{accessorKey:"email",header:"Email"},{accessorKey:"role_id",header:({column:s})=>e.jsxs(m,{variant:"ghost",onClick:()=>s.toggleSorting(s.getIsSorted()==="asc"),children:["Rol",e.jsx(v,{className:"ml-2 h-4 w-4"})]}),cell:({row:s})=>{const l=s.original.role_id,i=r.find(n=>n.id===l);return(i==null?void 0:i.nombre)||"Sin rol"},sortingFn:(s,l)=>{const i=r.find(h=>h.id===s.original.role_id),n=r.find(h=>h.id===l.original.role_id),j=(i==null?void 0:i.nombre)||"Sin rol",x=(n==null?void 0:n.nombre)||"Sin rol";return j.localeCompare(x)}},{accessorKey:"doi",header:({column:s})=>e.jsxs(m,{variant:"ghost",onClick:()=>s.toggleSorting(s.getIsSorted()==="asc"),children:["DNI",e.jsx(v,{className:"ml-2 h-4 w-4"})]})},{accessorKey:"updated_at",header:({column:s})=>e.jsxs(m,{variant:"ghost",onClick:()=>s.toggleSorting(s.getIsSorted()==="asc"),children:["Fecha Modificación",e.jsx(v,{className:"ml-2 h-4 w-4"})]}),cell:({row:s})=>new Date(s.original.updated_at).toLocaleString("es-ES")},{accessorKey:"estado",header:"Estado",cell:({row:s})=>{const l=s.original.estado;return e.jsx(V,{variant:l==="1"?"default":"destructive",children:l==="1"?"Activo":"No Activo"})}},{id:"acciones",header:"Acciones",cell:({row:s})=>{const l=s.original.id,i=s.original.estado;return e.jsxs("div",{className:"flex flex-wrap space-x-2",children:[e.jsxs(m,{"aria-label":"Restablecer Contraseña",className:"h-7 bg-blue-700 p-2 text-xs text-white hover:bg-blue-900 dark:bg-blue-600 dark:hover:bg-blue-800",onClick:()=>g("reset",l),children:[e.jsx(ge,{className:"h-3 w-3"})," "]}),e.jsx(m,{"aria-label":"Editar",className:"h-7 bg-yellow-700 p-2 text-xs text-white hover:bg-yellow-900 dark:bg-yellow-600 dark:hover:bg-yellow-800",onClick:()=>g("editar",l),children:e.jsx(H,{className:"h-3 w-3"})}),i!=="1"&&e.jsx(m,{"aria-label":"Activar",className:"h-7 bg-green-700 p-2 text-xs text-white hover:bg-green-900 dark:bg-green-600 dark:hover:bg-green-800",onClick:()=>g("activar",l),children:e.jsx(q,{className:"h-3 w-3"})}),i==="1"&&e.jsx(m,{"aria-label":"Eliminar",className:"h-7 bg-red-700 p-2 text-xs text-white hover:bg-red-900 dark:bg-red-600 dark:hover:bg-red-800",onClick:()=>g("eliminar",l),children:e.jsx(U,{className:"h-3 w-3"})})]})}}];function pe({columns:g,data:r,roles:s}){var T;const[l,i]=d.useState([]),[n,j]=d.useState(""),[x,h]=d.useState("__all__"),[u,w]=d.useState("__all__"),[b,S]=d.useState({pageIndex:0,pageSize:10}),f=d.useMemo(()=>{const t=new Set;return r.forEach(a=>{a.role_id&&t.add(a.role_id)}),s.filter(a=>t.has(a.id))},[r,s]),_=d.useMemo(()=>{const t=new Set;return r.forEach(a=>{a.estado&&t.add(a.estado)}),Array.from(t)},[r]),C=d.useMemo(()=>{let t=r;if(n){const a=n.toLowerCase();t=t.filter(o=>{const N=s.find(z=>z.id===o.role_id);return o.nombres&&o.nombres.toLowerCase().includes(a)||o.apellidos&&o.apellidos.toLowerCase().includes(a)||o.email&&o.email.toLowerCase().includes(a)||o.telefono&&o.telefono.toLowerCase().includes(a)||o.cargo&&o.cargo.toLowerCase().includes(a)||(N==null?void 0:N.nombre)&&N.nombre.toLowerCase().includes(a)||o.doi&&o.doi.toLowerCase().includes(a)})}if(x!=="__all__"){const a=s.find(o=>o.nombre===x);a&&(t=t.filter(o=>o.role_id===a.id))}return u!=="__all__"&&(t=t.filter(a=>a.estado===u)),t},[r,n,x,u,s]),c=G({data:C,columns:g,getCoreRowModel:Y(),getPaginationRowModel:X(),onSortingChange:i,getSortedRowModel:Q(),getFilteredRowModel:J(),state:{sorting:l,pagination:b},onPaginationChange:S,manualPagination:!1,pageCount:void 0}),A=t=>{S(a=>({...a,pageSize:Number(t),pageIndex:0}))},y=C.length,O=c.getState().pagination.pageIndex,M=c.getState().pagination.pageSize,F=y===0?0:O*M+1,K=Math.min((O+1)*M,y);return e.jsxs("div",{children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4 py-4 w-full",children:[e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("label",{className:"text-sm mb-1",children:"Mostrar"}),e.jsxs(I,{value:b.pageSize.toString(),onValueChange:A,children:[e.jsx(k,{className:"w-full",children:e.jsx(P,{})}),e.jsxs(D,{children:[e.jsx(p,{value:"10",children:"10"}),e.jsx(p,{value:"25",children:"25"}),e.jsx(p,{value:"50",children:"50"}),e.jsx(p,{value:"100",children:"100"})]})]}),e.jsx("span",{className:"text-xs text-muted-foreground mt-1",children:"registros"})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("label",{className:"text-sm mb-1",children:"Buscar"}),e.jsx(ae,{placeholder:"Buscar en todos los campos...",value:n,onChange:t=>j(t.target.value),className:"w-full"})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("label",{className:"text-sm mb-1",children:"Rol"}),e.jsxs(I,{value:x,onValueChange:h,children:[e.jsx(k,{children:e.jsx(P,{placeholder:"Todos"})}),e.jsxs(D,{children:[e.jsx(p,{value:"__all__",children:"Todos"}),f.map(t=>e.jsx(p,{value:t.nombre,children:t.nombre},t.id))]})]})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("label",{className:"text-sm mb-1",children:"Estado"}),e.jsxs(I,{value:u,onValueChange:w,children:[e.jsx(k,{children:e.jsx(P,{placeholder:"Todos"})}),e.jsxs(D,{children:[e.jsx(p,{value:"__all__",children:"Todos"}),_.map(t=>e.jsx(p,{value:t,children:t==="1"?"Activo":"No Activo"},t))]})]})]})]}),e.jsx("div",{className:"grid grid-cols-1 rounded-md border",children:e.jsxs(Z,{className:"text-xs",children:[e.jsx(ee,{children:c.getHeaderGroups().map(t=>e.jsx(R,{children:t.headers.map(a=>e.jsx(se,{style:{minWidth:"10px",maxWidth:"200px"},children:a.isPlaceholder?null:E(a.column.columnDef.header,a.getContext())},a.id))},t.id))}),e.jsx(te,{children:(T=c.getRowModel().rows)!=null&&T.length?c.getRowModel().rows.map(t=>e.jsx(R,{"data-state":t.getIsSelected()&&"selected",children:t.getVisibleCells().map(a=>e.jsx(L,{style:{minWidth:"10px",maxWidth:"200px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:E(a.column.columnDef.cell,a.getContext())},a.id))},t.id)):e.jsx(R,{children:e.jsx(L,{colSpan:g.length,className:"h-24 text-center",children:"No hay resultados."})})})]})}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between py-4 gap-2",children:[e.jsxs("span",{className:"text-xs text-muted-foreground",children:["Mostrando ",F," a ",K," de ",y," registros"]}),e.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[e.jsx(m,{variant:"outline",size:"sm",onClick:()=>c.previousPage(),disabled:!c.getCanPreviousPage(),children:"Anterior"}),e.jsx(m,{variant:"outline",size:"sm",onClick:()=>c.nextPage(),disabled:!c.getCanNextPage(),children:"Siguiente"})]})]})]})}const he=[{title:"Personal",href:"/contrata/personal"}];function Ye(){const{people:g,roles:r}=B().props,[s,l]=d.useState(null),[i,n]=d.useState(!1),[j,x]=d.useState(!1),[h,u]=d.useState(!1),[w,b]=d.useState(!1),S=(f,_)=>{const C=g.find(c=>c.id===_);l(C||null),f==="editar"?n(!0):f==="eliminar"?x(!0):f==="activar"?u(!0):f==="reset"&&b(!0)};return e.jsxs(le,{breadcrumbs:he,children:[e.jsx($,{title:"Personal"}),e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(ie,{roles:r}),e.jsx(ce,{})]}),e.jsx("div",{className:"w-full max-w-full overflow-x-auto",children:e.jsx(pe,{columns:xe(S,r),data:g,roles:r})})]}),s&&e.jsxs(e.Fragment,{children:[e.jsx(ne,{isOpen:i,onOpenChange:n,person:s,roles:r}),e.jsx(re,{isOpen:j,onOpenChange:x,selectedItem:s}),e.jsx(oe,{isOpen:h,onOpenChange:u,selectedItem:s}),e.jsx(de,{isOpen:w,onOpenChange:b,selectedItem:s})]})]})}export{Ye as default};
