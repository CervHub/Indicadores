import{m as T,r as x,j as e}from"./app-GVpGJeU7.js";import{I as V}from"./input-error-BllA-Ekc.js";import{B as S}from"./button-BHPTtTdP.js";import{D as C,b as E,c as w,d as q,e as I,f as L}from"./dialog-Bdq0f4Ih.js";import{I as h}from"./input-DW4r52MY.js";import{L as M}from"./label-CA0O3Swu.js";import{C as k}from"./combobox-D7ra38Pi.js";import{S as P,a as R,b as z,c as A,d as G,e as H,f as $}from"./select-ByVw2mV_.js";import{t as O}from"./index-DQ13vxLF.js";import{V as B}from"./utils-qLzneZb4.js";import{L as K}from"./loader-circle-7TSR6vT2.js";import"./index-n7sBKrK3.js";import"./createLucideIcon-CFMFBQne.js";import"./index-CwCzXZA7.js";import"./index-CZ6M3Ocn.js";import"./search-BeNvrx9v.js";import"./popover-B8c_4LF8.js";import"./index-Ro_MRc18.js";import"./chevrons-up-down-R3NTjYK1.js";import"./trash-2-BSD5rd9o.js";import"./check-ohEls-Zn.js";import"./index-Bj6WAKAy.js";import"./index-CU00uo7P.js";const D=[{value:"4",label:"4",img:"/images/neumaticos/01.png"},{value:"6",label:"6",img:"/images/neumaticos/02.png"},{value:"10",label:"10",img:"/images/neumaticos/03.png"}],F=({id:n,label:l,type:r="text",value:a,onChange:s,error:c,placeholder:m,disabled:o,required:u=!1,options:p,companyCode:g,custom:b,onCustomClick:f,rightElement:N,rightLoading:_=!1})=>e.jsxs("div",{className:"grid gap-2",children:[e.jsxs(M,{htmlFor:n,children:[l," ",u&&e.jsx("span",{className:"text-red-500",children:"*"})]}),n==="code"?e.jsxs("div",{className:"relative flex items-center",children:[e.jsx(h,{id:n,type:"number",value:a,onChange:i=>{const t=i.target.value.replace(/\D/g,"");s(t)},disabled:o,placeholder:m||"Ingrese número",required:u,min:1,className:"pr-20"}),e.jsx("span",{className:"absolute right-3 top-1/2 -translate-y-1/2 bg-background px-2 py-0.5 rounded text-muted-foreground text-xs sm:text-sm font-mono border border-input",children:g?`${g}${a?a.toString().padStart(3,"0"):"___"}`:a?`COD${a.toString().padStart(3,"0")}`:"COD___"})]}):p?n==="type"?e.jsx(k,{data:p,value:a,onChange:s,placeholder:m||"Seleccione tipo...",className:"w-full",disabled:o}):e.jsxs(P,{onValueChange:s,value:a,disabled:o,children:[e.jsx(R,{className:"w-full",children:e.jsx(z,{placeholder:m})}),e.jsx(A,{children:e.jsxs(G,{children:[e.jsx(H,{children:l}),p.map(i=>e.jsx($,{value:i.value,children:i.label},i.value))]})})]}):b&&n==="tire_count"?e.jsx(h,{id:"tire_count",value:a,placeholder:"Seleccione...",readOnly:!0,onClick:f,className:"cursor-pointer bg-white",tabIndex:0,required:u,disabled:o}):e.jsx(h,{id:n,type:r,value:a,onChange:i=>s(i.target.value),disabled:o,placeholder:m,required:u}),e.jsx(V,{message:c})]});function ge({isDialogOpen:n,setIsDialogOpen:l,vehicle:r,companyCode:a}){console.log("EditVehicle",r);const{data:s,setData:c,put:m,processing:o,errors:u,reset:p}=T({code:r.code??"",license_plate:r.license_plate??"",brand:r.brand??"",model:r.model??"",color:r.color??"",year:r.year??"",engine_number:r.engine_number??"",chassis_number:r.chassis_number??"",type:r.type??"",fuel_type:r.fuel_type??"",seating_capacity:r.seating_capacity??"",mileage:r.mileage??"",is_active:r.is_active??!1,insurance_expiry_date:r.insurance_expiry_date??"",tire_count:r.tire_count??"",spare_tire_count:r.spare_tire_count??""}),[g,b]=x.useState(!1);x.useEffect(()=>{c({code:r.code??"",license_plate:r.license_plate??"",brand:r.brand??"",model:r.model??"",color:r.color??"",year:r.year??"",engine_number:r.engine_number??"",chassis_number:r.chassis_number??"",type:r.type??"",fuel_type:r.fuel_type??"",seating_capacity:r.seating_capacity??"",mileage:r.mileage??"",is_active:r.is_active??!1,insurance_expiry_date:r.insurance_expiry_date??"",tire_count:r.tire_count??"",spare_tire_count:r.spare_tire_count??""})},[r,c]);const f=x.useMemo(()=>["type","code","brand","model","year","tire_count","spare_tire_count"].every(j=>{var d;return(d=s[j])==null?void 0:d.toString().trim()}),[s]),N=x.useCallback(t=>{t.preventDefault(),m(route("vehicle.update",{vehicle:r.id}),{onSuccess:()=>{l(!1),O.success("Vehículo actualizado exitosamente.")},onError:()=>{O.error("Ocurrió un error al intentar actualizar el vehículo.")}})},[m,l,r.id,s]),_=D.find(t=>t.label===s.tire_count),i=[{id:"license_plate",label:"Placa",required:!0,disabled:!0},{id:"type",label:"Tipo",required:!0,options:B},{id:"code",label:"Código",required:!0,companyCode:a},{id:"brand",label:"Marca",required:!0},{id:"model",label:"Modelo",required:!0},{id:"color",label:"Color",required:!0},{id:"year",label:"Año",required:!0,type:"number"},{id:"engine_number",label:"N° Motor"},{id:"chassis_number",label:"N° Chasis"},{id:"seating_capacity",label:"N° Asientos s/Cond.",required:!0,type:"number"},{id:"mileage",label:"Kilometraje",required:!0,type:"number"},{id:"tire_count",label:"N° Neumáticos",custom:!0,required:!0,companyCode:a},{id:"spare_tire_count",label:"N° Repuesto",required:!0,type:"number"}];return e.jsxs("div",{children:[e.jsx(C,{open:n,onOpenChange:l,children:e.jsxs(E,{className:"pb-3 sm:max-w-[800px]",children:[e.jsxs(w,{children:[e.jsx(q,{children:"Actualizar Vehículo"}),e.jsx(I,{children:"Modifique los campos permitidos y guarde los cambios."})]}),e.jsxs("div",{className:"max-h-[60vh] overflow-y-auto",children:[e.jsx("form",{id:"vehicleEditForm",onSubmit:N,className:"grid gap-4 sm:grid-cols-2",children:i.map(({id:t,custom:j,...d})=>j&&t==="tire_count"?e.jsx(F,{id:t,value:s[t],onChange:y=>c(t,y),error:u[t],disabled:o,required:!0,companyCode:a,custom:!0,onCustomClick:()=>b(!0),...d},t):e.jsx(F,{id:t,value:s[t],onChange:y=>c(t,y),error:u[t],disabled:o||d.disabled,companyCode:a,...d},t))}),_&&e.jsx("div",{className:"flex justify-center mt-6",children:e.jsx("img",{src:_.img,alt:_.label,className:"w-32 h-32 object-contain bg-white"})})]}),e.jsxs(L,{children:[e.jsxs(S,{type:"submit",form:"vehicleEditForm",disabled:o||!f,children:[o&&e.jsx(K,{className:"h-4 w-4 animate-spin"}),"Guardar"]}),e.jsx(S,{type:"button",variant:"secondary",onClick:()=>{p(),l(!1)},disabled:o,children:"Cancelar"})]})]})}),e.jsx(C,{open:g,onOpenChange:b,children:e.jsxs(E,{className:"max-w-md",children:[e.jsx(w,{children:e.jsx(q,{children:"Seleccione el número de neumáticos"})}),e.jsx("div",{className:"grid grid-cols-2 gap-4 py-2 max-h-80 overflow-y-auto",style:{scrollbarGutter:"stable"},children:D.map(t=>e.jsx("button",{type:"button",className:"flex flex-col items-center rounded p-2 bg-white hover:bg-accent focus:bg-accent focus:outline-none w-full",onClick:()=>{c("tire_count",t.label),b(!1)},children:e.jsx("img",{src:t.img,alt:t.label,className:"w-full h-auto object-contain",style:{aspectRatio:"3/5",maxHeight:220}})},t.value))})]})})]})}export{ge as default};
