import{K as w,m as A,r as t,j as e}from"./app-dQT239ps.js";import{I as u}from"./input-error-aKcg5enS.js";import{B as x}from"./button-qorxA9Ni.js";import{D as T,a as B,b as G,c as k,d as H,e as K}from"./dialog-xMYU53XA.js";import{L as p}from"./label-Gfj_itVC.js";import{S as j,a as f,b as g,c as S,d as D,e as b,f as v}from"./select-DPi8YqF4.js";import{m as R}from"./utils-BXZQgxmQ.js";import{L as _}from"./loader-circle-DKe-dgFq.js";import"./index-9yUWTkrX.js";import"./index-BVtL2QXf.js";import"./index-CnUcILfV.js";import"./index-BaKwaQDo.js";import"./index-YkSNm9Kd.js";import"./index-oRwhoj9u.js";function re({initialYear:n=0,initialMonth:m=0,isOpen:a=!1,onOpenChange:c}){const{flash:q}=w().props,{data:r,setData:o,post:y,processing:d,errors:h,reset:C}=A({year:n,month:m}),[N,i]=t.useState(a),[E,F]=t.useState(!1);t.useEffect(()=>{F(r.year!==0&&r.month!==0)},[r]),t.useEffect(()=>{i(a)},[a]),t.useEffect(()=>{a&&(o("year",n),o("month",m))},[n,m,a,o]);const I=s=>{s.preventDefault(),y(route("consolidated.store"),{onSuccess:l=>{C(),i(!1),c&&c(!1),console.log("Solicitud de creación exitosa:",l)},onError:l=>{i(!0),console.log("Errores en la solicitud de creación:",l)}})},L=new Date().getFullYear(),V=Array.from({length:L-2023+1},(s,l)=>2023+l);return e.jsx("div",{children:e.jsxs(T,{open:N,onOpenChange:s=>{i(s),c&&c(s)},children:[e.jsx("div",{className:"flex justify-start",children:e.jsx(B,{asChild:!0,children:e.jsx(x,{className:"inline-block px-4 py-2",children:"Crear Consolidado"})})}),e.jsxs(G,{className:"sm:max-w-[425px]",children:[e.jsxs(k,{children:[e.jsx(H,{children:"Crear Consolidado"}),e.jsx(K,{children:"Complete los campos para crear un nuevo consolidado."})]}),e.jsxs("form",{onSubmit:I,className:"space-y-3",method:"post",action:route("consolidated.store"),children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(p,{htmlFor:"year",children:"Año"}),e.jsxs(j,{onValueChange:s=>o("year",Number(s)),value:r.year?String(r.year):"",children:[e.jsx(f,{children:e.jsx(g,{placeholder:"Seleccione un año"})}),e.jsx(S,{children:e.jsxs(D,{children:[e.jsx(b,{children:"Años"}),V.map(s=>e.jsx(v,{value:String(s),children:s},s))]})})]}),e.jsx(u,{message:h.year})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(p,{htmlFor:"month",children:"Mes"}),e.jsxs(j,{onValueChange:s=>o("month",Number(s)),value:r.month?String(r.month):"",children:[e.jsx(f,{children:e.jsx(g,{placeholder:"Seleccione un mes"})}),e.jsx(S,{children:e.jsxs(D,{children:[e.jsx(b,{children:"Meses"}),R.map(s=>e.jsx(v,{value:s.value,children:s.label},s.value))]})})]}),e.jsx(u,{message:h.month})]}),e.jsxs(x,{type:"submit",className:"mt-2",disabled:d||!E,children:[d&&e.jsx(_,{className:"h-4 w-4 animate-spin"}),"Generar"]})]})]})]})})}export{re as default};
