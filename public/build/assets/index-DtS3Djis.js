import{j as e,$ as w,r as x,K as _,L as T}from"./app-CkX-sCCf.js";import{B as g}from"./badge-BoWuBp5k.js";import{B as m}from"./button-Bw2Xdp6E.js";import{T as h,a as u,b as j,c as f}from"./tooltip-CeYhT-Ve.js";import{m as S,f as A}from"./utils-Co_qxGNv.js";import{A as b}from"./arrow-up-down-DZ9e_FeN.js";import{c as M}from"./createLucideIcon-Cux2gun-.js";import{F as R}from"./file-text-BQQHQTRf.js";import{D}from"./download-C6I_mApG.js";import{u as k,f as v,g as F,a as P,b as I,c as K}from"./index-CRVVggkg.js";import{T as U,a as z,b as p,c as B,d as $,e as y}from"./table-DskUy7h3.js";import{I as L}from"./input-MjwaqtbJ.js";import{A as E}from"./app-layout-NwK8qtki.js";import H from"./create-BVO6Eoer.js";import V from"./reload-1vbXsL7L.js";import"./index-BbjDzo9d.js";import"./index-ItJPPwpU.js";import"./index-RgIy1NKL.js";import"./index-DiuJ2rgF.js";import"./index-uPTyyJTB.js";import"./index-C0Urlq2e.js";import"./index-BeeyGmDn.js";import"./check-DYdSJAZQ.js";import"./chevrons-up-down-BuW2oQV_.js";import"./truck-CJs_TKyA.js";import"./chevron-right-D5H3JAm1.js";import"./dialog-CQ0eMQJ3.js";import"./label-B68sH3c7.js";import"./select-DPNjP_Lz.js";import"./download-CLfTM_mm.js";import"./chevron-left-mr3G86Ux.js";import"./loader-circle-B0rPJdrL.js";import"./input-error-VWZhSynO.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]],O=M("ArrowUp",G),C=o=>o===0?"destructive":o===100?"default":"secondary",q=(o,c,d)=>[{accessorKey:"contractor_company_type_id",header:"T. Cliente",cell:({row:t})=>{const n=o.find(r=>r.id===Number(t.original.contractor_company_type_id));return n?n.name:"Unknown"}},{accessorKey:"uea_id",header:"UEA",cell:({row:t})=>{const n=c.find(r=>r.id===Number(t.original.uea_id));return n?n.name:"Unknown"}},{accessorKey:"month",header:({column:t})=>e.jsxs(m,{variant:"ghost",onClick:()=>t.toggleSorting(t.getIsSorted()==="asc"),children:["Mes",e.jsx(b,{className:"ml-2 h-4 w-4"})]}),cell:({row:t})=>{const n=S.find(r=>Number(r.value)===Number(t.original.month));return n?n.label:"Unknown"}},{accessorKey:"year",header:({column:t})=>e.jsxs(m,{variant:"ghost",onClick:()=>t.toggleSorting(t.getIsSorted()==="asc"),children:["Year",e.jsx(b,{className:"ml-2 h-4 w-4"})]})},{accessorKey:"annexes",header:"Anexos",cell:({row:t})=>{const n=[t.original.annex24,t.original.annex25,t.original.annex26,t.original.annex27,t.original.annex28],a=(n.filter(s=>s==="true"||s==="1").length/n.length*100).toFixed(0),l=C(Number(a));return e.jsx(h,{children:e.jsxs(u,{children:[e.jsx(j,{children:e.jsx(g,{variant:l,children:`${a}%`})}),e.jsxs(f,{children:[e.jsxs("p",{children:["Anexo 24: ",t.original.annex24]}),e.jsxs("p",{children:["Anexo 25: ",t.original.annex25]}),e.jsxs("p",{children:["Anexo 26: ",t.original.annex26]}),e.jsxs("p",{children:["Anexo 27: ",t.original.annex27]}),e.jsxs("p",{children:["Anexo 28: ",t.original.annex28]}),e.jsxs("p",{children:["Anexo 30: ",t.original.annex30]})]})]})})}},{accessorKey:"minem_templates",header:"Minems",cell:({row:t})=>{const n=[t.original.minem_template_1,t.original.minem_template_2],a=(n.filter(s=>s==="true"||s==="1").length/n.length*100).toFixed(0),l=C(Number(a));return e.jsx(h,{children:e.jsxs(u,{children:[e.jsx(j,{children:e.jsx(g,{variant:l,children:`${a}%`})}),e.jsxs(f,{children:[e.jsxs("p",{children:["Plantilla Minem 1: ",t.original.minem_template_1]}),e.jsxs("p",{children:["Plantilla Minem 2: ",t.original.minem_template_2]})]})]})})}},{accessorKey:"F. Creación",header:"F. Creación",cell:({row:t})=>{const n=new Date(t.original.created_at);return A(n)}},{id:"actions",header:"Acciones",cell:({row:t})=>{const n=t.original,r=l=>{},a=`${window.location.origin}/${n.file}`;return e.jsxs("div",{className:"flex flex-row gap-2 space-y-2",children:[e.jsxs(m,{variant:"secondary",size:"sm",onClick:()=>d(n),children:[e.jsx(O,{className:"h-4 w-4"})," ","Actualizar"]}),e.jsx(w,{href:route("annexes.show",{annex:n.id}),children:e.jsxs(m,{variant:"default",size:"sm",children:[e.jsx(R,{className:"h-4 w-4"}),"Detalle"]})}),e.jsx("a",{href:a,download:!0,onClick:()=>r(n.file),children:e.jsxs(m,{variant:"destructive",size:"sm",children:[e.jsx(D,{className:"h-4 w-4"}),"Descargar"]})})]})}}];function Y({columns:o,data:c}){var l;const[d,t]=x.useState([]),[n,r]=x.useState(""),a=k({data:c,columns:o,getCoreRowModel:K(),getPaginationRowModel:I(),onSortingChange:t,getSortedRowModel:P(),onGlobalFilterChange:r,getFilteredRowModel:F(),state:{sorting:d,globalFilter:n}});return e.jsxs("div",{children:[e.jsx("div",{className:"flex items-center py-4",children:e.jsx(L,{placeholder:"Filter by any column...",value:n,onChange:s=>r(s.target.value),className:"max-w-sm"})}),e.jsx("div",{className:"grid grid-cols-1 rounded-md border",children:e.jsxs(U,{className:"text-xs",children:[e.jsx(z,{children:a.getHeaderGroups().map(s=>e.jsx(p,{children:s.headers.map(i=>e.jsx(B,{children:i.isPlaceholder?null:v(i.column.columnDef.header,i.getContext())},i.id))},s.id))}),e.jsx($,{children:(l=a.getRowModel().rows)!=null&&l.length?a.getRowModel().rows.map(s=>e.jsx(p,{"data-state":s.getIsSelected()&&"selected",children:s.getVisibleCells().map(i=>e.jsx(y,{children:v(i.column.columnDef.cell,i.getContext())},i.id))},s.id)):e.jsx(p,{children:e.jsx(y,{colSpan:o.length,className:"h-24 text-center",children:"No results."})})})]})}),e.jsxs("div",{className:"flex items-center justify-end space-x-2 py-4",children:[e.jsx(m,{variant:"outline",size:"sm",onClick:()=>a.previousPage(),disabled:!a.getCanPreviousPage(),children:"Previous"}),e.jsx(m,{variant:"outline",size:"sm",onClick:()=>a.nextPage(),disabled:!a.getCanNextPage(),children:"Next"})]})]})}const J=[{title:"Indicadores",href:"/annexe"}];function Me(){const{fileStatuses:o,contractorCompanyTypes:c,ueas:d,rules:t,company:n}=_().props,[r,a]=x.useState(null),[l,s]=x.useState(!1),i=N=>{a(N),s(!0)};return e.jsxs(E,{breadcrumbs:J,children:[e.jsx(T,{title:"Contratistas"}),e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4",children:[c.length>0&&d.length>0&&e.jsx(H,{contractorCompanyTypes:c,ueas:d,company:n}),e.jsx("div",{className:"w-full max-w-full overflow-x-auto",children:e.jsx(Y,{columns:q(c,d,i),data:o})})]}),r&&e.jsx(V,{rules:t,selectedItem:r,isDialogOpen:l,setIsDialogOpen:s})]})}export{Me as default};
