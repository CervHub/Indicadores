import{m as j,r as o,j as s}from"./app-DL-haAjQ.js";import{B as g}from"./button-slxFOLX6.js";import{D as b,b as E,c as R,d as y,e as v}from"./dialog-D5lu6PBX.js";import{m as B}from"./utils-BXZQgxmQ.js";import{L as N}from"./loader-circle-C6ZCBZuL.js";import"./index-DanSS8Bx.js";import"./index-4hjVkEVw.js";import"./index-DwZDYCBG.js";function q({initialYear:r,initialMonth:i,isOpen:l=!1,onOpenChange:t}){var p;const{data:m,setData:c,post:x,processing:u,reset:D}=j({year:r,month:i,reconsolidated:!0}),[n,a]=o.useState(l),h=o.useRef(null);o.useEffect(()=>{a(l)},[l]),o.useEffect(()=>{c("year",r),c("month",i)},[r,i,c]),o.useEffect(()=>{if(n){const e=setTimeout(()=>{f()},100);return()=>clearTimeout(e)}},[n]);const f=e=>{e&&e.preventDefault(),x(route("consolidated.store"),{onSuccess:d=>{D(),a(!1),t&&t(!1),console.log("Solicitud de reconsolidación exitosa:",d)},onError:d=>{a(!0),console.log("Errores en la solicitud de reconsolidación:",d)}})};return s.jsx("div",{children:s.jsx(b,{open:n,onOpenChange:e=>{a(e),t&&t(e)},modal:!0,children:s.jsxs(E,{className:"sm:max-w-[425px]",onInteractOutside:e=>e.preventDefault(),showCloseButton:!1,children:[s.jsxs(R,{children:[s.jsx(y,{children:"Reconsolidando"}),s.jsxs(v,{children:["Reconsolidando para el mes de ",(p=B.find(e=>e.value===m.month))==null?void 0:p.label," para el año de ",m.year,"."]})]}),s.jsx("form",{onSubmit:f,className:"space-y-3",method:"post",action:route("consolidated.store"),children:s.jsxs(g,{ref:h,type:"submit",className:"mt-2",disabled:u,children:[u&&s.jsx(N,{className:"h-4 w-4 animate-spin"}),"Reconsolidar"]})})]})})})}export{q as default};
