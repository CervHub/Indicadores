import{K as V,r as v,m as k,j as e}from"./app-beG36Ulv.js";import{I as i}from"./input-error-DkaH4THT.js";import{B as y}from"./button-CnRUrm01.js";import{D as L,a as B,b as q,c as R,d as U,e as Y}from"./dialog-CIUUHK6F.js";import{I as G}from"./input-BGdVG3tJ.js";import{L as o}from"./label-CkjEo2c0.js";import{S as d,a as m,b as u,c as p,d as h,e as x,f as j}from"./select-B9vjMoZv.js";import{m as H}from"./utils-Dxu7ruf7.js";import{t as _}from"./index-CTb4ZA7y.js";import P from"./download-CF03Di0J.js";import{c as z}from"./index-B3wP7YY5.js";import{L as K}from"./loader-circle-C2-quKIs.js";import"./index-Cebps9qQ.js";import"./index-VU0evN-M.js";import"./index-C8eRNzLg.js";import"./index-pkxM7JkR.js";import"./check-BC0-vTSY.js";import"./chevron-left-mlrml8zF.js";import"./chevron-right-5G0yh_Q-.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=[["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M16 22h2a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v3.5",key:"13ddob"}],["path",{d:"M4.017 11.512a6 6 0 1 0 8.466 8.475",key:"s6vs5t"}],["path",{d:"M9 16a1 1 0 0 1-1-1v-4c0-.552.45-1.008.995-.917a6 6 0 0 1 4.922 4.922c.091.544-.365.995-.917.995z",key:"1dl6s6"}]],Q=z("FileChartPie",J);function je({rules:W}){const{contractorCompanyTypes:C,ueas:b}=V().props,N=new Date().getFullYear(),I=String(new Date().getMonth()+1).padStart(2,"0"),[F,S]=v.useState(!1),{data:s,setData:a,post:w,processing:g,errors:t,reset:A}=k({contractor_company_type_id:"",uea_id:"",year:String(N),month:String(Number(I)),file:null}),[O,f]=v.useState(!1),n=v.useRef(null),M=r=>{r.preventDefault(),w(route("annexes.store"),{onSuccess:l=>{var D;const c=(D=l.props)==null?void 0:D.flash;c.success?(_.success(c.success,{duration:2e4,closeButton:!0}),A(),f(!1)):c.error&&(a("file",null),n.current&&(n.current.value=""),_.error(c.error,{duration:2e4,closeButton:!0}))},onError:l=>{f(!0),_.error("Ocurri칩 un error al subir el archivo, intente de nuevo.",{duration:2e4,closeButton:!0}),a("file",null),n.current&&(n.current.value="")}})},E=()=>s.contractor_company_type_id&&s.uea_id&&s.year&&s.month&&s.file,T=Array.from({length:10},(r,l)=>new Date().getFullYear()-l);return e.jsxs("div",{children:[e.jsxs(L,{open:O,onOpenChange:f,children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx(B,{asChild:!0,children:e.jsx(y,{className:"inline-block px-4 py-2",children:"Agregar Indicador"})}),e.jsxs(y,{className:"ml-2",variant:"warning",onClick:()=>S(!0),disabled:g,children:[e.jsx(Q,{className:"mr-2 h-4 w-4"}),"Formato"]})]}),e.jsxs(q,{className:"sm:max-w-[425px]",onInteractOutside:r=>r.preventDefault(),children:[e.jsxs(R,{children:[e.jsx(U,{children:"Agregar Indicador"}),e.jsx(Y,{children:"Complete los campos para agregar un nuevo indicador."})]}),e.jsxs("form",{onSubmit:M,className:"space-y-3",method:"post",action:route("contractor.store"),encType:"multipart/form-data",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(o,{htmlFor:"contractor_company_type_id",children:"Tipo de Cliente"}),e.jsxs(d,{required:!0,onValueChange:r=>a("contractor_company_type_id",r),value:s.contractor_company_type_id,children:[e.jsx(m,{children:e.jsx(u,{placeholder:"Seleccione un tipo de cliente"})}),e.jsx(p,{children:e.jsxs(h,{children:[e.jsx(x,{children:"Tipos de Cliente"}),C.map(r=>e.jsx(j,{value:String(r.id),children:r.name},r.id))]})})]}),e.jsx(i,{message:t.contractor_company_type_id})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(o,{htmlFor:"uea_id",children:"UEA"}),e.jsxs(d,{onValueChange:r=>a("uea_id",r),value:s.uea_id,children:[e.jsx(m,{children:e.jsx(u,{placeholder:"Seleccione una UEA"})}),e.jsx(p,{children:e.jsxs(h,{children:[e.jsx(x,{children:"UEAs"}),b.map(r=>e.jsx(j,{value:String(r.id),children:r.name},r.id))]})})]}),e.jsx(i,{message:t.uea_id})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(o,{htmlFor:"year",children:"A침o"}),e.jsxs(d,{onValueChange:r=>a("year",r),value:s.year,children:[e.jsx(m,{children:e.jsx(u,{placeholder:"Seleccione un a침o"})}),e.jsx(p,{children:e.jsxs(h,{children:[e.jsx(x,{children:"A침os"}),T.map(r=>e.jsx(j,{value:String(r),children:r},r))]})})]}),e.jsx(i,{message:t.year})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(o,{htmlFor:"month",children:"Mes"}),e.jsxs(d,{onValueChange:r=>a("month",r),value:s.month,children:[e.jsx(m,{children:e.jsx(u,{placeholder:"Seleccione un mes"})}),e.jsx(p,{children:e.jsxs(h,{children:[e.jsx(x,{children:"Meses"}),H.map(r=>e.jsx(j,{value:r.value,children:r.label},r.value))]})})]}),e.jsx(i,{message:t.month})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(o,{htmlFor:"file",children:"Archivo"}),e.jsx(G,{type:"file",id:"file",required:!0,accept:".xlsx,.xls",ref:n,onChange:r=>a("file",r.target.files?r.target.files[0]:null)}),e.jsx(i,{message:t.file})]}),e.jsxs(y,{type:"submit",className:"mt-2",disabled:!E()||g,children:[g&&e.jsx(K,{className:"h-4 w-4 animate-spin"}),"Guardar"]})]})]})]}),e.jsx(P,{setIsDialogOpen:S,isDialogOpen:F})]})}export{je as default};
