import{r as y,m as B,j as e}from"./app-Pjxy35jT.js";import{B as j}from"./button-JEyeJLuj.js";import{D as E,a as V,b as k,c as F,d as L,e as T}from"./dialog-Bxd5yeim.js";import{I as q}from"./input-Cy-PffbC.js";import{L as t}from"./label-DVEzNDQn.js";import{S as l,a as o,b as c,c as d,d as u,e as p,f as h}from"./select-Bntu6Is5.js";import{m as P}from"./utils-DU6Hee-i.js";import{t as m}from"./index-ChKC4xw7.js";import U from"./download-Dw_oIA-Q.js";import{c as H}from"./index-DLfEdX_p.js";import"./index-_philcsi.js";import"./index-D9phxP_G.js";import"./index-x5ygObbJ.js";import"./index-C3r3MIZ_.js";import"./index-DXAgfHUs.js";import"./index-C3aTgX75.js";import"./check-BeZxY9yK.js";import"./chevron-left-L5UTqYiI.js";import"./chevron-right-BOsLRH1c.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=[["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M16 22h2a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v3.5",key:"13ddob"}],["path",{d:"M4.017 11.512a6 6 0 1 0 8.466 8.475",key:"s6vs5t"}],["path",{d:"M9 16a1 1 0 0 1-1-1v-4c0-.552.45-1.008.995-.917a6 6 0 0 1 4.922 4.922c.091.544-.365.995-.917.995z",key:"1dl6s6"}]],z=H("FileChartPie",Y);function de({contractorCompanyTypes:g,ueas:f}){const v=new Date().getFullYear(),C=String(new Date().getMonth()+1).padStart(2,"0"),[N,S]=y.useState(!1),[I,D]=y.useState(!1),{data:s,setData:i,post:A,processing:x,reset:O}=B({contractor_company_type_id:"",uea_id:"",year:String(v),month:String(Number(C)),file:null}),w=r=>{if(r.preventDefault(),!s.contractor_company_type_id||!s.uea_id||!s.year||!s.month||!s.file){m.error("Por favor, complete todos los campos antes de enviar.",{duration:2e4,closeButton:!0});return}A(route("annexes.store"),{onSuccess:n=>{var _;const a=(_=n.props)==null?void 0:_.flash;if(a!=null&&a.success)m.success(a.success,{duration:2e4,closeButton:!0}),O(),D(!1);else if(a!=null&&a.error){i("file",null);const b=document.querySelector('input[type="file"]');b&&(b.value=""),m.error(a.error,{duration:2e4,closeButton:!0})}},onError:()=>{m.error("Ocurri칩 un error al subir el archivo, intente de nuevo.",{duration:2e4,closeButton:!0})}})},M=Array.from({length:10},(r,n)=>v-n);return e.jsxs("div",{children:[g&&f&&e.jsxs(E,{open:I,onOpenChange:D,children:[e.jsxs("div",{className:"mb-4 flex justify-between",children:[e.jsx(V,{asChild:!0,children:e.jsx(j,{children:"Agregar Indicador"})}),e.jsxs(j,{className:"ml-2",variant:"warning",onClick:()=>S(!0),disabled:x,children:[e.jsx(z,{className:"mr-2 h-4 w-4"}),"Formato"]})]}),e.jsxs(k,{onInteractOutside:r=>r.preventDefault(),children:[e.jsxs(F,{children:[e.jsx(L,{children:"Agregar Indicador"}),e.jsx(T,{children:"Complete los campos para agregar un nuevo indicador."})]}),e.jsxs("form",{onSubmit:w,className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(t,{children:"Tipo de Cliente"}),e.jsxs(l,{required:!0,onValueChange:r=>i("contractor_company_type_id",r),value:s.contractor_company_type_id,children:[e.jsx(o,{children:e.jsx(c,{placeholder:"Seleccione un tipo de cliente"})}),e.jsx(d,{children:e.jsxs(u,{children:[e.jsx(p,{children:"Tipos de Cliente"}),g.map(r=>e.jsx(h,{value:String(r.id),children:r.name},r.id))]})})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(t,{children:"UEA"}),e.jsxs(l,{onValueChange:r=>i("uea_id",r),value:s.uea_id,children:[e.jsx(o,{children:e.jsx(c,{placeholder:"Seleccione una UEA"})}),e.jsx(d,{children:e.jsxs(u,{children:[e.jsx(p,{children:"UEAs"}),f.map(r=>e.jsx(h,{value:String(r.id),children:r.name},r.id))]})})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(t,{children:"A침o"}),e.jsxs(l,{onValueChange:r=>i("year",r),value:s.year,children:[e.jsx(o,{children:e.jsx(c,{placeholder:"Seleccione un a침o"})}),e.jsx(d,{children:e.jsxs(u,{children:[e.jsx(p,{children:"A침os"}),M.map(r=>e.jsx(h,{value:String(r),children:r},r))]})})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(t,{children:"Mes"}),e.jsxs(l,{onValueChange:r=>i("month",r),value:s.month,children:[e.jsx(o,{children:e.jsx(c,{placeholder:"Seleccione un mes"})}),e.jsx(d,{children:e.jsxs(u,{children:[e.jsx(p,{children:"Meses"}),P.map(r=>e.jsx(h,{value:r.value,children:r.label},r.value))]})})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(t,{children:"Archivo"}),e.jsx(q,{type:"file",accept:".xls,.xlsx",onChange:r=>{var n;return i("file",((n=r.target.files)==null?void 0:n[0])||null)}})]}),e.jsx("div",{className:"text-right",children:e.jsx(j,{type:"submit",disabled:!s.file||x,children:x?"Subiendo...":"Subir"})})]})]})]}),e.jsx(U,{setIsDialogOpen:S,isDialogOpen:N})]})}export{de as default};
