import{j as e,r as d,K as B,L as $}from"./app-k-c3-IUX.js";import{B as V}from"./badge-BAKPKg4E.js";import{B as m}from"./button-DS4OftCH.js";import{A as v}from"./arrow-up-down-BHjyChi_.js";import{c as W}from"./createLucideIcon-SZDYLwmW.js";import{S as H}from"./square-pen-CEPLTHYr.js";import{C as q}from"./circle-check-big-E7JdtSLw.js";import{T as U}from"./trash-2-quT4AUHS.js";import{u as G,f as E,g as J,a as Q,b as X,c as Y}from"./index-DJ2i9oiU.js";import{T as Z,a as ee,b as I,c as se,d as te,e as L}from"./table-DfL6ig8B.js";import{I as ae}from"./input-BmLBwXHo.js";import{S as k,a as P,b as D,c as O,f as p}from"./select-Bx-P63rG.js";import{A as le}from"./app-layout-DZFWTyUB.js";import oe from"./activate-DJiuC6GN.js";import ie from"./create-CbzV16Vt.js";import re from"./delete-6hJipmL-.js";import ne from"./edit-BpkNISXP.js";import de from"./reset-DU6__MQn.js";import ce from"./update-DFF2nsPY.js";import"./utils-CISCwvQU.js";import"./index-B3PbW1eo.js";import"./index-D342dBXe.js";import"./index-DrGBlFrz.js";import"./index-Ch_9LA9U.js";import"./index-qSiOHZki.js";import"./index-BL9xfY7b.js";import"./check-CrF9bga2.js";import"./index-BnhXOjFJ.js";import"./tooltip-D3tBfP_G.js";import"./chevrons-up-down-zkKt1COi.js";import"./truck-D78V83WZ.js";import"./chevron-right-CzHWkwYl.js";import"./dialog-BuUT_YpG.js";import"./loader-circle-BUzb_yh4.js";import"./input-error--OUc2wW7.js";import"./label-CH4sFQ5V.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const me=[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]],ge=W("Key",me),xe=(g,r)=>[{accessorKey:"id",header:({column:s})=>e.jsxs(m,{variant:"ghost",onClick:()=>s.toggleSorting(s.getIsSorted()==="asc"),children:["ID",e.jsx(v,{className:"ml-2 h-4 w-4"})]}),cell:({row:s})=>s.original.id},{id:"nombre_completo",header:({column:s})=>e.jsxs(m,{variant:"ghost",onClick:()=>s.toggleSorting(s.getIsSorted()==="asc"),children:["Nombre Completo",e.jsx(v,{className:"ml-2 h-4 w-4"})]}),cell:({row:s})=>`${s.original.nombres} ${s.original.apellidos}`,sortingFn:(s,l)=>{const i=`${s.original.nombres} ${s.original.apellidos}`,n=`${l.original.nombres} ${l.original.apellidos}`;return i.localeCompare(n)}},{accessorKey:"email",header:"Email"},{accessorKey:"role_id",header:({column:s})=>e.jsxs(m,{variant:"ghost",onClick:()=>s.toggleSorting(s.getIsSorted()==="asc"),children:["Rol",e.jsx(v,{className:"ml-2 h-4 w-4"})]}),cell:({row:s})=>{const l=s.original.role_id,i=r.find(n=>n.id===l);return(i==null?void 0:i.nombre)||"Sin rol"},sortingFn:(s,l)=>{const i=r.find(h=>h.id===s.original.role_id),n=r.find(h=>h.id===l.original.role_id),u=(i==null?void 0:i.nombre)||"Sin rol",x=(n==null?void 0:n.nombre)||"Sin rol";return u.localeCompare(x)}},{accessorKey:"doi",header:({column:s})=>e.jsxs(m,{variant:"ghost",onClick:()=>s.toggleSorting(s.getIsSorted()==="asc"),children:["DNI",e.jsx(v,{className:"ml-2 h-4 w-4"})]})},{accessorKey:"updated_at",header:({column:s})=>e.jsxs(m,{variant:"ghost",onClick:()=>s.toggleSorting(s.getIsSorted()==="asc"),children:["Fecha Modificación",e.jsx(v,{className:"ml-2 h-4 w-4"})]}),cell:({row:s})=>new Date(s.original.updated_at).toLocaleString("es-ES")},{accessorKey:"estado",header:"Estado",cell:({row:s})=>{const l=s.original.estado;return e.jsx(V,{variant:l==="1"?"default":"destructive",children:l==="1"?"Activo":"No Activo"})}},{id:"acciones",header:"Acciones",cell:({row:s})=>{const l=s.original.id,i=s.original.estado;return e.jsxs("div",{className:"flex flex-wrap space-x-2",children:[e.jsxs(m,{"aria-label":"Restablecer Contraseña",className:"h-7 bg-blue-700 p-2 text-xs text-white hover:bg-blue-900 dark:bg-blue-600 dark:hover:bg-blue-800",onClick:()=>g("reset",l),children:[e.jsx(ge,{className:"h-3 w-3"})," "]}),e.jsx(m,{"aria-label":"Editar",className:"h-7 bg-yellow-700 p-2 text-xs text-white hover:bg-yellow-900 dark:bg-yellow-600 dark:hover:bg-yellow-800",onClick:()=>g("editar",l),children:e.jsx(H,{className:"h-3 w-3"})}),i!=="1"&&e.jsx(m,{"aria-label":"Activar",className:"h-7 bg-green-700 p-2 text-xs text-white hover:bg-green-900 dark:bg-green-600 dark:hover:bg-green-800",onClick:()=>g("activar",l),children:e.jsx(q,{className:"h-3 w-3"})}),i==="1"&&e.jsx(m,{"aria-label":"Eliminar",className:"h-7 bg-red-700 p-2 text-xs text-white hover:bg-red-900 dark:bg-red-600 dark:hover:bg-red-800",onClick:()=>g("eliminar",l),children:e.jsx(U,{className:"h-3 w-3"})})]})}}];function he({columns:g,data:r,roles:s}){var A;const[l,i]=d.useState([]),[n,u]=d.useState(""),[x,h]=d.useState("__all__"),[f,S]=d.useState("__all__"),[C,b]=d.useState({pageIndex:0,pageSize:10}),_=d.useMemo(()=>{const t=new Set;return r.forEach(a=>{a.role_id&&t.add(a.role_id)}),s.filter(a=>t.has(a.id))},[r,s]),j=d.useMemo(()=>{const t=new Set;return r.forEach(a=>{a.estado&&t.add(a.estado)}),Array.from(t)},[r]),N=d.useMemo(()=>{let t=r;if(n){const a=n.toLowerCase();t=t.filter(o=>{const w=s.find(z=>z.id===o.role_id);return o.nombres&&o.nombres.toLowerCase().includes(a)||o.apellidos&&o.apellidos.toLowerCase().includes(a)||o.email&&o.email.toLowerCase().includes(a)||o.telefono&&o.telefono.toLowerCase().includes(a)||o.cargo&&o.cargo.toLowerCase().includes(a)||(w==null?void 0:w.nombre)&&w.nombre.toLowerCase().includes(a)||o.doi&&o.doi.toLowerCase().includes(a)})}if(x!=="__all__"){const a=s.find(o=>o.nombre===x);a&&(t=t.filter(o=>o.role_id===a.id))}return f!=="__all__"&&(t=t.filter(a=>a.estado===f)),t},[r,n,x,f,s]),c=G({data:N,columns:g,getCoreRowModel:Y(),getPaginationRowModel:X(),onSortingChange:i,getSortedRowModel:Q(),getFilteredRowModel:J(),state:{sorting:l,pagination:C},onPaginationChange:b,manualPagination:!1,pageCount:void 0}),y=t=>{b(a=>({...a,pageSize:Number(t),pageIndex:0}))},R=N.length,M=c.getState().pagination.pageIndex,T=c.getState().pagination.pageSize,F=R===0?0:M*T+1,K=Math.min((M+1)*T,R);return e.jsxs("div",{children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4 py-4 w-full",children:[e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("label",{className:"text-sm mb-1",children:"Mostrar"}),e.jsxs(k,{value:C.pageSize.toString(),onValueChange:y,children:[e.jsx(P,{className:"w-full",children:e.jsx(D,{})}),e.jsxs(O,{children:[e.jsx(p,{value:"10",children:"10"}),e.jsx(p,{value:"25",children:"25"}),e.jsx(p,{value:"50",children:"50"}),e.jsx(p,{value:"100",children:"100"})]})]}),e.jsx("span",{className:"text-xs text-muted-foreground mt-1",children:"registros"})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("label",{className:"text-sm mb-1",children:"Buscar"}),e.jsx(ae,{placeholder:"Buscar en todos los campos...",value:n,onChange:t=>u(t.target.value),className:"w-full"})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("label",{className:"text-sm mb-1",children:"Rol"}),e.jsxs(k,{value:x,onValueChange:h,children:[e.jsx(P,{children:e.jsx(D,{placeholder:"Todos"})}),e.jsxs(O,{children:[e.jsx(p,{value:"__all__",children:"Todos"}),_.map(t=>e.jsx(p,{value:t.nombre,children:t.nombre},t.id))]})]})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("label",{className:"text-sm mb-1",children:"Estado"}),e.jsxs(k,{value:f,onValueChange:S,children:[e.jsx(P,{children:e.jsx(D,{placeholder:"Todos"})}),e.jsxs(O,{children:[e.jsx(p,{value:"__all__",children:"Todos"}),j.map(t=>e.jsx(p,{value:t,children:t==="1"?"Activo":"No Activo"},t))]})]})]})]}),e.jsx("div",{className:"grid grid-cols-1 rounded-md border",children:e.jsxs(Z,{className:"text-xs",children:[e.jsx(ee,{children:c.getHeaderGroups().map(t=>e.jsx(I,{children:t.headers.map(a=>e.jsx(se,{style:{minWidth:"10px",maxWidth:"200px"},children:a.isPlaceholder?null:E(a.column.columnDef.header,a.getContext())},a.id))},t.id))}),e.jsx(te,{children:(A=c.getRowModel().rows)!=null&&A.length?c.getRowModel().rows.map(t=>e.jsx(I,{"data-state":t.getIsSelected()&&"selected",children:t.getVisibleCells().map(a=>e.jsx(L,{style:{minWidth:"10px",maxWidth:"200px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:E(a.column.columnDef.cell,a.getContext())},a.id))},t.id)):e.jsx(I,{children:e.jsx(L,{colSpan:g.length,className:"h-24 text-center",children:"No hay resultados."})})})]})}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between py-4 gap-2",children:[e.jsxs("span",{className:"text-xs text-muted-foreground",children:["Mostrando ",F," a ",K," de ",R," registros"]}),e.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[e.jsx(m,{variant:"outline",size:"sm",onClick:()=>c.previousPage(),disabled:!c.getCanPreviousPage(),children:"Anterior"}),e.jsx(m,{variant:"outline",size:"sm",onClick:()=>c.nextPage(),disabled:!c.getCanNextPage(),children:"Siguiente"})]})]})]})}const pe=[{title:"Personal",href:"/contrata/personal"}];function Ye(){const{people:g,roles:r,auth:s}=B().props,[l,i]=d.useState(null),[n,u]=d.useState(!1),[x,h]=d.useState(!1),[f,S]=d.useState(!1),[C,b]=d.useState(!1),_=(j,N)=>{const c=g.find(y=>y.id===N);i(c||null),j==="editar"?u(!0):j==="eliminar"?h(!0):j==="activar"?S(!0):j==="reset"&&b(!0)};return e.jsxs(le,{breadcrumbs:pe,children:[e.jsx($,{title:"Personal"}),e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(ie,{roles:r}),s.user.role_code==="SA"&&e.jsx(ce,{})]}),e.jsx("div",{className:"w-full max-w-full overflow-x-auto",children:e.jsx(he,{columns:xe(_,r),data:g,roles:r})})]}),l&&e.jsxs(e.Fragment,{children:[e.jsx(ne,{isOpen:n,onOpenChange:u,person:l,roles:r}),e.jsx(re,{isOpen:x,onOpenChange:h,selectedItem:l}),e.jsx(oe,{isOpen:f,onOpenChange:S,selectedItem:l}),e.jsx(de,{isOpen:C,onOpenChange:b,selectedItem:l})]})]})}export{Ye as default};
