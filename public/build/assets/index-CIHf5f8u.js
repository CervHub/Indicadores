import{j as e,r as o,K as O,L as k}from"./app-2ocnS8h9.js";import{A as $}from"./app-layout-MfkF6KhY.js";import{B as h}from"./badge-B6Ze7Uih.js";import{u as U,f as T,g as q,a as J,b as Q,c as X}from"./index-DIdqAdH5.js";import{T as Y,a as Z,b as y,c as ee,d as ae,e as V}from"./table-B4lekv8i.js";import{B as E}from"./button-DYED8VDT.js";import{I as se}from"./input-CluIwiun.js";import{S as K,a as z,b as A,c as L,f as d}from"./select-R6yFqbLe.js";import{C as te}from"./combobox-BMOJXa9g.js";import"./index-CViCya3V.js";import"./index-CVPpN8V0.js";import"./utils-Dba3_-po.js";import"./index-DvCuoloa.js";import"./createLucideIcon-vfo7GjNC.js";import"./index-B1l-BCg7.js";import"./tooltip-BEYdpRRO.js";import"./index-DFI_lVRN.js";import"./index-D9no_Jgx.js";import"./index-Dfo1S9vc.js";import"./chevrons-up-down-DkgaahkR.js";import"./truck-Dpy4VojO.js";import"./chevron-right-DuZuUPXd.js";import"./check-CjxkVsOo.js";import"./search-34cN3l0Y.js";import"./popover-Cg6zYRJG.js";import"./trash-2-Cxzi9v3Y.js";const re=[{accessorKey:"license_plate",header:"Placa"},{accessorKey:"code",header:"Código de Vehículo",cell:({row:r})=>{var n;const t=r.original.vehicle_companies??[];if(!t.length)return"";const l=[...t].sort((m,c)=>(c.created_at??"")>(m.created_at??"")?1:-1)[0];return`${((n=l==null?void 0:l.company)==null?void 0:n.code)??""}${(l==null?void 0:l.code)??""}`}},{accessorKey:"ultima_empresa_vinculada",header:"Empresa Vinculada",cell:({row:r})=>{var l,n;const t=r.original.vehicle_companies??[];return t.length?((n=(l=[...t].sort((m,c)=>(c.created_at??"")>(m.created_at??"")?1:-1)[0])==null?void 0:l.company)==null?void 0:n.nombre)??"":""}},{accessorKey:"ins_diaria",header:"Ins. Diaria",cell:({row:r})=>e.jsx(h,{variant:"secondary",children:"Sin data"})},{accessorKey:"ins_diaria_visita",header:"Ins. Diaria Visita",cell:({row:r})=>e.jsx(h,{variant:"secondary",children:"Sin data"})},{accessorKey:"ins_trimestral",header:"Ins. Trimestral",cell:({row:r})=>e.jsx(h,{variant:"secondary",children:"Sin data"})},{accessorKey:"ins_semestral",header:"Ins. Semestral",cell:({row:r})=>e.jsx(h,{variant:"secondary",children:"Sin data"})},{accessorKey:"ins_parada_planta",header:"Ins. Parada de Planta",cell:({row:r})=>e.jsx(h,{variant:"secondary",children:"Sin data"})}];function le({columns:r,data:t}){var I;const[f,l]=o.useState([]),[n,m]=o.useState("__all__"),[c,C]=o.useState({pageIndex:0,pageSize:10}),B=o.useMemo(()=>{const a=new Set;return t.forEach(s=>{s.gerencia_name&&a.add(s.gerencia_name)}),Array.from(a)},[t]);o.useMemo(()=>{const a=new Set;return t.forEach(s=>{s.company_name&&a.add(s.company_name)}),Array.from(a).map(s=>({value:s,label:s}))},[t]),o.useMemo(()=>{const a=new Set;return t.forEach(s=>{s.company_report_name&&a.add(s.company_report_name)}),Array.from(a).map(s=>({value:s,label:s}))},[t]);const[u,D]=o.useState(""),[g,N]=o.useState(""),F=o.useMemo(()=>{const a=new Set;return t.forEach(s=>{var v,_;const p=s.vehicle_companies??[];if(p.length){const x=(_=(v=[...p].sort((b,w)=>(w.created_at??"")>(b.created_at??"")?1:-1)[0])==null?void 0:v.company)==null?void 0:_.nombre;x&&a.add(x)}}),Array.from(a).map(s=>({value:s,label:s}))},[t]),P=o.useMemo(()=>{let a=t;return n!=="__all__"&&(a=a.filter(s=>s.gerencia_name===n)),u&&(a=a.filter(s=>(s.license_plate??"").toLowerCase().includes(u.toLowerCase()))),g&&(a=a.filter(s=>{var S,x;const p=s.vehicle_companies??[];return p.length?(((x=(S=[...p].sort((b,w)=>(w.created_at??"")>(b.created_at??"")?1:-1)[0])==null?void 0:S.company)==null?void 0:x.nombre)??"").toLowerCase().includes(g.toLowerCase()):!1})),a},[t,n,u,g]),i=U({data:P,columns:r,getCoreRowModel:X(),getPaginationRowModel:Q(),onSortingChange:l,getSortedRowModel:J(),getFilteredRowModel:q(),state:{sorting:f,pagination:c},onPaginationChange:C,manualPagination:!1,pageCount:void 0}),W=a=>{C(s=>({...s,pageSize:Number(a),pageIndex:0}))},j=P.length,M=i.getState().pagination.pageIndex,R=i.getState().pagination.pageSize,G=j===0?0:M*R+1,H=Math.min((M+1)*R,j);return e.jsxs("div",{children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-7 gap-4 py-4 w-full",children:[e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("label",{className:"text-sm mb-1",children:"Mostrar"}),e.jsxs(K,{value:c.pageSize.toString(),onValueChange:W,children:[e.jsx(z,{className:"w-full",children:e.jsx(A,{})}),e.jsxs(L,{children:[e.jsx(d,{value:"10",children:"10"}),e.jsx(d,{value:"25",children:"25"}),e.jsx(d,{value:"50",children:"50"}),e.jsx(d,{value:"100",children:"100"})]})]}),e.jsx("span",{className:"text-xs text-muted-foreground mt-1",children:"registros"})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("label",{className:"text-sm mb-1",children:"Gerencia"}),e.jsxs(K,{value:n,onValueChange:m,children:[e.jsx(z,{children:e.jsx(A,{placeholder:"Todas"})}),e.jsxs(L,{children:[e.jsx(d,{value:"__all__",children:"Todas"}),B.map(a=>e.jsx(d,{value:a,children:a},a))]})]})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("label",{className:"text-sm mb-1",children:"Buscar Placa"}),e.jsx(se,{value:u,onChange:a=>D(a.target.value),placeholder:"Placa...",className:"w-full"})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("label",{className:"text-sm mb-1",children:"Empresa "}),e.jsx(te,{data:F,value:g,onChange:N,placeholder:"Seleccione o escriba empresa...",className:"w-full",onInputChange:a=>{a||N("")}})]})]}),e.jsx("div",{className:"grid grid-cols-1 rounded-md border",children:e.jsxs(Y,{className:"text-xs",children:[e.jsx(Z,{children:i.getHeaderGroups().map(a=>e.jsx(y,{children:a.headers.map(s=>e.jsx(ee,{style:{minWidth:"10px",maxWidth:"150px"},children:s.isPlaceholder?null:T(s.column.columnDef.header,s.getContext())},s.id))},a.id))}),e.jsx(ae,{children:(I=i.getRowModel().rows)!=null&&I.length?i.getRowModel().rows.map(a=>e.jsx(y,{"data-state":a.getIsSelected()&&"selected",children:a.getVisibleCells().map(s=>e.jsx(V,{style:{minWidth:"10px",maxWidth:"150px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:T(s.column.columnDef.cell,s.getContext())},s.id))},a.id)):e.jsx(y,{children:e.jsx(V,{colSpan:r.length,className:"h-24 text-center",children:"No results."})})})]})}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between py-4 gap-2",children:[e.jsxs("span",{className:"text-xs text-muted-foreground",children:["Mostrando ",G," a ",H," de ",j," registros"]}),e.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[e.jsx(E,{variant:"outline",size:"sm",onClick:()=>i.previousPage(),disabled:!i.getCanPreviousPage(),children:"Previous"}),e.jsx(E,{variant:"outline",size:"sm",onClick:()=>i.nextPage(),disabled:!i.getCanNextPage(),children:"Next"})]})]})]})}const ne=[{title:"Gestión de Vehículos",href:"/vehiculos"}];function Ee(){const{vehicles:r}=O().props;return console.log("Vehicles:",r),e.jsxs($,{breadcrumbs:ne,children:[e.jsx(k,{title:"Vehículos"}),e.jsx("div",{className:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4",children:e.jsx("div",{className:"flex-1",children:e.jsx(le,{columns:re,data:r??[]})})})]})}export{Ee as default};
