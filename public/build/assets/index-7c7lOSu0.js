import{j as e,$ as N,r as g,K as w,L as T}from"./app-7hetFM7w.js";import{B as h}from"./badge-DWEALSSm.js";import{B as d}from"./button-bLmRwzQ6.js";import{T as p,a as u,b as j,c as f,F as _,A}from"./app-layout-qegd76xZ.js";import{m as M,a as R}from"./utils-BR1kMNAO.js";import{A as b}from"./arrow-up-down-CN6kW1v7.js";import{D as S}from"./download-CEOQ79tQ.js";import{u as D,T as F,a as P,b as x,c as k,f as C,d as K,e as v,g as $,h as B,i as U,j as I}from"./table-BHwx9VhU.js";import{I as z}from"./input-D6SS0c2C.js";import{u as E}from"./useFlashMessages-pz1NCDI7.js";import H from"./create-CPYxt2JV.js";import"./index-D4H2Lyt1.js";import"./index-CQ-qqEvn.js";import"./index-p3DQSU8t.js";import"./index-Cmg62qSN.js";import"./index-CjwAPlmi.js";import"./index-sK8TmGFw.js";import"./index-CeA-aoVn.js";import"./chevrons-up-down-HQVCkQ8f.js";import"./app-logo-icon-Lhktw6VA.js";import"./input-error-DoR3blbk.js";import"./dialog-BNsp8Rr4.js";import"./label-CBWDRjKZ.js";import"./select-DNQXkSf4.js";import"./index-BzSJwi4p.js";import"./check-TCMgKA_A.js";import"./loader-circle-Gm3eUCQq.js";const y=i=>i===0?"destructive":i===100?"default":"secondary",L=(i,m)=>[{accessorKey:"contractor_company_type_id",header:"T. Cliente",cell:({row:n})=>{const s=i.find(t=>t.id===Number(n.original.contractor_company_type_id));return s?s.name:"Unknown"}},{accessorKey:"uea_id",header:"UEA",cell:({row:n})=>{const s=m.find(t=>t.id===Number(n.original.uea_id));return s?s.name:"Unknown"}},{accessorKey:"month",header:({column:n})=>e.jsxs(d,{variant:"ghost",onClick:()=>n.toggleSorting(n.getIsSorted()==="asc"),children:["Mes",e.jsx(b,{className:"ml-2 h-4 w-4"})]}),cell:({row:n})=>{const s=M.find(t=>Number(t.value)===Number(n.original.month));return s?s.label:"Unknown"}},{accessorKey:"year",header:({column:n})=>e.jsxs(d,{variant:"ghost",onClick:()=>n.toggleSorting(n.getIsSorted()==="asc"),children:["Year",e.jsx(b,{className:"ml-2 h-4 w-4"})]})},{accessorKey:"annexes",header:"Anexos",cell:({row:n})=>{const s=[n.original.annex24,n.original.annex25,n.original.annex26,n.original.annex27,n.original.annex28],r=(s.filter(l=>l==="true"||l==="1").length/s.length*100).toFixed(0),a=y(Number(r));return e.jsx(p,{children:e.jsxs(u,{children:[e.jsx(j,{children:e.jsx(h,{variant:a,children:`${r}%`})}),e.jsxs(f,{children:[e.jsxs("p",{children:["Annex 24: ",n.original.annex24]}),e.jsxs("p",{children:["Annex 25: ",n.original.annex25]}),e.jsxs("p",{children:["Annex 26: ",n.original.annex26]}),e.jsxs("p",{children:["Annex 27: ",n.original.annex27]}),e.jsxs("p",{children:["Annex 28: ",n.original.annex28]}),e.jsxs("p",{children:["Annex 30: ",n.original.annex30]})]})]})})}},{accessorKey:"minem_templates",header:"Minems",cell:({row:n})=>{const s=[n.original.minem_template_1,n.original.minem_template_2],r=(s.filter(l=>l==="true"||l==="1").length/s.length*100).toFixed(0),a=y(Number(r));return e.jsx(p,{children:e.jsxs(u,{children:[e.jsx(j,{children:e.jsx(h,{variant:a,children:`${r}%`})}),e.jsxs(f,{children:[e.jsxs("p",{children:["Minem Template 1: ",n.original.minem_template_1]}),e.jsxs("p",{children:["Minem Template 2: ",n.original.minem_template_2]})]})]})})}},{accessorKey:"F. Creación",header:"F. Creación",cell:({row:n})=>{const s=new Date(n.original.created_at);return R(s)}},{id:"actions",header:"Acciones",cell:({row:n})=>{const s=n.original,t=a=>{console.log(`Downloading file from: ${window.location.origin}/${a}`)},r=`${window.location.origin}/${s.file}`;return e.jsxs("div",{children:[e.jsx(N,{href:route("annexes.show",{annex:s.id}),children:e.jsxs(d,{variant:"default",size:"sm",children:[e.jsx(_,{className:"mr-2 h-4 w-4"}),"Detalle"]})}),e.jsx("a",{href:r,download:!0,onClick:()=>t(s.file),children:e.jsxs(d,{variant:"destructive",size:"sm",className:"ml-2",children:[e.jsx(S,{className:"mr-2 h-4 w-4"}),"Descargar"]})})]})}}];function G({columns:i,data:m}){var l;const[n,s]=g.useState([]),[t,r]=g.useState(""),a=D({data:m,columns:i,getCoreRowModel:I(),getPaginationRowModel:U(),onSortingChange:s,getSortedRowModel:B(),onGlobalFilterChange:r,getFilteredRowModel:$(),state:{sorting:n,globalFilter:t}});return e.jsxs("div",{children:[e.jsx("div",{className:"flex items-center py-4",children:e.jsx(z,{placeholder:"Filter by any column...",value:t,onChange:o=>r(o.target.value),className:"max-w-sm"})}),e.jsx("div",{className:"grid grid-cols-1 rounded-md border",children:e.jsxs(F,{className:"text-xs",children:[e.jsx(P,{children:a.getHeaderGroups().map(o=>e.jsx(x,{children:o.headers.map(c=>e.jsx(k,{children:c.isPlaceholder?null:C(c.column.columnDef.header,c.getContext())},c.id))},o.id))}),e.jsx(K,{children:(l=a.getRowModel().rows)!=null&&l.length?a.getRowModel().rows.map(o=>e.jsx(x,{"data-state":o.getIsSelected()&&"selected",children:o.getVisibleCells().map(c=>e.jsx(v,{children:C(c.column.columnDef.cell,c.getContext())},c.id))},o.id)):e.jsx(x,{children:e.jsx(v,{colSpan:i.length,className:"h-24 text-center",children:"No results."})})})]})}),e.jsxs("div",{className:"flex items-center justify-end space-x-2 py-4",children:[e.jsx(d,{variant:"outline",size:"sm",onClick:()=>a.previousPage(),disabled:!a.getCanPreviousPage(),children:"Previous"}),e.jsx(d,{variant:"outline",size:"sm",onClick:()=>a.nextPage(),disabled:!a.getCanNextPage(),children:"Next"})]})]})}const V=[{title:"Anexos",href:"/annexe"}];function be(){E();const{fileStatuses:i,contractorCompanyTypes:m,ueas:n,rules:s}=w().props;return e.jsxs(A,{breadcrumbs:V,children:[e.jsx(T,{title:"Contratistas"}),e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4",children:[e.jsx(H,{rules:s}),e.jsx("div",{className:"w-full max-w-full overflow-x-auto",children:e.jsx(G,{columns:L(m,n),data:i})})]})]})}export{be as default};
