import{U as S,r as N,j as e,L as xt,b as gt}from"./app-CkX-sCCf.js";import{A as bt}from"./app-layout-NwK8qtki.js";import{C as M,a as U,b as W,c as V,d as k,e as oe}from"./card-Alk4mtLg.js";import{d as X,e as B,m as Se,i as me,h as De,A as Je,j as K,k as re,l as vt,n as Ie,o as jt,p as T,u as Qe,q as Re,G as et,r as he,s as Ee,D as yt,S as We,t as Nt,v as Ct,w as tt,E as wt,x as At,y as rt,g as at,B as _,X as Y,Y as q,f as st,c as ot,C as Z,z as J,a as ne,b as Ge,R as nt}from"./chart-B44Q1FYq.js";import{F as Le}from"./file-text-BQQHQTRf.js";import{C as Pt}from"./circle-check-big-C3Rweq6Q.js";import{c as St}from"./createLucideIcon-Cux2gun-.js";import{T as G}from"./trending-up-CZqdmLN8.js";import{P as Dt,a as Rt}from"./PieChart-pWeTbULn.js";import{S as pe,a as fe,b as xe,c as ge,f as I}from"./select-DPNjP_Lz.js";import{e as Ue}from"./utils-Co_qxGNv.js";import{B as $}from"./button-Bw2Xdp6E.js";import{I as se}from"./input-MjwaqtbJ.js";import{C as ye}from"./chevron-left-mr3G86Ux.js";import{C as Ne}from"./chevron-right-D5H3JAm1.js";import{S as Ce}from"./search-fTzzglXd.js";import{B as ze}from"./badge-BoWuBp5k.js";import{T as Et,a as Ot,b as _e,c as ee,d as Mt,e as H}from"./table-DskUy7h3.js";import{T as kt,a as Tt,b as $t,c as Lt}from"./tooltip-CeYhT-Ve.js";import{C as zt}from"./combobox-5AR5Cdh7.js";import"./index-uPTyyJTB.js";import"./index-ItJPPwpU.js";import"./index-C0Urlq2e.js";import"./index-BbjDzo9d.js";import"./index-BeeyGmDn.js";import"./index-RgIy1NKL.js";import"./check-DYdSJAZQ.js";import"./chevrons-up-down-BuW2oQV_.js";import"./truck-CJs_TKyA.js";import"./index-CswDWhBD.js";import"./index-Chjiymov.js";import"./index-DiuJ2rgF.js";import"./trash-2-C_t5SLgw.js";var _t=["layout","type","stroke","connectNulls","isRange","ref"],It=["key"],it;function be(r){"@babel/helpers - typeof";return be=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},be(r)}function lt(r,t){if(r==null)return{};var s=Kt(r,t),a,i;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);for(i=0;i<l.length;i++)a=l[i],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(r,a)&&(s[a]=r[a])}return s}function Kt(r,t){if(r==null)return{};var s={};for(var a in r)if(Object.prototype.hasOwnProperty.call(r,a)){if(t.indexOf(a)>=0)continue;s[a]=r[a]}return s}function le(){return le=Object.assign?Object.assign.bind():function(r){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(r[a]=s[a])}return r},le.apply(this,arguments)}function Ve(r,t){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(r);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),s.push.apply(s,a)}return s}function te(r){for(var t=1;t<arguments.length;t++){var s=arguments[t]!=null?arguments[t]:{};t%2?Ve(Object(s),!0).forEach(function(a){F(r,a,s[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(s)):Ve(Object(s)).forEach(function(a){Object.defineProperty(r,a,Object.getOwnPropertyDescriptor(s,a))})}return r}function Bt(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function Ye(r,t){for(var s=0;s<t.length;s++){var a=t[s];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(r,dt(a.key),a)}}function Ft(r,t,s){return t&&Ye(r.prototype,t),s&&Ye(r,s),Object.defineProperty(r,"prototype",{writable:!1}),r}function Gt(r,t,s){return t=Oe(t),Ut(r,ct()?Reflect.construct(t,s||[],Oe(r).constructor):t.apply(r,s))}function Ut(r,t){if(t&&(be(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Wt(r)}function Wt(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function ct(){try{var r=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(ct=function(){return!!r})()}function Oe(r){return Oe=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(s){return s.__proto__||Object.getPrototypeOf(s)},Oe(r)}function Vt(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),t&&Ke(r,t)}function Ke(r,t){return Ke=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,i){return a.__proto__=i,a},Ke(r,t)}function F(r,t,s){return t=dt(t),t in r?Object.defineProperty(r,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):r[t]=s,r}function dt(r){var t=Yt(r,"string");return be(t)=="symbol"?t:t+""}function Yt(r,t){if(be(r)!="object"||!r)return r;var s=r[Symbol.toPrimitive];if(s!==void 0){var a=s.call(r,t);if(be(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(r)}var ce=function(r){function t(){var s;Bt(this,t);for(var a=arguments.length,i=new Array(a),l=0;l<a;l++)i[l]=arguments[l];return s=Gt(this,t,[].concat(i)),F(s,"state",{isAnimationFinished:!0}),F(s,"id",Qe("recharts-area-")),F(s,"handleAnimationEnd",function(){var p=s.props.onAnimationEnd;s.setState({isAnimationFinished:!0}),Re(p)&&p()}),F(s,"handleAnimationStart",function(){var p=s.props.onAnimationStart;s.setState({isAnimationFinished:!1}),Re(p)&&p()}),s}return Vt(t,r),Ft(t,[{key:"renderDots",value:function(a,i,l){var p=this.props.isAnimationActive,d=this.state.isAnimationFinished;if(p&&!d)return null;var g=this.props,f=g.dot,c=g.points,h=g.dataKey,o=X(this.props,!1),v=X(f,!0),m=c.map(function(u,x){var j=te(te(te({key:"dot-".concat(x),r:3},o),v),{},{index:x,cx:u.x,cy:u.y,dataKey:h,value:u.value,payload:u.payload,points:c});return t.renderDotItem(f,j)}),n={clipPath:a?"url(#clipPath-".concat(i?"":"dots-").concat(l,")"):null};return S.createElement(B,le({className:"recharts-area-dots"},n),m)}},{key:"renderHorizontalRect",value:function(a){var i=this.props,l=i.baseLine,p=i.points,d=i.strokeWidth,g=p[0].x,f=p[p.length-1].x,c=a*Math.abs(g-f),h=Se(p.map(function(o){return o.y||0}));return me(l)&&typeof l=="number"?h=Math.max(l,h):l&&Array.isArray(l)&&l.length&&(h=Math.max(Se(l.map(function(o){return o.y||0})),h)),me(h)?S.createElement("rect",{x:g<f?g:g-c,y:0,width:c,height:Math.floor(h+(d?parseInt("".concat(d),10):1))}):null}},{key:"renderVerticalRect",value:function(a){var i=this.props,l=i.baseLine,p=i.points,d=i.strokeWidth,g=p[0].y,f=p[p.length-1].y,c=a*Math.abs(g-f),h=Se(p.map(function(o){return o.x||0}));return me(l)&&typeof l=="number"?h=Math.max(l,h):l&&Array.isArray(l)&&l.length&&(h=Math.max(Se(l.map(function(o){return o.x||0})),h)),me(h)?S.createElement("rect",{x:0,y:g<f?g:g-c,width:h+(d?parseInt("".concat(d),10):1),height:Math.floor(c)}):null}},{key:"renderClipRect",value:function(a){var i=this.props.layout;return i==="vertical"?this.renderVerticalRect(a):this.renderHorizontalRect(a)}},{key:"renderAreaStatically",value:function(a,i,l,p){var d=this.props,g=d.layout,f=d.type,c=d.stroke,h=d.connectNulls,o=d.isRange;d.ref;var v=lt(d,_t);return S.createElement(B,{clipPath:l?"url(#clipPath-".concat(p,")"):null},S.createElement(De,le({},X(v,!0),{points:a,connectNulls:h,type:f,baseLine:i,layout:g,stroke:"none",className:"recharts-area-area"})),c!=="none"&&S.createElement(De,le({},X(this.props,!1),{className:"recharts-area-curve",layout:g,type:f,connectNulls:h,fill:"none",points:a})),c!=="none"&&o&&S.createElement(De,le({},X(this.props,!1),{className:"recharts-area-curve",layout:g,type:f,connectNulls:h,fill:"none",points:i})))}},{key:"renderAreaWithAnimation",value:function(a,i){var l=this,p=this.props,d=p.points,g=p.baseLine,f=p.isAnimationActive,c=p.animationBegin,h=p.animationDuration,o=p.animationEasing,v=p.animationId,m=this.state,n=m.prevPoints,u=m.prevBaseLine;return S.createElement(Je,{begin:c,duration:h,isActive:f,easing:o,from:{t:0},to:{t:1},key:"area-".concat(v),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(x){var j=x.t;if(n){var y=n.length/d.length,b=d.map(function(P,D){var R=Math.floor(D*y);if(n[R]){var E=n[R],O=K(E.x,P.x),L=K(E.y,P.y);return te(te({},P),{},{x:O(j),y:L(j)})}return P}),w;if(me(g)&&typeof g=="number"){var C=K(u,g);w=C(j)}else if(re(g)||vt(g)){var A=K(u,0);w=A(j)}else w=g.map(function(P,D){var R=Math.floor(D*y);if(u[R]){var E=u[R],O=K(E.x,P.x),L=K(E.y,P.y);return te(te({},P),{},{x:O(j),y:L(j)})}return P});return l.renderAreaStatically(b,w,a,i)}return S.createElement(B,null,S.createElement("defs",null,S.createElement("clipPath",{id:"animationClipPath-".concat(i)},l.renderClipRect(j))),S.createElement(B,{clipPath:"url(#animationClipPath-".concat(i,")")},l.renderAreaStatically(d,g,a,i)))})}},{key:"renderArea",value:function(a,i){var l=this.props,p=l.points,d=l.baseLine,g=l.isAnimationActive,f=this.state,c=f.prevPoints,h=f.prevBaseLine,o=f.totalLength;return g&&p&&p.length&&(!c&&o>0||!Ie(c,p)||!Ie(h,d))?this.renderAreaWithAnimation(a,i):this.renderAreaStatically(p,d,a,i)}},{key:"render",value:function(){var a,i=this.props,l=i.hide,p=i.dot,d=i.points,g=i.className,f=i.top,c=i.left,h=i.xAxis,o=i.yAxis,v=i.width,m=i.height,n=i.isAnimationActive,u=i.id;if(l||!d||!d.length)return null;var x=this.state.isAnimationFinished,j=d.length===1,y=Ue("recharts-area",g),b=h&&h.allowDataOverflow,w=o&&o.allowDataOverflow,C=b||w,A=re(u)?this.id:u,P=(a=X(p,!1))!==null&&a!==void 0?a:{r:3,strokeWidth:2},D=P.r,R=D===void 0?3:D,E=P.strokeWidth,O=E===void 0?2:E,L=jt(p)?p:{},Q=L.clipDot,Pe=Q===void 0?!0:Q,ue=R*2+O;return S.createElement(B,{className:y},b||w?S.createElement("defs",null,S.createElement("clipPath",{id:"clipPath-".concat(A)},S.createElement("rect",{x:b?c:c-v/2,y:w?f:f-m/2,width:b?v:v*2,height:w?m:m*2})),!Pe&&S.createElement("clipPath",{id:"clipPath-dots-".concat(A)},S.createElement("rect",{x:c-ue/2,y:f-ue/2,width:v+ue,height:m+ue}))):null,j?null:this.renderArea(C,A),(p||j)&&this.renderDots(C,Pe,A),(!n||x)&&T.renderCallByParent(this.props,d))}}],[{key:"getDerivedStateFromProps",value:function(a,i){return a.animationId!==i.prevAnimationId?{prevAnimationId:a.animationId,curPoints:a.points,curBaseLine:a.baseLine,prevPoints:i.curPoints,prevBaseLine:i.curBaseLine}:a.points!==i.curPoints||a.baseLine!==i.curBaseLine?{curPoints:a.points,curBaseLine:a.baseLine}:null}}])}(N.PureComponent);it=ce;F(ce,"displayName","Area");F(ce,"defaultProps",{stroke:"#3182bd",fill:"#3182bd",fillOpacity:.6,xAxisId:0,yAxisId:0,legendType:"line",connectNulls:!1,points:[],dot:!1,activeDot:!0,hide:!1,isAnimationActive:!et.isSsr,animationBegin:0,animationDuration:1500,animationEasing:"ease"});F(ce,"getBaseValue",function(r,t,s,a){var i=r.layout,l=r.baseValue,p=t.props.baseValue,d=p??l;if(me(d)&&typeof d=="number")return d;var g=i==="horizontal"?a:s,f=g.scale.domain();if(g.type==="number"){var c=Math.max(f[0],f[1]),h=Math.min(f[0],f[1]);return d==="dataMin"?h:d==="dataMax"||c<0?c:Math.max(Math.min(f[0],f[1]),0)}return d==="dataMin"?f[0]:d==="dataMax"?f[1]:f[0]});F(ce,"getComposedData",function(r){var t=r.props,s=r.item,a=r.xAxis,i=r.yAxis,l=r.xAxisTicks,p=r.yAxisTicks,d=r.bandSize,g=r.dataKey,f=r.stackedData,c=r.dataStartIndex,h=r.displayedData,o=r.offset,v=t.layout,m=f&&f.length,n=it.getBaseValue(t,s,a,i),u=v==="horizontal",x=!1,j=h.map(function(b,w){var C;m?C=f[c+w]:(C=he(b,g),Array.isArray(C)?x=!0:C=[n,C]);var A=C[1]==null||m&&he(b,g)==null;return u?{x:Ee({axis:a,ticks:l,bandSize:d,entry:b,index:w}),y:A?null:i.scale(C[1]),value:C,payload:b}:{x:A?null:a.scale(C[1]),y:Ee({axis:i,ticks:p,bandSize:d,entry:b,index:w}),value:C,payload:b}}),y;return m||x?y=j.map(function(b){var w=Array.isArray(b.value)?b.value[0]:null;return u?{x:b.x,y:w!=null&&b.y!=null?i.scale(w):null}:{x:w!=null?a.scale(w):null,y:b.y}}):y=u?i.scale(n):a.scale(n),te({points:j,baseLine:y,layout:v,isRange:x},o)});F(ce,"renderDotItem",function(r,t){var s;if(S.isValidElement(r))s=S.cloneElement(r,t);else if(Re(r))s=r(t);else{var a=Ue("recharts-area-dot",typeof r!="boolean"?r.className:""),i=t.key,l=lt(t,It);s=S.createElement(yt,le({},l,{key:i,className:a}))}return s});function ve(r){"@babel/helpers - typeof";return ve=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ve(r)}function qt(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function Ht(r,t){for(var s=0;s<t.length;s++){var a=t[s];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(r,ht(a.key),a)}}function Xt(r,t,s){return t&&Ht(r.prototype,t),Object.defineProperty(r,"prototype",{writable:!1}),r}function Zt(r,t,s){return t=Me(t),Jt(r,ut()?Reflect.construct(t,s||[],Me(r).constructor):t.apply(r,s))}function Jt(r,t){if(t&&(ve(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Qt(r)}function Qt(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function ut(){try{var r=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(ut=function(){return!!r})()}function Me(r){return Me=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(s){return s.__proto__||Object.getPrototypeOf(s)},Me(r)}function er(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),t&&Be(r,t)}function Be(r,t){return Be=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,i){return a.__proto__=i,a},Be(r,t)}function mt(r,t,s){return t=ht(t),t in r?Object.defineProperty(r,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):r[t]=s,r}function ht(r){var t=tr(r,"string");return ve(t)=="symbol"?t:t+""}function tr(r,t){if(ve(r)!="object"||!r)return r;var s=r[Symbol.toPrimitive];if(s!==void 0){var a=s.call(r,t);if(ve(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(r)}var Te=function(r){function t(){return qt(this,t),Zt(this,t,arguments)}return er(t,r),Xt(t,[{key:"render",value:function(){return null}}])}(S.Component);mt(Te,"displayName","ZAxis");mt(Te,"defaultProps",{zAxisId:0,range:[64,64],scale:"auto",type:"number"});var rr=["option","isActive"];function we(){return we=Object.assign?Object.assign.bind():function(r){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(r[a]=s[a])}return r},we.apply(this,arguments)}function ar(r,t){if(r==null)return{};var s=sr(r,t),a,i;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);for(i=0;i<l.length;i++)a=l[i],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(r,a)&&(s[a]=r[a])}return s}function sr(r,t){if(r==null)return{};var s={};for(var a in r)if(Object.prototype.hasOwnProperty.call(r,a)){if(t.indexOf(a)>=0)continue;s[a]=r[a]}return s}function or(r){var t=r.option,s=r.isActive,a=ar(r,rr);return typeof t=="string"?S.createElement(We,we({option:S.createElement(Nt,we({type:t},a)),isActive:s,shapeType:"symbols"},a)):S.createElement(We,we({option:t,isActive:s,shapeType:"symbols"},a))}function je(r){"@babel/helpers - typeof";return je=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},je(r)}function Ae(){return Ae=Object.assign?Object.assign.bind():function(r){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(r[a]=s[a])}return r},Ae.apply(this,arguments)}function qe(r,t){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(r);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),s.push.apply(s,a)}return s}function z(r){for(var t=1;t<arguments.length;t++){var s=arguments[t]!=null?arguments[t]:{};t%2?qe(Object(s),!0).forEach(function(a){ae(r,a,s[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(s)):qe(Object(s)).forEach(function(a){Object.defineProperty(r,a,Object.getOwnPropertyDescriptor(s,a))})}return r}function nr(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function He(r,t){for(var s=0;s<t.length;s++){var a=t[s];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(r,ft(a.key),a)}}function ir(r,t,s){return t&&He(r.prototype,t),s&&He(r,s),Object.defineProperty(r,"prototype",{writable:!1}),r}function lr(r,t,s){return t=ke(t),cr(r,pt()?Reflect.construct(t,s||[],ke(r).constructor):t.apply(r,s))}function cr(r,t){if(t&&(je(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return dr(r)}function dr(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function pt(){try{var r=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(pt=function(){return!!r})()}function ke(r){return ke=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(s){return s.__proto__||Object.getPrototypeOf(s)},ke(r)}function ur(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),t&&Fe(r,t)}function Fe(r,t){return Fe=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,i){return a.__proto__=i,a},Fe(r,t)}function ae(r,t,s){return t=ft(t),t in r?Object.defineProperty(r,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):r[t]=s,r}function ft(r){var t=mr(r,"string");return je(t)=="symbol"?t:t+""}function mr(r,t){if(je(r)!="object"||!r)return r;var s=r[Symbol.toPrimitive];if(s!==void 0){var a=s.call(r,t);if(je(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(r)}var $e=function(r){function t(){var s;nr(this,t);for(var a=arguments.length,i=new Array(a),l=0;l<a;l++)i[l]=arguments[l];return s=lr(this,t,[].concat(i)),ae(s,"state",{isAnimationFinished:!1}),ae(s,"handleAnimationEnd",function(){s.setState({isAnimationFinished:!0})}),ae(s,"handleAnimationStart",function(){s.setState({isAnimationFinished:!1})}),ae(s,"id",Qe("recharts-scatter-")),s}return ur(t,r),ir(t,[{key:"renderSymbolsStatically",value:function(a){var i=this,l=this.props,p=l.shape,d=l.activeShape,g=l.activeIndex,f=X(this.props,!1);return a.map(function(c,h){var o=g===h,v=o?d:p,m=z(z({},f),c);return S.createElement(B,Ae({className:"recharts-scatter-symbol",key:"symbol-".concat(c==null?void 0:c.cx,"-").concat(c==null?void 0:c.cy,"-").concat(c==null?void 0:c.size,"-").concat(h)},Ct(i.props,c,h),{role:"img"}),S.createElement(or,Ae({option:v,isActive:o,key:"symbol-".concat(h)},m)))})}},{key:"renderSymbolsWithAnimation",value:function(){var a=this,i=this.props,l=i.points,p=i.isAnimationActive,d=i.animationBegin,g=i.animationDuration,f=i.animationEasing,c=i.animationId,h=this.state.prevPoints;return S.createElement(Je,{begin:d,duration:g,isActive:p,easing:f,from:{t:0},to:{t:1},key:"pie-".concat(c),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(o){var v=o.t,m=l.map(function(n,u){var x=h&&h[u];if(x){var j=K(x.cx,n.cx),y=K(x.cy,n.cy),b=K(x.size,n.size);return z(z({},n),{},{cx:j(v),cy:y(v),size:b(v)})}var w=K(0,n.size);return z(z({},n),{},{size:w(v)})});return S.createElement(B,null,a.renderSymbolsStatically(m))})}},{key:"renderSymbols",value:function(){var a=this.props,i=a.points,l=a.isAnimationActive,p=this.state.prevPoints;return l&&i&&i.length&&(!p||!Ie(p,i))?this.renderSymbolsWithAnimation():this.renderSymbolsStatically(i)}},{key:"renderErrorBar",value:function(){var a=this.props.isAnimationActive;if(a&&!this.state.isAnimationFinished)return null;var i=this.props,l=i.points,p=i.xAxis,d=i.yAxis,g=i.children,f=tt(g,wt);return f?f.map(function(c,h){var o=c.props,v=o.direction,m=o.dataKey;return S.cloneElement(c,{key:"".concat(v,"-").concat(m,"-").concat(l[h]),data:l,xAxis:p,yAxis:d,layout:v==="x"?"vertical":"horizontal",dataPointFormatter:function(u,x){return{x:u.cx,y:u.cy,value:v==="x"?+u.node.x:+u.node.y,errorVal:he(u,x)}}})}):null}},{key:"renderLine",value:function(){var a=this.props,i=a.points,l=a.line,p=a.lineType,d=a.lineJointType,g=X(this.props,!1),f=X(l,!1),c,h;if(p==="joint")c=i.map(function(y){return{x:y.cx,y:y.cy}});else if(p==="fitting"){var o=At(i),v=o.xmin,m=o.xmax,n=o.a,u=o.b,x=function(b){return n*b+u};c=[{x:v,y:x(v)},{x:m,y:x(m)}]}var j=z(z(z({},g),{},{fill:"none",stroke:g&&g.fill},f),{},{points:c});return S.isValidElement(l)?h=S.cloneElement(l,j):Re(l)?h=l(j):h=S.createElement(De,Ae({},j,{type:d})),S.createElement(B,{className:"recharts-scatter-line",key:"recharts-scatter-line"},h)}},{key:"render",value:function(){var a=this.props,i=a.hide,l=a.points,p=a.line,d=a.className,g=a.xAxis,f=a.yAxis,c=a.left,h=a.top,o=a.width,v=a.height,m=a.id,n=a.isAnimationActive;if(i||!l||!l.length)return null;var u=this.state.isAnimationFinished,x=Ue("recharts-scatter",d),j=g&&g.allowDataOverflow,y=f&&f.allowDataOverflow,b=j||y,w=re(m)?this.id:m;return S.createElement(B,{className:x,clipPath:b?"url(#clipPath-".concat(w,")"):null},j||y?S.createElement("defs",null,S.createElement("clipPath",{id:"clipPath-".concat(w)},S.createElement("rect",{x:j?c:c-o/2,y:y?h:h-v/2,width:j?o:o*2,height:y?v:v*2}))):null,p&&this.renderLine(),this.renderErrorBar(),S.createElement(B,{key:"recharts-scatter-symbols"},this.renderSymbols()),(!n||u)&&T.renderCallByParent(this.props,l))}}],[{key:"getDerivedStateFromProps",value:function(a,i){return a.animationId!==i.prevAnimationId?{prevAnimationId:a.animationId,curPoints:a.points,prevPoints:i.curPoints}:a.points!==i.curPoints?{curPoints:a.points}:null}}])}(N.PureComponent);ae($e,"displayName","Scatter");ae($e,"defaultProps",{xAxisId:0,yAxisId:0,zAxisId:0,legendType:"circle",lineType:"joint",lineJointType:"linear",data:[],shape:"circle",hide:!1,isAnimationActive:!et.isSsr,animationBegin:0,animationDuration:400,animationEasing:"linear"});ae($e,"getComposedData",function(r){var t=r.xAxis,s=r.yAxis,a=r.zAxis,i=r.item,l=r.displayedData,p=r.xAxisTicks,d=r.yAxisTicks,g=r.offset,f=i.props.tooltipType,c=tt(i.props.children,rt),h=re(t.dataKey)?i.props.dataKey:t.dataKey,o=re(s.dataKey)?i.props.dataKey:s.dataKey,v=a&&a.dataKey,m=a?a.range:Te.defaultProps.range,n=m&&m[0],u=t.scale.bandwidth?t.scale.bandwidth():0,x=s.scale.bandwidth?s.scale.bandwidth():0,j=l.map(function(y,b){var w=he(y,h),C=he(y,o),A=!re(v)&&he(y,v)||"-",P=[{name:re(t.dataKey)?i.props.name:t.name||t.dataKey,unit:t.unit||"",value:w,payload:y,dataKey:h,type:f},{name:re(s.dataKey)?i.props.name:s.name||s.dataKey,unit:s.unit||"",value:C,payload:y,dataKey:o,type:f}];A!=="-"&&P.push({name:a.name||a.dataKey,unit:a.unit||"",value:A,payload:y,dataKey:v,type:f});var D=Ee({axis:t,ticks:p,bandSize:u,entry:y,index:b,dataKey:h}),R=Ee({axis:s,ticks:d,bandSize:x,entry:y,index:b,dataKey:o}),E=A!=="-"?a.scale(A):n,O=Math.sqrt(Math.max(E,0)/Math.PI);return z(z({},y),{},{cx:D,cy:R,x:D-O,y:R-O,xAxis:t,yAxis:s,zAxis:a,width:2*O,height:2*O,size:E,node:{x:w,y:C,z:A},tooltipPayload:P,tooltipPosition:{x:D,y:R},payload:y},c&&c[b]&&c[b].props)});return z({points:j},g)});var de=at({chartName:"BarChart",GraphicalChild:_,defaultTooltipEventType:"axis",validateTooltipEventTypes:["axis","item"],axisComponents:[{axisType:"xAxis",AxisComp:Y},{axisType:"yAxis",AxisComp:q}],formatAxisMap:st}),hr=at({chartName:"ComposedChart",GraphicalChild:[ot,ce,_,$e],axisComponents:[{axisType:"xAxis",AxisComp:Y},{axisType:"yAxis",AxisComp:q},{axisType:"zAxis",AxisComp:Te}],formatAxisMap:st});/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pr=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]],fr=St("Clock",pr),ie={count:{label:"Reportes"},abierto:{label:"ABIERTO",color:"#ef4444"},cerrado:{label:"CERRADO",color:"#22c55e"}};function xr({data:r=[]}){const t=N.useMemo(()=>{const i={abierto:0,cerrado:0};r.forEach(d=>{var f;const g=(f=d.estadoReporte)==null?void 0:f.toLowerCase();g==="cerrado"||g==="finalizado"?i.cerrado++:i.abierto++});const l=i.abierto+i.cerrado,p=l>0?(i.cerrado/l*100).toFixed(2):"0.00";return{...i,total:l,closureRate:parseFloat(p)}},[r]),s=N.useMemo(()=>[{status:"abierto",count:t.abierto,fill:ie.abierto.color},{status:"cerrado",count:t.cerrado,fill:ie.cerrado.color}].filter(l=>l.count>0),[t]),a=N.useMemo(()=>{var l;if(s.length===0)return"";const i=s.reduce((p,d)=>d.count>p.count?d:p,s[0]);return((l=ie[i.status])==null?void 0:l.label)||""},[s]);return e.jsxs(M,{className:"col-span-full lg:col-span-2 border shadow-sm",children:[e.jsxs(U,{className:"pb-2",children:[e.jsxs(W,{className:"flex items-center gap-2 text-foreground text-lg",children:[e.jsx(Le,{className:"h-4 w-4 text-primary"}),"Resumen de Reportes"]}),e.jsx(V,{className:"text-muted-foreground text-sm",children:"Vista general del estado y distribución de reportes"})]}),e.jsx(k,{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx(M,{className:"border-border/30 bg-card hover:shadow-sm transition-shadow duration-200",children:e.jsx(k,{className:"p-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground",children:"Total"}),e.jsx("p",{className:"text-xl font-bold text-foreground",children:t.total})]}),e.jsx("div",{className:"rounded-md bg-muted/50 p-1.5",children:e.jsx(Le,{className:"h-4 w-4 text-muted-foreground"})})]})})}),e.jsx(M,{className:"border-border/30 bg-card hover:shadow-sm transition-shadow duration-200",children:e.jsx(k,{className:"p-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground",children:"Cerrados"}),e.jsx("p",{className:"text-xl font-bold text-foreground",children:t.cerrado})]}),e.jsx("div",{className:"rounded-md bg-emerald-100/50 p-1.5",children:e.jsx(Pt,{className:"h-4 w-4 text-emerald-600"})})]})})}),e.jsx(M,{className:"border-border/30 bg-card hover:shadow-sm transition-shadow duration-200",children:e.jsx(k,{className:"p-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground",children:"Abiertos"}),e.jsx("p",{className:"text-xl font-bold text-foreground",children:t.abierto})]}),e.jsx("div",{className:"rounded-md bg-red-100/50 p-1.5",children:e.jsx(fr,{className:"h-4 w-4 text-red-600"})})]})})}),e.jsx(M,{className:"border-border/30 bg-card hover:shadow-sm transition-shadow duration-200",children:e.jsx(k,{className:"p-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground",children:"% Cierre"}),e.jsxs("p",{className:"text-xl font-bold text-foreground",children:[t.closureRate,"%"]})]}),e.jsx("div",{className:"rounded-md bg-violet-100/50 p-1.5",children:e.jsx(G,{className:"h-4 w-4 text-violet-600"})})]})})})]}),e.jsx(M,{className:"border-border/30 bg-card",children:e.jsxs(k,{className:"p-3 space-y-3",children:[e.jsx("h4",{className:"text-xs font-semibold text-foreground",children:"Desglose por Estado"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{className:"flex flex-col items-center p-2 bg-muted/30 rounded-md border border-border/20 hover:bg-muted/50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[e.jsx("div",{className:"w-2 h-2 rounded-full",style:{backgroundColor:ie.abierto.color}}),e.jsx("span",{className:"text-xs font-medium text-foreground",children:"Abierto"})]}),e.jsx("span",{className:"text-sm font-bold text-foreground",children:t.abierto})]}),e.jsxs("div",{className:"flex flex-col items-center p-2 bg-muted/30 rounded-md border border-border/20 hover:bg-muted/50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[e.jsx("div",{className:"w-2 h-2 rounded-full",style:{backgroundColor:ie.cerrado.color}}),e.jsx("span",{className:"text-xs font-medium text-foreground",children:"Cerrado"})]}),e.jsx("span",{className:"text-sm font-bold text-foreground",children:t.cerrado})]})]})]})})]}),e.jsxs("div",{className:"flex flex-col space-y-3",children:[e.jsxs("div",{className:"text-center space-y-1",children:[e.jsx("h3",{className:"text-base font-semibold text-foreground",children:"Distribución por Estado"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Representación visual de los estados"})]}),s.length>0?e.jsxs("div",{className:"space-y-3",children:[e.jsx(Z,{config:ie,className:"mx-auto aspect-square max-h-[250px] [&_.recharts-pie-label-text]:fill-background",children:e.jsxs(Dt,{children:[e.jsx(J,{cursor:!1,content:({active:i,payload:l})=>{var p;if(i&&l&&l.length){const d=l[0].payload,g=t.total>0?(d.count/t.total*100).toFixed(2):"0.00";return e.jsx(M,{className:"border-border/50 shadow-lg",children:e.jsx(k,{className:"p-3",children:e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground uppercase tracking-wide",children:(p=ie[d.status])==null?void 0:p.label}),e.jsxs("p",{className:"text-sm font-bold text-foreground",children:[d.count," reportes (",g,"%)"]})]})})})}return null}}),e.jsx(Rt,{data:s,dataKey:"count",nameKey:"status",innerRadius:60,outerRadius:120,paddingAngle:0,stroke:"hsl(var(--background))",strokeWidth:2,children:e.jsx(T,{dataKey:"count",className:"fill-background font-bold drop-shadow-sm",stroke:"hsl(var(--foreground))",strokeWidth:.3,fontSize:13,formatter:i=>{if(t.total===0)return"0";const l=(i/t.total*100).toFixed(2);return i>0?`${i}
${l}%`:""}})})]})}),e.jsx(M,{className:"border-border/30 bg-muted/20",children:e.jsxs(k,{className:"p-3 text-center space-y-1",children:[e.jsx("div",{className:"flex items-center justify-center gap-2 text-xs font-medium text-foreground",children:e.jsxs("span",{className:"inline-flex items-center gap-1",children:[a," es el estado más común",e.jsx(G,{className:"h-3 w-3 text-primary"})]})}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Análisis de ",t.total," reportes en total"]})]})})]}):e.jsx(M,{className:"border-dashed border-2 border-border/30",children:e.jsx(k,{className:"flex items-center justify-center h-48 text-muted-foreground",children:e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx(Le,{className:"h-8 w-8 mx-auto opacity-40"}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm font-medium",children:"No hay datos disponibles"}),e.jsx("p",{className:"text-xs text-muted-foreground/70",children:"Los reportes aparecerán aquí cuando estén disponibles"})]})]})})})]})]})})]})}const gr={count:{label:"Reportes Cerrados"},percentage:{label:"Línea %",color:"#dc2626"},cerrados:{label:"CERRADOS",color:"hsl(var(--chart-3))"}};function br({data:r=[]}){const[t,s]=N.useState("month"),[a,i]=N.useState("percentage"),l=N.useMemo(()=>{const f={};r.forEach(h=>{var m,n;const o=new Date(h.fechaEvento),v=t==="month"?`${o.getFullYear()}-${String(o.getMonth()+1).padStart(2,"0")}`:`${o.getFullYear()}`;f[v]||(f[v]={total:0,cerrados:0}),f[v].total++,(((m=h.estadoReporte)==null?void 0:m.toLowerCase())==="cerrado"||((n=h.estadoReporte)==null?void 0:n.toLowerCase())==="finalizado")&&f[v].cerrados++});const c=[];if(r.length===0){const h=new Date;if(t==="month")for(let o=5;o>=0;o--){const v=new Date(h.getFullYear(),h.getMonth()-o,1),m=`${v.getFullYear()}-${String(v.getMonth()+1).padStart(2,"0")}`;c.push(m)}else for(let o=4;o>=0;o--){const v=h.getFullYear()-o;c.push(v.toString())}}else{const h=r.map(m=>new Date(m.fechaEvento)),o=new Date(Math.min(...h.map(m=>m.getTime()))),v=new Date(Math.max(...h.map(m=>m.getTime())));if(t==="month"){const m=new Date(o.getFullYear(),o.getMonth(),1),n=new Date(v.getFullYear(),v.getMonth(),1),u=new Date(m);for(;u<=n;){const x=`${u.getFullYear()}-${String(u.getMonth()+1).padStart(2,"0")}`;c.push(x),u.setMonth(u.getMonth()+1)}}else for(let m=o.getFullYear();m<=v.getFullYear();m++)c.push(m.toString())}return c.map(h=>{const o=f[h]||{total:0,cerrados:0},v=o.total>0?o.cerrados/o.total*100:0;let m;if(t==="month"){const[n,u]=h.split("-");m=new Date(parseInt(n),parseInt(u)-1,1).toLocaleDateString("es-ES",{month:"short",year:"2-digit"})}else m=h;return{period:m,count:o.cerrados,percentage:v,label:`${o.cerrados}/${o.total} (${v.toFixed(2)}%)`,fill:"var(--color-cerrados)"}})},[r,t]),p=N.useMemo(()=>{let f=0,c=0;return l.forEach((h,o)=>{h.count>f&&(f=h.count,c=o)}),c},[l]),d=N.useMemo(()=>l.reduce((f,c)=>f+c.count,0),[l]),g=N.useMemo(()=>{if(l.length===0)return 0;const f=l.reduce((o,v)=>o+v.count,0),c=l.reduce((o,v)=>{const m=v.label.match(/(\d+)\/(\d+)/);return o+(m?parseInt(m[2]):0)},0);return(c>0?f/c*100:0).toFixed(2)},[l]);return e.jsxs(M,{children:[e.jsxs(U,{children:[e.jsx(W,{children:"Reportes Abiertos y Porcentaje de Cierre por Fecha"}),e.jsx(V,{children:"Reportes abiertos y porcentaje de cierre por fecha"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(pe,{value:t,onValueChange:f=>s(f),children:[e.jsx(fe,{className:"w-32",children:e.jsx(xe,{})}),e.jsxs(ge,{children:[e.jsx(I,{value:"month",children:"Por Meses"}),e.jsx(I,{value:"year",children:"Por Años"})]})]}),e.jsxs(pe,{value:a,onValueChange:f=>i(f),children:[e.jsx(fe,{className:"w-32",children:e.jsx(xe,{})}),e.jsxs(ge,{children:[e.jsx(I,{value:"percentage",children:"Línea %"}),e.jsx(I,{value:"value",children:"Línea Valor"})]})]})]})]}),e.jsx(k,{children:e.jsx(Z,{config:gr,className:"h-full w-full",children:e.jsxs(hr,{accessibilityLayer:!0,data:l,margin:{top:30},children:[e.jsx(ne,{vertical:!0,horizontal:!1}),e.jsx(Y,{dataKey:"period",tickLine:!1,tickMargin:10,axisLine:!1}),e.jsx(q,{hide:!0}),e.jsx(J,{cursor:!1,content:e.jsx(Ge,{})}),e.jsx(_,{dataKey:"count",strokeWidth:2,radius:8,activeIndex:p,activeBar:({...f})=>e.jsx(nt,{...f,fillOpacity:.8,stroke:f.payload.fill,strokeDasharray:4,strokeDashoffset:4}),children:e.jsx(T,{dataKey:"label",position:"top",offset:12,className:"fill-foreground",fontSize:11})}),e.jsx(ot,{type:"linear",dataKey:a==="percentage"?"percentage":"count",stroke:"#dc2626",strokeWidth:3,dot:{r:6,fill:"#dc2626"},activeDot:{r:8,stroke:"#dc2626",strokeWidth:2,fill:"#dc2626"}})]})})}),e.jsxs(oe,{className:"flex-col items-start gap-2 text-sm",children:[e.jsxs("div",{className:"flex gap-2 leading-none font-medium",children:["Promedio de cierre: ",g,"% ",e.jsx(G,{className:"h-4 w-4"})]}),e.jsxs("div",{className:"text-muted-foreground leading-none",children:["Total de ",d," reportes cerrados"]})]})]})}const vr={cerrados:{label:"Reportes Cerrados",color:"#3b82f6"},label:{color:"var(--background)"}};function jr({data:r=[]}){const[t,s]=N.useState("desc"),a=N.useMemo(()=>{const g={};r.forEach(c=>{var h,o;if(c.nombreGerencia){const v=c.nombreGerencia;g[v]||(g[v]={total:0,cerrados:0}),g[v].total++,(((h=c.estadoReporte)==null?void 0:h.toLowerCase())==="cerrado"||((o=c.estadoReporte)==null?void 0:o.toLowerCase())==="finalizado")&&g[v].cerrados++}});const f=["#dbeafe","#bfdbfe","#93c5fd","#60a5fa","#3b82f6","#2563eb","#1d4ed8","#1e40af"];return Object.entries(g).map(([c,h],o)=>({gerencia:(c.length>15,c),fullGerencia:c,cerrados:h.cerrados,total:h.total,ratio:`${h.cerrados}/${h.total}`,percentage:h.total>0?(h.cerrados/h.total*100).toFixed(1):"0",fill:f[o%f.length]})).sort((c,h)=>t==="desc"?h.cerrados-c.cerrados:c.cerrados-h.cerrados).slice(0,8)},[r,t]),i=N.useMemo(()=>r.filter(g=>{var f;return((f=g.estadoReporte)==null?void 0:f.toLowerCase())==="cerrado"}).length,[r]),l=N.useMemo(()=>r.length,[r]),p=N.useMemo(()=>a.length>0?a[0]:null,[a]),d=l>0?(i/l*100).toFixed(1):0;return e.jsxs(M,{children:[e.jsxs(U,{children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx(W,{children:"Reportes Cerrados por Gerencia"}),e.jsx(V,{children:"Cantidad de reportes cerrados por cada gerencia"})]})}),e.jsxs(pe,{value:t,onValueChange:g=>s(g),children:[e.jsx(fe,{className:"w-[180px]",children:e.jsx(xe,{placeholder:"Ordenar por"})}),e.jsxs(ge,{children:[e.jsx(I,{value:"desc",children:"Descendente"}),e.jsx(I,{value:"asc",children:"Ascendente"})]})]})]}),e.jsx(k,{children:e.jsx(Z,{config:vr,className:"h-full w-full",children:e.jsxs(de,{accessibilityLayer:!0,data:a,layout:"vertical",margin:{right:50},children:[e.jsx(ne,{horizontal:!1}),e.jsx(q,{dataKey:"gerencia",type:"category",tickLine:!1,tickMargin:10,axisLine:!1,hide:!0}),e.jsx(Y,{dataKey:"cerrados",type:"number",hide:!0}),e.jsx(J,{cursor:!1,content:e.jsx(Ge,{indicator:"line"})}),e.jsxs(_,{dataKey:"cerrados",layout:"vertical",radius:4,children:[e.jsx(T,{dataKey:"gerencia",position:"insideLeft",offset:8,className:"fill-white",fontSize:12,fontWeight:"bold"}),e.jsx(T,{dataKey:"ratio",position:"right",offset:8,className:"fill-foreground",fontSize:12,fontWeight:"bold"})]})]})})}),e.jsxs(oe,{className:"flex-col items-start gap-2 text-sm",children:[e.jsxs("div",{className:"flex gap-2 leading-none font-medium",children:[p&&`${p.fullGerencia} lidera: ${p.ratio} (${p.percentage}%)`," ",e.jsx(G,{className:"h-4 w-4"})]}),e.jsxs("div",{className:"text-muted-foreground leading-none",children:["Total: ",i,"/",l," reportes cerrados (",d,"%)"]})]})]})}const yr={cerrados:{label:"Reportes Cerrados",color:"#10b981"},label:{color:"var(--background)"}};function Nr({data:r=[]}){const[t,s]=N.useState(0),[a,i]=N.useState(""),l=10;N.useEffect(()=>{s(0)},[a]);const p=N.useMemo(()=>{const n={};r.forEach(y=>{var A;const b=y.idUsuarioCierre||"sin-id",w=y.nombreUsuarioCierre||"Sin encargado de cierre",C=`${b}-${w}`;n[C]||(n[C]={cerrados:0,noCerrados:0,total:0,idUsuario:b,nombre:w}),n[C].total+=1,((A=y.estadoReporte)==null?void 0:A.toLowerCase())==="cerrado"?n[C].cerrados+=1:n[C].noCerrados+=1});const u=Object.entries(n).sort(([,y],[,b])=>b.cerrados-y.cerrados),x=u.length,j=(y,b)=>{const w=y/Math.max(b-1,1),C=127,A=29,P=29,D=254,R=242,E=242,O=Math.round(C+(D-C)*w),L=Math.round(A+(R-A)*w),Q=Math.round(P+(E-P)*w);return`rgb(${O}, ${L}, ${Q})`};return u.map(([y,b],w)=>({responsable:b.nombre.length>10?b.nombre.substring(0,10)+"...":b.nombre,fullResponsable:b.nombre,idUsuario:b.idUsuario,cerrados:b.cerrados,noCerrados:b.noCerrados,total:b.total,ratio:`${b.cerrados}/${b.total}`,porcentaje:b.total>0?Math.round(b.cerrados/b.total*100):0,fill:j(w,x),globalRank:w+1}))},[r]),d=N.useMemo(()=>a.trim()?p.filter(n=>n.fullResponsable.toLowerCase().includes(a.toLowerCase())):p,[p,a]),g=N.useMemo(()=>{const n=t*l;return d.slice(n,n+l).map(u=>({...u,fill:u.fill}))},[d,t]),f=Math.ceil(d.length/l),c=N.useMemo(()=>p.reduce((n,u)=>n+u.cerrados,0),[p]),h=N.useMemo(()=>p.reduce((n,u)=>n+u.total,0),[p]),o=N.useMemo(()=>p.length>0?p[0]:null,[p]),v=N.useMemo(()=>{const n=p.find(u=>u.idUsuario==="sin-id");return n?n.total:0},[p]),m=({active:n,payload:u,label:x})=>{if(n&&u&&u.length){const j=u[0].payload;return e.jsxs("div",{className:"bg-background border-border rounded-lg border p-3 shadow-lg",children:[e.jsx("p",{className:"text-foreground font-semibold",children:j.fullResponsable}),e.jsxs("p",{className:"text-muted-foreground text-xs",children:["ID: ",j.idUsuario]}),e.jsxs("p",{className:"text-muted-foreground text-sm",children:["Cerrados: ",j.cerrados," de ",j.total," (",j.porcentaje,"%)"]})]})}return null};return e.jsxs(M,{children:[e.jsx(U,{children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx(W,{children:"Responsable de Cierre"}),e.jsxs(V,{children:[a?e.jsxs(e.Fragment,{children:["Encontrados ",d.length," responsables • "]}):null,"Mostrando ",t*l+1,"-",Math.min((t+1)*l,d.length)," de"," ",d.length," responsables"]})]}),f>1&&e.jsxs("div",{className:"flex gap-2",children:[e.jsx($,{variant:"outline",size:"sm",onClick:()=>s(n=>Math.max(0,n-1)),disabled:t===0,children:e.jsx(ye,{className:"h-4 w-4"})}),e.jsxs("span",{className:"flex items-center px-2 text-sm",children:[t+1," / ",f]}),e.jsx($,{variant:"outline",size:"sm",onClick:()=>s(n=>Math.min(f-1,n+1)),disabled:t===f-1,children:e.jsx(Ne,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"relative max-w-sm",children:[e.jsx(Ce,{className:"text-muted-foreground absolute top-2.5 left-2 h-4 w-4"}),e.jsx(se,{placeholder:"Buscar responsable...",value:a,onChange:n=>i(n.target.value),className:"pl-8"})]})]})}),e.jsx(k,{children:e.jsx(Z,{config:yr,className:"h-full w-full",children:e.jsxs(de,{data:g,layout:"vertical",margin:{left:0,right:80,top:0,bottom:0},children:[e.jsx(ne,{horizontal:!1}),e.jsx(q,{dataKey:"responsable",type:"category",tickLine:!1,tickMargin:0,axisLine:!1,width:75,tick:{fontSize:11,fill:"var(--foreground)"}}),e.jsx(Y,{dataKey:"cerrados",type:"number",hide:!0}),e.jsx(J,{cursor:!1,content:e.jsx(m,{})}),e.jsx(_,{dataKey:"cerrados",layout:"vertical",radius:4,children:e.jsx(T,{dataKey:"ratio",position:"right",offset:8,className:"fill-foreground",fontSize:11,fontWeight:"bold"})})]})})}),e.jsxs(oe,{className:"flex-col items-start gap-2 text-sm",children:[e.jsxs("div",{className:"flex gap-2 leading-none font-medium",children:[o&&`${o.fullResponsable} lidera con ${o.ratio} reportes (${o.porcentaje}%)`,e.jsx(G,{className:"h-4 w-4"})]}),e.jsxs("div",{className:"text-muted-foreground leading-none",children:["Total: ",c,"/",h," reportes cerrados (",Math.round(c/h*100),"%) • Sin encargado:"," ",v]})]})]})}const Cr={cerrados:{label:"Reportes Cerrados",color:"#10b981"},label:{color:"var(--background)"}};function wr({data:r=[]}){const[t,s]=N.useState(0),[a,i]=N.useState(""),[l,p]=N.useState("reporta"),d=10;N.useEffect(()=>{s(0)},[a,l]);const g=N.useMemo(()=>{const x={};r.forEach(w=>{var D;const C=l==="reporta"?w.idEmpresaReporta:w.idEmpresaReportada,A=l==="reporta"?w.nombreEmpresaReporta:w.nombreEmpresaReportada,P=`${C}-${A}`;x[P]||(x[P]={cerrados:0,noCerrados:0,total:0,idEmpresa:C||"sin-id",nombre:A||"Sin empresa"}),x[P].total+=1,((D=w.estadoReporte)==null?void 0:D.toLowerCase())==="cerrado"?x[P].cerrados+=1:x[P].noCerrados+=1});const j=Object.entries(x).sort(([,w],[,C])=>C.cerrados-w.cerrados),y=j.length,b=(w,C)=>{const A=w/Math.max(C-1,1),P=127,D=29,R=29,E=254,O=242,L=242,Q=Math.round(P+(E-P)*A),Pe=Math.round(D+(O-D)*A),ue=Math.round(R+(L-R)*A);return`rgb(${Q}, ${Pe}, ${ue})`};return j.map(([w,C],A)=>({empresa:C.nombre.length>15?C.nombre.substring(0,15)+"...":C.nombre,fullEmpresa:C.nombre,idEmpresa:C.idEmpresa,cerrados:C.cerrados,noCerrados:C.noCerrados,total:C.total,ratio:`${C.cerrados}/${C.total}`,porcentaje:C.total>0?Math.round(C.cerrados/C.total*100):0,fill:b(A,y),globalRank:A+1}))},[r,l]),f=N.useMemo(()=>a.trim()?g.filter(x=>x.fullEmpresa.toLowerCase().includes(a.toLowerCase())):g,[g,a]),c=N.useMemo(()=>{const x=t*d;return f.slice(x,x+d).map(j=>({...j,fill:j.fill}))},[f,t]),h=Math.ceil(f.length/d),o=N.useMemo(()=>g.reduce((x,j)=>x+j.cerrados,0),[g]),v=N.useMemo(()=>g.reduce((x,j)=>x+j.total,0),[g]),m=N.useMemo(()=>g.length>0?g[0]:null,[g]),n=N.useMemo(()=>{const x=g.find(j=>j.idEmpresa==="sin-id");return x?x.total:0},[g]),u=({active:x,payload:j,label:y})=>{if(x&&j&&j.length){const b=j[0].payload;return e.jsxs("div",{className:"bg-background border-border rounded-lg border p-3 shadow-lg",children:[e.jsx("p",{className:"text-foreground font-semibold",children:b.fullEmpresa}),e.jsxs("p",{className:"text-muted-foreground text-xs",children:["ID: ",b.idEmpresa]}),e.jsxs("p",{className:"text-muted-foreground text-sm",children:["Cerrados: ",b.cerrados," de ",b.total," (",b.porcentaje,"%)"]})]})}return null};return e.jsxs(M,{children:[e.jsx(U,{children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx(W,{children:l==="reporta"?"Reportes Abiertos por Empresa":"Reportes por Empresa Encargada de Cierre"}),e.jsxs(V,{className:"w-[300px]",children:[l==="reporta"?"Muestra todos los reportes abiertos por cada empresa y cuántos han sido cerrados":"Muestra los reportes asignados a cada empresa encargada de cierre y cuántos han cerrado",a&&e.jsxs(e.Fragment,{children:[" • Encontradas ",f.length," empresas"]}),e.jsx("br",{}),"Mostrando ",t*d+1,"-",Math.min((t+1)*d,f.length)," de"," ",f.length," empresas"]})]}),h>1&&e.jsxs("div",{className:"flex gap-2",children:[e.jsx($,{variant:"outline",size:"sm",onClick:()=>s(x=>Math.max(0,x-1)),disabled:t===0,children:e.jsx(ye,{className:"h-4 w-4"})}),e.jsxs("span",{className:"flex items-center px-2 text-sm",children:[t+1," / ",h]}),e.jsx($,{variant:"outline",size:"sm",onClick:()=>s(x=>Math.min(h-1,x+1)),disabled:t===h-1,children:e.jsx(Ne,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{className:"relative max-w-sm flex-1",children:[e.jsx(Ce,{className:"text-muted-foreground absolute top-2.5 left-2 h-4 w-4"}),e.jsx(se,{placeholder:"Buscar empresa...",value:a,onChange:x=>i(x.target.value),className:"pl-8"})]}),e.jsxs(pe,{value:l,onValueChange:x=>p(x),children:[e.jsx(fe,{className:"w-[260px]",children:e.jsx(xe,{})}),e.jsxs(ge,{children:[e.jsx(I,{value:"reporta",children:e.jsx("div",{className:"flex flex-col",children:e.jsx("span",{children:"Empresa que Reporta"})})}),e.jsx(I,{value:"reportada",children:e.jsx("div",{className:"flex flex-col",children:e.jsx("span",{children:"Empresa Encargada de Cierre"})})})]})]})]})]})}),e.jsx(k,{children:e.jsx(Z,{config:Cr,className:"h-full w-full",children:e.jsxs(de,{data:c,layout:"vertical",margin:{left:0,right:80,top:0,bottom:0},children:[e.jsx(ne,{horizontal:!1}),e.jsx(q,{dataKey:"empresa",type:"category",tickLine:!1,tickMargin:0,axisLine:!1,width:120,tick:{fontSize:11,fill:"var(--foreground)"}}),e.jsx(Y,{dataKey:"cerrados",type:"number",hide:!0}),e.jsx(J,{cursor:!1,content:e.jsx(u,{})}),e.jsx(_,{dataKey:"cerrados",layout:"vertical",radius:4,children:e.jsx(T,{dataKey:"ratio",position:"right",offset:8,className:"fill-foreground",fontSize:11,fontWeight:"bold"})})]})})}),e.jsxs(oe,{className:"flex-col items-start gap-2 text-sm",children:[e.jsxs("div",{className:"flex gap-2 leading-none font-medium",children:[m&&e.jsx(e.Fragment,{children:l==="reporta"?`${m.fullEmpresa} es quien más reporta con ${m.ratio} reportes (${m.porcentaje}% cerrados)`:`${m.fullEmpresa} tiene mejor tasa de cierre con ${m.ratio} reportes (${m.porcentaje}% cerrados)`}),e.jsx(G,{className:"h-4 w-4"})]}),e.jsxs("div",{className:"text-muted-foreground leading-none",children:[l==="reporta"?`Total de reportes abiertos: ${v} | Reportes cerrados: ${o} (${Math.round(o/v*100)}%)`:`Total de reportes asignados para cierre: ${v} | Reportes cerrados: ${o} (${Math.round(o/v*100)}%)`,n>0&&` • Sin empresa: ${n}`]})]})]})}const Ar={promedioDias:{label:"Días Promedio",color:"#f59e0b"},alto:{label:"Alto",color:"#dc2626"},medio:{label:"Medio",color:"#f59e0b"},bajo:{label:"Bajo",color:"#16a34a"}};function Pr({data:r=[]}){const t=N.useMemo(()=>{const d={};r.forEach(c=>{var h;if(((h=c.estadoReporte)==null?void 0:h.toLowerCase())==="cerrado"&&c.nivelGravedad&&c.fechaReporte&&c.reportClosedAt){const o=c.nivelGravedad.toLowerCase(),v=new Date(c.fechaReporte),n=new Date(c.reportClosedAt).getTime()-v.getTime(),u=Math.ceil(n/(1e3*60*60*24));d[o]||(d[o]={totalDias:0,cantidad:0}),d[o].totalDias+=u,d[o].cantidad+=1}});const g=["alto","medio","bajo"],f={alto:"#dc2626",medio:"#f59e0b",bajo:"#16a34a"};return g.filter(c=>d[c]).map(c=>{const h=d[c],o=h.cantidad>0?Math.round(h.totalDias/h.cantidad):0;return{gravedad:c.charAt(0).toUpperCase()+c.slice(1),promedioDias:o,cantidad:h.cantidad,fill:f[c],label:`${o} días (${h.cantidad} reportes)`}})},[r]),s=N.useMemo(()=>r.filter(d=>{var g;return((g=d.estadoReporte)==null?void 0:g.toLowerCase())==="cerrado"}).length,[r]),a=N.useMemo(()=>t.reduce((d,g)=>d+g.cantidad,0),[t]),i=N.useMemo(()=>{if(t.length===0)return 0;const d=t.reduce((g,f)=>g+f.promedioDias*f.cantidad,0);return Math.round(d/a)},[t,a]),l=N.useMemo(()=>{let d=0,g=0;return t.forEach((f,c)=>{f.promedioDias>d&&(d=f.promedioDias,g=c)}),g},[t]),p=N.useMemo(()=>t.reduce((d,g)=>g.promedioDias>d.promedioDias?g:d,t[0]||{gravedad:"",promedioDias:0}),[t]);return e.jsxs(M,{children:[e.jsxs(U,{children:[e.jsx(W,{children:"Días de Cierre Promedio por Nivel de Gravedad"}),e.jsx(V,{children:"Tiempo promedio de cierre según el nivel de gravedad del reporte"})]}),e.jsx(k,{children:e.jsx(Z,{config:Ar,className:"h-full w-full",children:e.jsxs(de,{accessibilityLayer:!0,data:t,margin:{top:30,right:30,left:20,bottom:20},children:[e.jsx(ne,{vertical:!1,horizontal:!0}),e.jsx(Y,{dataKey:"gravedad",tickLine:!1,tickMargin:10,axisLine:!1}),e.jsx(q,{hide:!0}),e.jsx(J,{cursor:!1,content:e.jsx(Ge,{formatter:(d,g,f)=>[`${d} días promedio`,`${f.payload.cantidad} reportes`]})}),e.jsx(_,{dataKey:"promedioDias",strokeWidth:2,radius:8,activeIndex:l,activeBar:({...d})=>e.jsx(nt,{...d,fillOpacity:.8,stroke:d.payload.fill,strokeDasharray:4,strokeDashoffset:4}),children:e.jsx(T,{dataKey:"label",position:"top",offset:12,className:"fill-foreground",fontSize:11})})]})})}),e.jsxs(oe,{className:"flex-col items-start gap-2 text-sm",children:[e.jsxs("div",{className:"flex gap-2 leading-none font-medium",children:[p.gravedad&&`Gravedad ${p.gravedad}: ${p.promedioDias} días promedio`," ",e.jsx(G,{className:"h-4 w-4"})]}),e.jsxs("div",{className:"text-muted-foreground leading-none",children:["Promedio general: ",i," días • ",s," reportes cerrados (",a," con datos completos para análisis)"]})]})]})}const Sr={cerrados:{label:"Reportes Cerrados",color:"#8b5cf6"},label:{color:"var(--background)"}};function Dr({data:r=[]}){const[t,s]=N.useState(0),[a,i]=N.useState(""),l=10;N.useEffect(()=>{s(0)},[a]);const p=N.useMemo(()=>{const n={};r.forEach(y=>{var A;const b=y.idUsuarioReporta||"sin-id",w=y.nombreUsuarioReporta||"Sin usuario reportante",C=`${b}-${w}`;n[C]||(n[C]={total:0,cerrados:0,idUsuario:b,nombre:w}),n[C].total++,((A=y.estadoReporte)==null?void 0:A.toLowerCase())==="cerrado"&&n[C].cerrados++});const u=Object.entries(n).sort(([,y],[,b])=>b.total!==y.total?b.total-y.total:b.cerrados-y.cerrados),x=u.length,j=(y,b)=>{if(b===1)return"#8b5cf6";const w=y/Math.max(1,b-1),C=196,A=164,P=255,D=109,R=40,E=217,O=Math.round(C+(D-C)*w),L=Math.round(A+(R-A)*w),Q=Math.round(P+(E-P)*w);return`rgb(${O}, ${L}, ${Q})`};return u.map(([y,b],w)=>({reporter:b.nombre.length>10?b.nombre.substring(0,10)+"...":b.nombre,fullReporter:b.nombre,idUsuario:b.idUsuario,cerrados:b.cerrados,total:b.total,ratio:`${b.cerrados}/${b.total}`,porcentaje:b.total>0?Math.round(b.cerrados/b.total*100):0,fill:j(w,x),globalRank:w+1}))},[r]),d=N.useMemo(()=>a.trim()?p.filter(n=>n.fullReporter.toLowerCase().includes(a.toLowerCase())):p,[p,a]),g=N.useMemo(()=>{const n=t*l;return d.slice(n,n+l).map(u=>({...u,fill:u.fill}))},[d,t]),f=Math.ceil(d.length/l),c=N.useMemo(()=>p.reduce((n,u)=>n+u.cerrados,0),[p]),h=N.useMemo(()=>p.reduce((n,u)=>n+u.total,0),[p]),o=N.useMemo(()=>p.length>0?p[0]:null,[p]),v=N.useMemo(()=>{const n=p.find(u=>u.idUsuario==="sin-id");return n?n.total:0},[p]),m=({active:n,payload:u})=>{if(n&&u&&u.length){const x=u[0].payload;return e.jsxs("div",{className:"bg-background border-border rounded-lg border p-3 shadow-lg",children:[e.jsx("p",{className:"text-foreground font-semibold",children:x.fullReporter}),e.jsxs("p",{className:"text-muted-foreground text-xs",children:["ID: ",x.idUsuario]}),e.jsxs("p",{className:"text-muted-foreground text-sm",children:["Reportados: ",x.total," • Cerrados: ",x.cerrados," (",x.porcentaje,"%)"]}),e.jsxs("p",{className:"text-muted-foreground text-sm",children:["Ranking: #",x.globalRank]})]})}return null};return e.jsxs(M,{children:[e.jsx(U,{children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx(W,{children:"Usuario que Reporta"}),e.jsxs(V,{children:[a?e.jsxs(e.Fragment,{children:["Encontrados ",d.length," usuarios • "]}):null,"Mostrando ",t*l+1,"-",Math.min((t+1)*l,d.length)," de"," ",d.length," usuarios"]})]}),f>1&&e.jsxs("div",{className:"flex gap-2",children:[e.jsx($,{variant:"outline",size:"sm",onClick:()=>s(Math.max(0,t-1)),disabled:t===0,children:e.jsx(ye,{className:"h-4 w-4"})}),e.jsx($,{variant:"outline",size:"sm",onClick:()=>s(Math.min(f-1,t+1)),disabled:t>=f-1,children:e.jsx(Ne,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx(Ce,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(se,{placeholder:"Buscar usuario reportante...",value:a,onChange:n=>i(n.target.value),className:"pl-8"})]})]})}),e.jsx(k,{children:e.jsx(Z,{config:Sr,className:"h-full w-full",children:e.jsxs(de,{data:g,layout:"vertical",height:Math.max(g.length*80,400),margin:{left:0,right:80,top:0,bottom:0},children:[e.jsx(ne,{horizontal:!1}),e.jsx(q,{dataKey:"reporter",type:"category",tickLine:!1,tickMargin:0,axisLine:!1,width:75,tick:{fontSize:11,fill:"var(--foreground)"}}),e.jsx(Y,{dataKey:"cerrados",type:"number",hide:!0}),e.jsx(J,{cursor:!1,content:e.jsx(m,{})}),e.jsx(_,{dataKey:"cerrados",layout:"vertical",radius:4,children:e.jsx(T,{dataKey:"ratio",position:"right",offset:8,className:"fill-foreground",fontSize:11,fontWeight:"bold"})})]})})}),e.jsxs(oe,{className:"flex-col items-start gap-2 text-sm",children:[e.jsxs("div",{className:"flex gap-2 leading-none font-medium",children:[o&&`${o.fullReporter} lidera con ${o.ratio} reportes (${o.porcentaje}%)`,e.jsx(G,{className:"h-4 w-4"})]}),e.jsxs("div",{className:"leading-none text-muted-foreground",children:["Total reportados: ",h," • Total cerrados: ",c,v>0&&` • Sin reportante: ${v}`]})]})]})}const Rr={abierto:{label:"Abierto",color:"#ef4444"},cerrado:{label:"Cerrado",color:"#22c55e"},cerradoPorOtro:{label:"Cerrado por otro",color:"#3b82f6"},label:{color:"var(--background)"}};function Er({data:r=[]}){const[t,s]=N.useState(0),[a,i]=N.useState(""),l=10;N.useEffect(()=>{s(0)},[a]);const p=N.useMemo(()=>{const m={};return r.forEach(u=>{var w;const x=u.idUsuarioCierre||"sin-id",j=u.nombreUsuarioCierre||"Sin encargado de cierre",y=`${x}-${j}`,b=(w=u.estadoReporte)==null?void 0:w.toLowerCase();if(m[y]||(m[y]={abierto:0,cerrado:0,cerradoPorOtro:0,total:0,idUsuario:x,nombre:j}),m[y].total++,b==="cerrado"||b==="finalizado"){const C=u.idUsuarioRealmenteCerro;C&&C!==x?m[y].cerradoPorOtro++:m[y].cerrado++}else m[y].abierto++}),Object.entries(m).sort(([,u],[,x])=>{const j=u.total>0?(u.cerrado+u.cerradoPorOtro)/u.total*100:0,y=x.total>0?(x.cerrado+x.cerradoPorOtro)/x.total*100:0;return y!==j?y-j:x.total-u.total}).map(([u,x],j)=>{const y=x.total>0?x.abierto/x.total*100:0,b=x.total>0?x.cerrado/x.total*100:0,w=x.total>0?x.cerradoPorOtro/x.total*100:0;let C=Math.round(y),A=Math.round(b),P=Math.round(w);const R=100-(C+A+P);if(R!==0&&x.total>0){const E=[{key:"abierto",decimal:y-C,value:C},{key:"cerrado",decimal:b-A,value:A},{key:"cerradoPorOtro",decimal:w-P,value:P}].sort((O,L)=>Math.abs(L.decimal)-Math.abs(O.decimal));E[0].key==="abierto"?C+=R:E[0].key==="cerrado"?A+=R:P+=R}return{idResponsable:x.idUsuario,responsable:x.nombre.length>12?x.nombre.substring(0,12)+"...":x.nombre,fullResponsable:x.nombre,abierto:x.abierto,cerrado:x.cerrado,cerradoPorOtro:x.cerradoPorOtro,total:x.total,performance:x.total>0?Math.round((x.cerrado+x.cerradoPorOtro)/x.total*100):0,abiertoPercent:C,cerradoPercent:A,cerradoPorOtroPercent:P,abiertoPercentRounded:C,cerradoPercentRounded:A,cerradoPorOtroPercentRounded:P,globalRank:j+1}})},[r]),d=N.useMemo(()=>a.trim()?p.filter(m=>m.fullResponsable.toLowerCase().includes(a.toLowerCase())):p,[p,a]),g=N.useMemo(()=>{const m=t*l;return d.slice(m,m+l)},[d,t]),f=Math.ceil(d.length/l),c=N.useMemo(()=>p.reduce((m,n)=>m+n.total,0),[p]),h=N.useMemo(()=>p.reduce((m,n)=>({abierto:m.abierto+n.abierto,cerrado:m.cerrado+n.cerrado,cerradoPorOtro:m.cerradoPorOtro+n.cerradoPorOtro}),{abierto:0,cerrado:0,cerradoPorOtro:0}),[p]),o=N.useMemo(()=>p.length>0?p[0]:null,[p]),v=({active:m,payload:n})=>{if(m&&n&&n.length){const u=n[0].payload;return e.jsxs("div",{className:"bg-background border-border rounded-lg border p-3 shadow-lg",children:[e.jsx("p",{className:"text-foreground font-semibold",children:u.fullResponsable}),e.jsxs("p",{className:"text-muted-foreground text-xs",children:["ID: ",u.idResponsable]}),e.jsxs("p",{className:"text-muted-foreground text-sm",children:["Total asignados: ",u.total," • Performance: ",u.performance,"%"]}),e.jsxs("div",{className:"mt-2 space-y-1",children:[e.jsxs("p",{className:"text-sm",children:[e.jsx("span",{className:"inline-block w-3 h-3 bg-red-500 rounded mr-2"}),"Abierto: ",u.abierto," (",u.abiertoPercentRounded,"%)"]}),e.jsxs("p",{className:"text-sm",children:[e.jsx("span",{className:"inline-block w-3 h-3 bg-green-500 rounded mr-2"}),"Cerrado: ",u.cerrado," (",u.cerradoPercentRounded,"%)"]}),e.jsxs("p",{className:"text-sm",children:[e.jsx("span",{className:"inline-block w-3 h-3 bg-blue-500 rounded mr-2"}),"Cerrado por otro: ",u.cerradoPorOtro," (",u.cerradoPorOtroPercentRounded,"%)"]})]}),e.jsxs("p",{className:"text-muted-foreground text-sm mt-2",children:["Ranking: #",u.globalRank]})]})}return null};return e.jsxs(M,{children:[e.jsx(U,{children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx(W,{children:"Distribución de Estados por Responsable de Cierre"}),e.jsxs(V,{children:[a?e.jsxs(e.Fragment,{children:["Encontrados ",d.length," responsables • "]}):null,"Mostrando ",t*l+1,"-",Math.min((t+1)*l,d.length)," de"," ",d.length," responsables"]})]}),f>1&&e.jsxs("div",{className:"flex gap-2",children:[e.jsx($,{variant:"outline",size:"sm",onClick:()=>s(Math.max(0,t-1)),disabled:t===0,children:e.jsx(ye,{className:"h-4 w-4"})}),e.jsx($,{variant:"outline",size:"sm",onClick:()=>s(Math.min(f-1,t+1)),disabled:t>=f-1,children:e.jsx(Ne,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx(Ce,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(se,{placeholder:"Buscar responsable...",value:a,onChange:m=>i(m.target.value),className:"pl-8"})]})]})}),e.jsx(k,{children:e.jsx(Z,{config:Rr,className:"h-full w-full",children:e.jsxs(de,{data:g,layout:"vertical",margin:{left:0,right:30,top:0,bottom:0},children:[e.jsx(ne,{horizontal:!1}),e.jsx(q,{dataKey:"responsable",type:"category",tickLine:!1,tickMargin:0,axisLine:!1,width:100,tick:{fontSize:11,fill:"var(--foreground)"}}),e.jsx(Y,{type:"number",hide:!0,domain:[0,100]}),e.jsx(J,{cursor:!1,content:e.jsx(v,{})}),e.jsx(_,{dataKey:"abiertoPercent",stackId:"status",fill:"var(--color-abierto)",radius:[4,0,0,4],children:e.jsx(T,{dataKey:"abiertoPercentRounded",position:"center",className:"fill-white text-xs font-medium",formatter:m=>m>5?`${m}%`:""})}),e.jsx(_,{dataKey:"cerradoPercent",stackId:"status",fill:"var(--color-cerrado)",children:e.jsx(T,{dataKey:"cerradoPercentRounded",position:"center",className:"fill-white text-xs font-medium",formatter:m=>m>5?`${m}%`:""})}),e.jsxs(_,{dataKey:"cerradoPorOtroPercent",stackId:"status",fill:"var(--color-cerradoPorOtro)",radius:[0,4,4,0],children:[e.jsx(T,{dataKey:"cerradoPorOtroPercentRounded",position:"center",className:"fill-white text-xs font-medium",formatter:m=>m>5?`${m}%`:""}),e.jsx(T,{dataKey:"total",position:"right",offset:8,className:"fill-foreground",fontSize:11,fontWeight:"bold"})]})]})})}),e.jsxs(oe,{className:"flex-col items-start gap-2 text-sm",children:[e.jsxs("div",{className:"flex gap-2 leading-none font-medium",children:[o&&`${o.fullResponsable} lidera con ${o.performance}% de cierre (${o.total} reportes)`,e.jsx(G,{className:"h-4 w-4"})]}),e.jsxs("div",{className:"leading-none text-muted-foreground",children:["Total asignados: ",c," • Abiertos: ",h.abierto," • Cerrados: ",h.cerrado," • Cerrados por otro: ",h.cerradoPorOtro]}),e.jsxs("div",{className:"flex gap-4 text-xs",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-3 h-3 bg-red-500 rounded"}),e.jsx("span",{children:"Abierto"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-3 h-3 bg-green-500 rounded"}),e.jsx("span",{children:"Cerrado"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-3 h-3 bg-blue-500 rounded"}),e.jsx("span",{children:"Cerrado por otro"})]})]})]})]})}const Or={actos:{label:"Actos",color:"#3b82f6"},condiciones:{label:"Condiciones",color:"#f59e0b"},incidentes:{label:"Incidentes",color:"#10b981"},label:{color:"var(--background)"}};function Mr({data:r=[]}){const[t,s]=N.useState(0),[a,i]=N.useState(""),l=10;N.useEffect(()=>{s(0)},[a]);const p=n=>{switch(n==null?void 0:n.toLowerCase()){case"actos":return"Actos Subestándar";case"condiciones":return"Condiciones Subestándar";case"incidentes":return"Incidentes";default:return n||"N/A"}},d=N.useMemo(()=>{const n=r.filter(j=>j.idCausa&&j.tipoReporte&&j.causaReporte&&["actos","condiciones","incidentes"].includes(j.tipoReporte.toLowerCase())),u={};return n.forEach(j=>{const y=j.idCausa.toString(),b=j.tipoReporte.toLowerCase(),w=j.causaReporte,C=`${y}-${b}`;u[C]||(u[C]={nombre:w,total:0,tipo:b}),u[C].total++}),Object.entries(u).sort(([,j],[,y])=>y.total-j.total).map(([j,y],b)=>{const w=j.split("-")[0];let C="",A="";switch(y.tipo){case"actos":C="ASE",A="#3b82f6";break;case"condiciones":C="CSE",A="#f59e0b";break;case"incidentes":C="I",A="#10b981";break}const P=`${C} - ${y.nombre}`,D=P.length>15?P.substring(0,15)+"...":P;return{key:j,causa:D,fullCausa:P,idCausa:w,total:y.total,tipo:y.tipo,tipoLabel:p(y.tipo),color:A,globalRank:b+1}})},[r]),g=N.useMemo(()=>a.trim()?d.filter(n=>n.fullCausa.toLowerCase().includes(a.toLowerCase())):d,[d,a]),f=N.useMemo(()=>{const n=t*l;return g.slice(n,n+l)},[g,t]),c=Math.ceil(g.length/l),h=N.useMemo(()=>d.reduce((n,u)=>n+u.total,0),[d]),o=N.useMemo(()=>d.reduce((n,u)=>{switch(u.tipo){case"actos":n.actos+=u.total;break;case"condiciones":n.condiciones+=u.total;break;case"incidentes":n.incidentes+=u.total;break}return n},{actos:0,condiciones:0,incidentes:0}),[d]),v=N.useMemo(()=>d.length>0?d[0]:null,[d]),m=({active:n,payload:u})=>{if(n&&u&&u.length){const x=u[0].payload;return e.jsxs("div",{className:"bg-background border-border rounded-lg border p-3 shadow-lg max-w-xs",children:[e.jsx("p",{className:"text-foreground font-semibold w-[300px] break-words leading-tight mb-2",children:x.fullCausa}),e.jsxs("p",{className:"text-muted-foreground text-xs",children:["ID Causa: ",x.idCausa]}),e.jsxs("p",{className:"text-muted-foreground text-sm",children:["Total reportes: ",x.total]}),e.jsxs("p",{className:"text-muted-foreground text-sm",children:["Tipo: ",x.tipoLabel]}),e.jsxs("p",{className:"text-muted-foreground text-sm mt-2",children:["Ranking: #",x.globalRank]})]})}return null};return e.jsxs(M,{children:[e.jsx(U,{children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx(W,{children:"Distribución de Causas por Tipo de Reporte"}),e.jsxs(V,{children:[a?e.jsxs(e.Fragment,{children:["Encontradas ",g.length," causas • "]}):null,"Mostrando ",t*l+1,"-",Math.min((t+1)*l,g.length)," de"," ",g.length," causas"]})]}),c>1&&e.jsxs("div",{className:"flex gap-2",children:[e.jsx($,{variant:"outline",size:"sm",onClick:()=>s(Math.max(0,t-1)),disabled:t===0,children:e.jsx(ye,{className:"h-4 w-4"})}),e.jsx($,{variant:"outline",size:"sm",onClick:()=>s(Math.min(c-1,t+1)),disabled:t>=c-1,children:e.jsx(Ne,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx(Ce,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(se,{placeholder:"Buscar causa...",value:a,onChange:n=>i(n.target.value),className:"pl-8"})]})]})}),e.jsx(k,{children:e.jsx(Z,{config:Or,className:"h-full w-full",children:e.jsxs(de,{data:f,layout:"vertical",height:Math.max(f.length*60,400),margin:{left:0,right:60,top:0,bottom:0},children:[e.jsx(ne,{horizontal:!1}),e.jsx(q,{dataKey:"causa",type:"category",tickLine:!1,tickMargin:0,axisLine:!1,width:120,tick:{fontSize:10,fill:"var(--foreground)"}}),e.jsx(Y,{type:"number",hide:!0}),e.jsx(J,{cursor:!1,content:e.jsx(m,{})}),e.jsxs(_,{dataKey:"total",radius:[0,4,4,0],children:[f.map((n,u)=>e.jsx(rt,{fill:n.color},`cell-${u}`)),e.jsx(T,{dataKey:"total",position:"right",offset:8,className:"fill-foreground",fontSize:11,fontWeight:"bold"})]})]})})}),e.jsxs(oe,{className:"flex-col items-start gap-2 text-sm",children:[e.jsxs("div",{className:"flex gap-2 leading-none font-medium",children:[v&&`${v.fullCausa} lidera con ${v.total} reportes`,e.jsx(G,{className:"h-4 w-4"})]}),e.jsxs("div",{className:"leading-none text-muted-foreground",children:["Total reportes: ",h," • Actos Subestándar: ",o.actos," • Condiciones Subestándar: ",o.condiciones," • Incidentes: ",o.incidentes]}),e.jsxs("div",{className:"flex gap-4 text-xs",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-3 h-3 bg-blue-500 rounded"}),e.jsx("span",{children:"Actos Subestándar (ASE)"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-3 h-3 bg-orange-500 rounded"}),e.jsx("span",{children:"Condiciones Subestándar (CSE)"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-3 h-3 bg-green-500 rounded"}),e.jsx("span",{children:"Incidentes (I)"})]})]})]})]})}const kr=r=>{switch(r==null?void 0:r.toLowerCase()){case"generado":case"abierto":return"bg-red-100 text-red-800 hover:bg-red-200";case"visualizado":case"revisado":return"bg-yellow-100 text-yellow-800 hover:bg-yellow-200";case"finalizado":case"cerrado":return"bg-green-100 text-green-800 hover:bg-green-200";default:return"bg-gray-100 text-gray-800 hover:bg-gray-200"}},Xe=r=>{switch(r==null?void 0:r.toLowerCase()){case"generado":case"abierto":return"Abierto";case"visualizado":case"revisado":return"Revisado";case"finalizado":case"cerrado":return"Cerrado";default:return r||"N/A"}},Tr=r=>{switch(r==null?void 0:r.toLowerCase()){case"alto":case"alta":return"bg-red-100 text-red-800 hover:bg-red-200";case"medio":case"media":return"bg-yellow-100 text-yellow-800 hover:bg-yellow-200";case"bajo":case"baja":return"bg-green-100 text-green-800 hover:bg-green-200";default:return"bg-gray-100 text-gray-800 hover:bg-gray-200"}},$r=r=>{switch(r==null?void 0:r.toLowerCase()){case"actos":return"bg-blue-100 text-blue-800 hover:bg-blue-200";case"condiciones":return"bg-orange-100 text-orange-800 hover:bg-orange-200";case"incidentes":return"bg-purple-100 text-purple-800 hover:bg-purple-200";default:return"bg-gray-100 text-gray-800 hover:bg-gray-200"}},Ze=r=>{switch(r==null?void 0:r.toLowerCase()){case"actos":return"Actos Subestándar";case"condiciones":return"Condiciones Subestándar";case"incidentes":return"Incidentes";default:return r||"N/A"}};function Lr({data:r=[]}){const[t,s]=N.useState(0),[a,i]=N.useState(""),l=8;N.useEffect(()=>{s(0)},[a]);const p=o=>new Date(o).toLocaleString("es-PE",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",hour12:!1}),d=(o,v)=>{const m=new Date(o),n=v?new Date(v):new Date,u=Math.abs(n.getTime()-m.getTime()),x=Math.floor(u/(1e3*60*60*24)),j=Math.floor(u%(1e3*60*60*24)/(1e3*60*60)),y=Math.floor(u%(1e3*60*60)/(1e3*60));let b="";return x>0&&(b+=`${x}d `),(x>0||j>0)&&(b+=`${j}h `),b+=`${y}m`,b.trim()},g=o=>{const v=o==null?void 0:o.toLowerCase();return v==="finalizado"||v==="cerrado"},f=N.useMemo(()=>a.trim()?r.filter(o=>{var v,m,n,u,x;return((v=o.id)==null?void 0:v.toString().includes(a))||((m=o.tipoReporte)==null?void 0:m.toLowerCase().includes(a.toLowerCase()))||((n=o.descripcionEvento)==null?void 0:n.toLowerCase().includes(a.toLowerCase()))||((u=o.estadoReporte)==null?void 0:u.toLowerCase().includes(a.toLowerCase()))||((x=o.nivelGravedad)==null?void 0:x.toLowerCase().includes(a.toLowerCase()))}):r,[r,a]),c=N.useMemo(()=>{const o=t*l;return f.slice(o,o+l)},[f,t]),h=Math.ceil(f.length/l);return e.jsxs(M,{children:[e.jsx(U,{children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx(W,{children:"Detalle de Reportes"}),e.jsxs(V,{children:[a?e.jsxs(e.Fragment,{children:["Encontrados ",f.length," reportes • "]}):null,"Mostrando ",t*l+1,"-",Math.min((t+1)*l,f.length)," de"," ",f.length," reportes"]})]}),h>1&&e.jsxs("div",{className:"flex gap-2",children:[e.jsx($,{variant:"outline",size:"sm",onClick:()=>s(Math.max(0,t-1)),disabled:t===0,children:e.jsx(ye,{className:"h-4 w-4"})}),e.jsx($,{variant:"outline",size:"sm",onClick:()=>s(Math.min(h-1,t+1)),disabled:t>=h-1,children:e.jsx(Ne,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx(Ce,{className:"text-muted-foreground absolute top-2.5 left-2.5 h-4 w-4"}),e.jsx(se,{placeholder:"Buscar por ID, tipo, descripción, estado o gravedad...",value:a,onChange:o=>i(o.target.value),className:"pl-8"})]})]})}),e.jsx(k,{className:"overflow-auto",children:e.jsx(kt,{children:e.jsxs(Et,{children:[e.jsx(Ot,{children:e.jsxs(_e,{children:[e.jsx(ee,{className:"w-16",children:"ID"}),e.jsx(ee,{className:"w-32",children:"Tipo"}),e.jsx(ee,{className:"w-40",children:"Descripción"}),e.jsx(ee,{className:"w-32",children:"Gravedad"}),e.jsx(ee,{className:"w-32",children:"Estado"}),e.jsx(ee,{className:"w-32",children:"Fecha Evento"}),e.jsx(ee,{className:"w-40",children:"Fecha Cierre"}),e.jsx(ee,{className:"w-32",children:"Duración"})]})}),e.jsxs(Mt,{children:[c.map(o=>e.jsxs(Tt,{delayDuration:300,children:[e.jsx($t,{asChild:!0,children:e.jsxs(_e,{className:"cursor-help",children:[e.jsx(H,{className:"font-medium",children:o.id}),e.jsx(H,{children:e.jsx(ze,{className:$r(o.tipoReporte||""),children:Ze(o.tipoReporte||"")})}),e.jsx(H,{className:"max-w-40",children:e.jsx("div",{className:"truncate",children:o.descripcionEvento||"Sin descripción"})}),e.jsx(H,{children:e.jsx(ze,{className:Tr(o.nivelGravedad||""),children:o.nivelGravedad||"N/A"})}),e.jsx(H,{children:e.jsx(ze,{className:kr(o.estadoReporte||""),children:Xe(o.estadoReporte||"")})}),e.jsx(H,{className:"text-muted-foreground text-xs",children:o.fechaEvento?p(o.fechaEvento):"N/A"}),e.jsx(H,{className:"text-muted-foreground text-xs",children:g(o.estadoReporte||"")&&o.reportClosedAt?p(o.reportClosedAt):"-"}),e.jsx(H,{className:"text-muted-foreground text-xs",children:o.fechaEvento?d(o.fechaEvento,o.reportClosedAt):"-"})]})}),e.jsx(Lt,{className:"max-w-md p-4",children:e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"ID del Reporte:"})," ",o.id||"N/A"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Tipo de Reporte:"})," ",Ze(o.tipoReporte||"")]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Descripción del Evento:"})," ",o.descripcionEvento||"Sin descripción"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Nivel de Gravedad:"})," ",o.nivelGravedad||"N/A"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Estado del Reporte:"})," ",Xe(o.estadoReporte||"")]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Fecha del Evento:"})," ",o.fechaEvento?p(o.fechaEvento):"N/A"]}),g(o.estadoReporte||"")&&o.reportClosedAt&&e.jsxs("div",{children:[e.jsx("strong",{children:"Fecha de Cierre:"})," ",p(o.reportClosedAt)]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Tiempo de Resolución:"})," ",o.fechaEvento?d(o.fechaEvento,o.reportClosedAt):"N/A"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Causa del Reporte:"})," ",o.causaReporte||"N/A"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Empresa que Reporta:"})," ",o.nombreEmpresaReporta||"N/A"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Empresa Reportada:"})," ",o.nombreEmpresaReportada||"N/A"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Gerencia Responsable:"})," ",o.nombreGerencia||"N/A"]}),o.areaInvolucrada&&e.jsxs("div",{children:[e.jsx("strong",{children:"Área Involucrada:"})," ",o.areaInvolucrada]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Usuario que Reporta:"})," ",o.nombreUsuarioReporta||"N/A"]}),o.nombreUsuarioCierre&&e.jsxs("div",{children:[e.jsx("strong",{children:"Usuario Encargado de Cierre:"})," ",o.nombreUsuarioCierre]}),o.nombreUsuarioReasignado&&o.nombreUsuarioReasignado.trim()&&e.jsxs("div",{children:[e.jsx("strong",{children:"Usuario Reasignado:"})," ",o.nombreUsuarioReasignado]}),o.motivoReasignacion&&e.jsxs("div",{children:[e.jsx("strong",{children:"Motivo de Reasignación:"})," ",o.motivoReasignacion]})]})})]},o.id)),c.length===0&&e.jsx(_e,{children:e.jsx(H,{colSpan:9,className:"py-8 text-center",children:"No se encontraron reportes"})})]})]})})})]})}function zr({companies:r,titles:t,onFiltersChange:s}){const[a,i]=N.useState({status:"Todos",company:"",reportType:"Todos",startDate:"",endDate:""});N.useEffect(()=>{const c=new Date,h=new Date(c.getFullYear()-1,c.getMonth(),c.getDate());i(o=>{var v;return{...o,company:r.length===1&&((v=r[0].id)==null?void 0:v.toString())||"",startDate:h.toISOString().split("T")[0],endDate:c.toISOString().split("T")[0]}})},[r]);const l=(c,h)=>{i(o=>({...o,[c]:h}))},p=()=>{console.log("Applied filters:",a),s(a)},d=()=>{const c=new Date,o={status:"Todos",company:"",reportType:"Todos",startDate:new Date(c.getFullYear()-1,c.getMonth(),c.getDate()).toISOString().split("T")[0],endDate:c.toISOString().split("T")[0]};i(o),s(o)},g=[{label:"Todos",value:"Todos"},{label:"Generado",value:"Generado"},{label:"Visualizado",value:"Visualizado"},{label:"Cerrado",value:"Cerrado"}],f=r.map(c=>{var h;return{label:c.name||c.nombre||"Empresa",value:((h=c.id)==null?void 0:h.toString())||""}});return e.jsxs("div",{className:"sticky top-10 z-10 bg-white p-3",children:[e.jsx("h2",{className:"text-lg font-semibold mb-3",children:"Filtros"}),e.jsxs("form",{onSubmit:c=>{c.preventDefault(),p()},children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-3 mb-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-sm font-medium",children:"Estado"}),e.jsxs(pe,{value:a.status,onValueChange:c=>l("status",c),children:[e.jsx(fe,{children:e.jsx(xe,{placeholder:"Seleccionar estado"})}),e.jsx(ge,{children:g.map((c,h)=>e.jsx(I,{value:c.value,children:c.label},h))})]})]}),"                    ",e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-sm font-medium",children:"Empresa"}),r.length===1?e.jsx("div",{className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background",children:r[0].name||r[0].nombre||"Empresa"}):e.jsx(zt,{data:f,value:a.company,onChange:c=>l("company",c),placeholder:"Seleccionar empresa",className:"w-full"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-sm font-medium",children:"Tipo de reporte"}),e.jsxs(pe,{value:a.reportType,onValueChange:c=>l("reportType",c),children:[e.jsx(fe,{children:e.jsx(xe,{placeholder:"Seleccionar tipo"})}),e.jsxs(ge,{children:[e.jsx(I,{value:"Todos",children:"Todos"}),Object.entries(t).map(([c,h])=>e.jsx(I,{value:c,children:h},c))]})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-sm font-medium",children:"Fecha Desde"}),e.jsx(se,{type:"date",value:a.startDate,onChange:c=>l("startDate",c.target.value),className:"w-full"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-sm font-medium",children:"Fecha Hasta"}),e.jsx(se,{type:"date",value:a.endDate,onChange:c=>l("endDate",c.target.value),className:"w-full"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx($,{type:"submit",children:"Aplicar Filtros"}),e.jsx($,{type:"button",variant:"outline",onClick:d,children:"Limpiar Filtros"})]})]})]})}const _r=[{title:"Dashboard",href:"/dashboard"}];function ba({companies:r,entities:t,titles:s}){const[a,i]=N.useState({status:"",company:"",reportType:"",startDate:"",endDate:""}),[l,p]=N.useState({}),[d,g]=N.useState([]),[f,c]=N.useState(!1),h=(m,n)=>!m||!Array.isArray(m)?[]:m.filter(u=>{if(n.status&&n.status!=="Todos"){if(n.status==="Generado"){if(u.estadoReporte!=="Generado"&&u.estadoReporte!==null&&u.estadoReporte!==void 0&&u.estadoReporte!=="")return!1}else if(u.estadoReporte!==n.status)return!1}return!(n.company&&u.idEmpresaReportada!==n.company||n.reportType&&n.reportType!=="Todos"&&u.tipoReporte!==n.reportType)}),o=async m=>{var n;try{c(!0),console.log("🔍 Aplicando filtros a la API:",m);const{company:u,...x}=m,j={...x,...u&&{companyId:u}};console.log("📤 Parámetros enviados a la API:",j);const y=await gt.get(route("api.dashboard.index"),{params:j});console.log("📥 Respuesta de la API:",y.data),console.log("📊 Cantidad de reportes recibidos:",((n=y.data.data)==null?void 0:n.length)||0),p(y.data);const b=h(y.data.data||[],m);g(b),console.log("✅ Data actualizada en el estado principal:",y.data),console.log("🎯 Data filtrada localmente (cantidad):",b.length),console.log("🎯 Data filtrada localmente (contenido):",b)}catch(u){console.error("Error al obtener datos del dashboard:",u),g([])}finally{c(!1)}};N.useEffect(()=>{var x;const m=new Date,n=new Date(m.getFullYear()-1,m.getMonth(),m.getDate()),u={status:"",company:r.length===1&&((x=r[0].id)==null?void 0:x.toString())||"",reportType:"",startDate:n.toISOString().split("T")[0],endDate:m.toISOString().split("T")[0]};console.log("🚀 Inicializando Dashboard con filtros por defecto:",u),console.log("🏢 Empresas disponibles:",r.length,r.length===1?"(solo una empresa, seleccionada automáticamente)":""),i(u),o(u)},[r]);const v=m=>{var x;const n=a;if(i(m),console.log("🔄 Filtros actualizados en Dashboard:",m),console.log("🔄 Filtros anteriores:",n),n.startDate!==m.startDate||n.endDate!==m.endDate)console.log("📅 Las fechas cambiaron, consultando API..."),console.log("📅 Fecha anterior: startDate =",n.startDate,", endDate =",n.endDate),console.log("📅 Fecha nueva: startDate =",m.startDate,", endDate =",m.endDate),o(m);else{console.log("🏠 Solo cambiaron filtros locales, aplicando filtrado..."),console.log("🏠 Filtros que cambiaron (sin fechas):",{status:n.status!==m.status?{anterior:n.status,nuevo:m.status}:"sin cambio",company:n.company!==m.company?{anterior:n.company,nuevo:m.company}:"sin cambio",reportType:n.reportType!==m.reportType?{anterior:n.reportType,nuevo:m.reportType}:"sin cambio"}),console.log("🏠 Data disponible para filtrar (cantidad):",((x=l.data)==null?void 0:x.length)||0);const j=h(l.data||[],m);g(j),console.log("🏠 Data filtrada localmente (cantidad):",j.length),console.log("🏠 Data filtrada localmente (contenido):",j)}};return e.jsxs(bt,{breadcrumbs:_r,children:[e.jsx(xt,{title:"Dashboard"}),e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4 pt-0",children:[e.jsx(zr,{companies:r,titles:s,onFiltersChange:v}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4",children:[e.jsx(xr,{data:d}),e.jsx(wr,{data:d}),e.jsx(br,{data:d}),e.jsx(jr,{data:d}),e.jsx(Nr,{data:d}),e.jsx(Pr,{data:d}),e.jsx(Er,{data:d}),e.jsx(Dr,{data:d}),e.jsx(Mr,{data:d}),e.jsx("div",{className:"col-span-1 lg:col-span-2",children:e.jsx(Lr,{data:d})})]})]})]})}export{ba as default};
