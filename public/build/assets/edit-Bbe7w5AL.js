import{m as T,r as x,j as e}from"./app-k-c3-IUX.js";import{I as V}from"./input-error--OUc2wW7.js";import{B as S}from"./button-DS4OftCH.js";import{D as C,b as E,c as w,d as q,e as I,f as L}from"./dialog-BuUT_YpG.js";import{I as h}from"./input-BmLBwXHo.js";import{L as M}from"./label-CH4sFQ5V.js";import{C as k}from"./combobox-CH2ZjVqs.js";import{S as P,a as z,b as A,c as G,d as H,e as R,f as $}from"./select-Bx-P63rG.js";import{t as O}from"./index-BnhXOjFJ.js";import{V as B}from"./utils-CISCwvQU.js";import{L as K}from"./loader-circle-BUzb_yh4.js";import"./index-Ch_9LA9U.js";import"./createLucideIcon-SZDYLwmW.js";import"./index-D342dBXe.js";import"./index-B3PbW1eo.js";import"./search-CDN3zHzK.js";import"./index-qSiOHZki.js";import"./chevrons-up-down-zkKt1COi.js";import"./trash-2-quT4AUHS.js";import"./check-CrF9bga2.js";import"./index-DrGBlFrz.js";import"./index-BL9xfY7b.js";const D=[{value:"4",label:"4",img:"/images/neumaticos/01.png"},{value:"6",label:"6",img:"/images/neumaticos/02.png"},{value:"10",label:"10",img:"/images/neumaticos/03.png"},{value:"12",label:"12",img:"/images/neumaticos/04.png"},{value:"14",label:"14",img:"/images/neumaticos/05.png"}],F=({id:n,label:l,type:r="text",value:a,onChange:s,error:c,placeholder:m,disabled:i,required:u=!1,options:p,companyCode:b,custom:g,onCustomClick:f,rightElement:N,rightLoading:_=!1})=>e.jsxs("div",{className:"grid gap-2",children:[e.jsxs(M,{htmlFor:n,children:[l," ",u&&e.jsx("span",{className:"text-red-500",children:"*"})]}),n==="code"?e.jsxs("div",{className:"relative flex items-center",children:[e.jsx(h,{id:n,type:"number",value:a,onChange:o=>{const t=o.target.value.replace(/\D/g,"");s(t)},disabled:i,placeholder:m||"Ingrese número",required:u,min:1,className:"pr-20"}),e.jsx("span",{className:"absolute right-3 top-1/2 -translate-y-1/2 bg-background px-2 py-0.5 rounded text-muted-foreground text-xs sm:text-sm font-mono border border-input",children:b?`${b}${a?a.toString().padStart(3,"0"):"___"}`:a?`COD${a.toString().padStart(3,"0")}`:"COD___"})]}):p?n==="type"?e.jsx(k,{data:p,value:a,onChange:s,placeholder:m||"Seleccione tipo...",className:"w-full",disabled:i}):e.jsxs(P,{onValueChange:s,value:a,disabled:i,children:[e.jsx(z,{className:"w-full",children:e.jsx(A,{placeholder:m})}),e.jsx(G,{children:e.jsxs(H,{children:[e.jsx(R,{children:l}),p.map(o=>e.jsx($,{value:o.value,children:o.label},o.value))]})})]}):g&&n==="tire_count"?e.jsx(h,{id:"tire_count",value:a,placeholder:"Seleccione...",readOnly:!0,onClick:f,className:"cursor-pointer bg-white",tabIndex:0,required:u,disabled:i}):e.jsx(h,{id:n,type:r,value:a,onChange:o=>s(o.target.value),disabled:i,placeholder:m,required:u}),e.jsx(V,{message:c})]});function ge({isDialogOpen:n,setIsDialogOpen:l,vehicle:r,companyCode:a}){console.log("EditVehicle",r);const{data:s,setData:c,put:m,processing:i,errors:u,reset:p}=T({code:r.code??"",license_plate:r.license_plate??"",brand:r.brand??"",model:r.model??"",color:r.color??"",year:r.year??"",engine_number:r.engine_number??"",chassis_number:r.chassis_number??"",type:r.type??"",fuel_type:r.fuel_type??"",seating_capacity:r.seating_capacity??"",mileage:r.mileage??"",is_active:r.is_active??!1,insurance_expiry_date:r.insurance_expiry_date??"",tire_count:r.tire_count??"",spare_tire_count:r.spare_tire_count??""}),[b,g]=x.useState(!1);x.useEffect(()=>{c({code:r.code??"",license_plate:r.license_plate??"",brand:r.brand??"",model:r.model??"",color:r.color??"",year:r.year??"",engine_number:r.engine_number??"",chassis_number:r.chassis_number??"",type:r.type??"",fuel_type:r.fuel_type??"",seating_capacity:r.seating_capacity??"",mileage:r.mileage??"",is_active:r.is_active??!1,insurance_expiry_date:r.insurance_expiry_date??"",tire_count:r.tire_count??"",spare_tire_count:r.spare_tire_count??""})},[r,c]);const f=x.useMemo(()=>["type","code","brand","model","year","tire_count","spare_tire_count"].every(j=>{var d;return(d=s[j])==null?void 0:d.toString().trim()}),[s]),N=x.useCallback(t=>{t.preventDefault(),m(route("vehicle.update",{vehicle:r.id}),{onSuccess:()=>{l(!1),O.success("Vehículo actualizado exitosamente.")},onError:()=>{O.error("Ocurrió un error al intentar actualizar el vehículo.")}})},[m,l,r.id,s]),_=D.find(t=>t.label===s.tire_count),o=[{id:"license_plate",label:"Placa",required:!0,disabled:!0},{id:"type",label:"Tipo",required:!0,options:B},{id:"code",label:"Código",required:!0,companyCode:a},{id:"brand",label:"Marca",required:!0},{id:"model",label:"Modelo",required:!0},{id:"color",label:"Color",required:!0},{id:"year",label:"Año",required:!0,type:"number"},{id:"engine_number",label:"N° Motor"},{id:"chassis_number",label:"N° Chasis"},{id:"seating_capacity",label:"N° Asientos s/Cond.",required:!0,type:"number"},{id:"mileage",label:"Kilometraje",required:!0,type:"number"},{id:"tire_count",label:"N° Neumáticos",custom:!0,required:!0,companyCode:a},{id:"spare_tire_count",label:"N° Neumáticos de repuesto",required:!0,type:"number"}];return e.jsxs("div",{children:[e.jsx(C,{open:n,onOpenChange:l,children:e.jsxs(E,{className:"pb-3 sm:max-w-[800px]",children:[e.jsxs(w,{children:[e.jsx(q,{children:"Actualizar Vehículo"}),e.jsx(I,{children:"Modifique los campos permitidos y guarde los cambios."})]}),e.jsxs("div",{className:"max-h-[60vh] overflow-y-auto",children:[e.jsx("form",{id:"vehicleEditForm",onSubmit:N,className:"grid gap-4 sm:grid-cols-2",children:o.map(({id:t,custom:j,...d})=>j&&t==="tire_count"?e.jsx(F,{id:t,value:s[t],onChange:y=>c(t,y),error:u[t],disabled:i,required:!0,companyCode:a,custom:!0,onCustomClick:()=>g(!0),...d},t):e.jsx(F,{id:t,value:s[t],onChange:y=>c(t,y),error:u[t],disabled:i||d.disabled,companyCode:a,...d},t))}),_&&e.jsx("div",{className:"flex justify-center mt-6",children:e.jsx("img",{src:_.img,alt:_.label,className:"w-32 h-32 object-contain bg-white"})})]}),e.jsxs(L,{children:[e.jsxs(S,{type:"submit",form:"vehicleEditForm",disabled:i||!f,children:[i&&e.jsx(K,{className:"h-4 w-4 animate-spin"}),"Guardar"]}),e.jsx(S,{type:"button",variant:"secondary",onClick:()=>{p(),l(!1)},disabled:i,children:"Cancelar"})]})]})}),e.jsx(C,{open:b,onOpenChange:g,children:e.jsxs(E,{className:"max-w-md",children:[e.jsx(w,{children:e.jsx(q,{children:"Seleccione el número de neumáticos"})}),e.jsx("div",{className:"grid grid-cols-2 gap-4 py-2 max-h-80 overflow-y-auto",style:{scrollbarGutter:"stable"},children:D.map(t=>e.jsx("button",{type:"button",className:"flex flex-col items-center rounded p-2 bg-white hover:bg-accent focus:bg-accent focus:outline-none w-full",onClick:()=>{c("tire_count",t.label),g(!1)},children:e.jsx("img",{src:t.img,alt:t.label,className:"w-full h-auto object-contain",style:{aspectRatio:"3/5",maxHeight:220}})},t.value))})]})})]})}export{ge as default};
