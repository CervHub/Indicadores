import{K as E,m as V,r as F,j as e}from"./app-dQT239ps.js";import{I as o}from"./input-error-aKcg5enS.js";import{B as f}from"./button-qorxA9Ni.js";import{D as T,a as L,b as q,c as R,d as w,e as O}from"./dialog-xMYU53XA.js";import{I as U}from"./input-DoHYix-g.js";import{L as t}from"./label-Gfj_itVC.js";import{S as c,a as d,b as m,c as p,d as h,e as x,f as u}from"./select-DPi8YqF4.js";import{m as B}from"./utils-BXZQgxmQ.js";import{t as G}from"./index-CDdN-Nje.js";import{L as M}from"./loader-circle-DKe-dgFq.js";import"./index-9yUWTkrX.js";import"./index-BVtL2QXf.js";import"./index-CnUcILfV.js";import"./index-BaKwaQDo.js";import"./index-YkSNm9Kd.js";import"./index-oRwhoj9u.js";function ie({rules:y}){const{contractorCompanyTypes:_,ueas:v}=E().props,{data:r,setData:n,post:S,processing:g,errors:l,reset:C}=V({contractor_company_type_id:"",uea_id:"",year:"",month:"",file:null}),[D,j]=F.useState(!1),N=()=>y.filter(i=>parseInt(i.year)===parseInt(r.year)).some(i=>parseInt(i.month)===parseInt(r.month)),b=s=>{if(s.preventDefault(),N()){G.error("No se puede subir el archivo en el mes seleccionado, porque esta cerrado, comuniquese con el administrador.");return}S(route("annexes.store"),{onSuccess:a=>{var i;C(),j(!1),console.log("Solicitud de creación exitosa:",(i=a==null?void 0:a.props)==null?void 0:i.flash)},onError:a=>{j(!0),console.log("Errores en la solicitud de creación:",a)}})},A=()=>r.contractor_company_type_id&&r.uea_id&&r.year&&r.month&&r.file,I=Array.from({length:10},(s,a)=>new Date().getFullYear()-a);return e.jsx("div",{children:e.jsxs(T,{open:D,onOpenChange:j,children:[e.jsx("div",{className:"flex justify-start",children:e.jsx(L,{asChild:!0,children:e.jsx(f,{className:"inline-block px-4 py-2",children:"Agregar Anexos"})})}),e.jsxs(q,{className:"sm:max-w-[425px]",children:[e.jsxs(R,{children:[e.jsx(w,{children:"Agregar Contratista"}),e.jsx(O,{children:"Complete los campos para agregar un nuevo contratista."})]}),e.jsxs("form",{onSubmit:b,className:"space-y-3",method:"post",action:route("contractor.store"),encType:"multipart/form-data",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(t,{htmlFor:"contractor_company_type_id",children:"Tipo de Cliente"}),e.jsxs(c,{required:!0,onValueChange:s=>n("contractor_company_type_id",s),value:r.contractor_company_type_id,children:[e.jsx(d,{children:e.jsx(m,{placeholder:"Seleccione un tipo de cliente"})}),e.jsx(p,{children:e.jsxs(h,{children:[e.jsx(x,{children:"Tipos de Cliente"}),_.map(s=>e.jsx(u,{value:String(s.id),children:s.name},s.id))]})})]}),e.jsx(o,{message:l.contractor_company_type_id})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(t,{htmlFor:"uea_id",children:"UEA"}),e.jsxs(c,{onValueChange:s=>n("uea_id",s),value:r.uea_id,children:[e.jsx(d,{children:e.jsx(m,{placeholder:"Seleccione una UEA"})}),e.jsx(p,{children:e.jsxs(h,{children:[e.jsx(x,{children:"UEAs"}),v.map(s=>e.jsx(u,{value:String(s.id),children:s.name},s.id))]})})]}),e.jsx(o,{message:l.uea_id})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(t,{htmlFor:"year",children:"Año"}),e.jsxs(c,{onValueChange:s=>n("year",s),value:r.year,children:[e.jsx(d,{children:e.jsx(m,{placeholder:"Seleccione un año"})}),e.jsx(p,{children:e.jsxs(h,{children:[e.jsx(x,{children:"Años"}),I.map(s=>e.jsx(u,{value:String(s),children:s},s))]})})]}),e.jsx(o,{message:l.year})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(t,{htmlFor:"month",children:"Mes"}),e.jsxs(c,{onValueChange:s=>n("month",s),value:r.month,children:[e.jsx(d,{children:e.jsx(m,{placeholder:"Seleccione un mes"})}),e.jsx(p,{children:e.jsxs(h,{children:[e.jsx(x,{children:"Meses"}),B.map(s=>e.jsx(u,{value:s.value,children:s.label},s.value))]})})]}),e.jsx(o,{message:l.month})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(t,{htmlFor:"file",children:"Archivo"}),e.jsx(U,{type:"file",id:"file",required:!0,accept:".xlsx,.xls",onChange:s=>n("file",s.target.files?s.target.files[0]:null)}),e.jsx(o,{message:l.file})]}),e.jsxs(f,{type:"submit",className:"mt-2",disabled:!A()||g,children:[g&&e.jsx(M,{className:"h-4 w-4 animate-spin"}),"Guardar"]})]})]})]})})}export{ie as default};
