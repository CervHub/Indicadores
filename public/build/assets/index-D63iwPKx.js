import{j as e,r as d,$ as P,K as E,L as F}from"./app-B1_KnvdL.js";import{B as z}from"./badge-Drig3plL.js";import{B as c}from"./button-C-_Qybau.js";import{f as v}from"./utils-CISCwvQU.js";import{A as x}from"./arrow-up-down-lRZ6HlPz.js";import{E as M}from"./eye-BzUzUSrF.js";import{F as K,A as O}from"./app-layout-BwSs8yIM.js";import{u as B,f as j,g as L,a as A,b as G,c as V}from"./index-x_VstPgR.js";import{T as U,a as H,b as h,c as $,d as W,e as _}from"./table-CxR0aplX.js";import{I as w}from"./input-Bydgz0j0.js";import{S,a as C,b as N,c as I,f as T}from"./select-bP0jcejS.js";import"./createLucideIcon-BNgsHN6x.js";import"./index-Cca7i4F-.js";import"./index-D_lO51ZX.js";import"./index-CdeOVbM3.js";import"./index-B0b4fhsK.js";import"./tooltip-CdeWqB2k.js";import"./index-ii2P3HWA.js";import"./index-dO34ceec.js";import"./index-yx-zLcrs.js";import"./chevrons-up-down-BRYA7Jgf.js";import"./truck-B6MC3Mzf.js";import"./chevron-right-DOLUm72e.js";import"./check-c6wLsfTS.js";const q=()=>[{accessorKey:"id",header:({column:l})=>e.jsxs(c,{variant:"ghost",onClick:()=>l.toggleSorting(l.getIsSorted()==="asc"),className:"p-0",children:["ID",e.jsx(x,{className:"ml-2 h-4 w-4"})]}),maxSize:60},{accessorKey:"fecha_evento",header:({column:l})=>e.jsxs(c,{variant:"ghost",onClick:()=>l.toggleSorting(l.getIsSorted()==="asc"),className:"p-0",children:["Fecha Evento",e.jsx(x,{className:"ml-2 h-4 w-4"})]}),cell:({row:l})=>v(l.original.fecha_evento)},{accessorKey:"fecha_reporte",header:({column:l})=>e.jsxs(c,{variant:"ghost",onClick:()=>l.toggleSorting(l.getIsSorted()==="asc"),className:"p-0",children:["Fecha Reporte",e.jsx(x,{className:"ml-2 h-4 w-4"})]}),cell:({row:l})=>v(l.original.fecha_reporte)},{accessorKey:"tipo_inspeccion_descripcion",header:"Tipo Inspección"},{accessorKey:"nombre_usuario",header:"Usuario"},{accessorKey:"nombre_empresa",header:"Empresa"},{accessorKey:"estado",header:"Estado",cell:({row:l})=>{const o=l.original.estado;let i="",r="";switch(o){case"Generado":i="bg-blue-500 text-white",r="Generado";break;case"Revisado":i="bg-orange-500 text-white",r="Revisado";break;case"Finalizado":i="bg-green-600 text-white",r="Finalizado";break;default:i="bg-gray-500 text-white",r=o;break}return e.jsx(z,{variant:"default",className:i,children:r})}},{accessorKey:"acciones",header:"Acciones",cell:({row:l})=>{const[o,i]=d.useState(!1),r=route("inspection.detalle",{reportability_id:l.original.id}),p=route("inspection.download",{reportability_id:l.original.id}),u=()=>{i(!0)},t=()=>{window.open(p,"_blank")};return e.jsxs("div",{className:"flex flex-wrap space-x-2",children:[e.jsx(P,{href:r,className:"flex items-center",children:e.jsxs(c,{variant:"warning","aria-label":"Toggle detalle",className:`flex h-7 items-center p-2 text-xs text-white ${o?"cursor-not-allowed opacity-50":""}`,onClick:u,disabled:o,children:[e.jsx(M,{className:"h-3 w-3"})," Detalle"]})}),e.jsxs(c,{"aria-label":"Toggle pdf",className:"h-7 bg-red-700 p-2 text-xs text-white hover:bg-red-900 dark:bg-red-600 dark:hover:bg-red-800",onClick:t,children:[e.jsx(K,{className:"h-3 w-3"})," PDF"]})]})},minSize:200}],J=[{value:"all",label:"Todos"},{value:"Inspección de pre-uso",label:"Inspección de pre-uso"},{value:"Inspección de pre-uso visitas",label:"Inspección de pre-uso visitas"},{value:"Inspección trimestral",label:"Inspección trimestral"},{value:"Inspección semestral",label:"Inspección semestral"},{value:"Inspección por parada de planta",label:"Inspección por parada de planta"}],Q=[{value:"all",label:"Todos"},{value:"Generado",label:"Generado"},{value:"Revisado",label:"Revisado"},{value:"Finalizado",label:"Finalizado"}];function X({columns:l,data:o}){var b;const[i,r]=d.useState([{id:"fecha_evento",desc:!0}]),[p,u]=d.useState(""),[t,m]=d.useState({tipo_inspeccion_descripcion:"all",nombre_usuario:"",nombre_empresa:"",estado:"all"}),y=d.useMemo(()=>o.filter(a=>{var g,f;const s=t.tipo_inspeccion_descripcion!=="all"?a.tipo_inspeccion_descripcion===t.tipo_inspeccion_descripcion:!0,k=t.nombre_usuario?(g=a.nombre_usuario)==null?void 0:g.toLowerCase().includes(t.nombre_usuario.toLowerCase()):!0,R=t.nombre_empresa?(f=a.nombre_empresa)==null?void 0:f.toLowerCase().includes(t.nombre_empresa.toLowerCase()):!0,D=t.estado!=="all"?a.estado===t.estado:!0;return s&&k&&R&&D}),[o,t]),n=B({data:y,columns:l,getCoreRowModel:V(),getPaginationRowModel:G(),onSortingChange:r,getSortedRowModel:A(),onGlobalFilterChange:u,getFilteredRowModel:L(),state:{sorting:i,globalFilter:p}});return e.jsxs("div",{children:[e.jsxs("div",{className:"mb-4 flex flex-col gap-2 md:flex-row md:items-end md:gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold mb-1",children:"Tipo Inspección"}),e.jsxs(S,{value:t.tipo_inspeccion_descripcion,onValueChange:a=>m(s=>({...s,tipo_inspeccion_descripcion:a})),children:[e.jsx(C,{className:"w-48 text-xs",children:e.jsx(N,{placeholder:"Tipo Inspección"})}),e.jsx(I,{children:J.map(a=>e.jsx(T,{value:a.value,children:a.label},a.value))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold mb-1",children:"Usuario"}),e.jsx(w,{type:"text",className:"text-xs",placeholder:"Buscar usuario",value:t.nombre_usuario,onChange:a=>m(s=>({...s,nombre_usuario:a.target.value}))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold mb-1",children:"Empresa"}),e.jsx(w,{type:"text",className:"text-xs",placeholder:"Buscar empresa",value:t.nombre_empresa,onChange:a=>m(s=>({...s,nombre_empresa:a.target.value}))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold mb-1",children:"Estado"}),e.jsxs(S,{value:t.estado,onValueChange:a=>m(s=>({...s,estado:a})),children:[e.jsx(C,{className:"w-32 text-xs",children:e.jsx(N,{placeholder:"Estado"})}),e.jsx(I,{children:Q.map(a=>e.jsx(T,{value:a.value,children:a.label},a.value))})]})]})]}),e.jsx("div",{className:"grid grid-cols-1 rounded-md border",children:e.jsxs(U,{className:"text-xs",children:[e.jsx(H,{children:n.getHeaderGroups().map(a=>e.jsx(h,{children:a.headers.map(s=>e.jsx($,{style:{minWidth:s.column.columnDef.minSize&&s.column.columnDef.minSize!==0?s.column.columnDef.minSize:"auto",maxWidth:s.column.columnDef.maxSize&&s.column.columnDef.maxSize!==0?s.column.columnDef.maxSize:"auto"},children:s.isPlaceholder?null:j(s.column.columnDef.header,s.getContext())},s.id))},a.id))}),e.jsx(W,{children:(b=n.getRowModel().rows)!=null&&b.length?n.getRowModel().rows.map(a=>e.jsx(h,{"data-state":a.getIsSelected()&&"selected",children:a.getVisibleCells().map(s=>e.jsx(_,{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:j(s.column.columnDef.cell,s.getContext())},s.id))},a.id)):e.jsx(h,{children:e.jsx(_,{colSpan:l.length,className:"h-24 text-center",children:"No results."})})})]})}),e.jsxs("div",{className:"flex items-center justify-end space-x-2 py-4",children:[e.jsx(c,{variant:"outline",size:"sm",onClick:()=>n.previousPage(),disabled:!n.getCanPreviousPage(),children:"Previous"}),e.jsx(c,{variant:"outline",size:"sm",onClick:()=>n.nextPage(),disabled:!n.getCanNextPage(),children:"Next"})]})]})}const Y=[{title:"Reportabilidad",href:"/admin/reportability"}];function Se(){const{inspectionVehicles:l,isSecurityEngineer:o}=E().props;return e.jsxs(O,{breadcrumbs:Y,children:[e.jsx(F,{title:"Reportabilidad de inspecciones"}),e.jsx("div",{className:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4",children:e.jsx(X,{columns:q(),data:l})})]})}export{Se as default};
